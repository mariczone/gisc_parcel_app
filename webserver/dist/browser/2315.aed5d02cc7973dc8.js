"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[2315],{550:(k,I,b)=>{function h(){return[1,0,0,0,1,0,0,0,1]}function A(p,v,g,O,P,w,R,F,D){return[p,v,g,O,P,w,R,F,D]}function C(p,v){return new Float64Array(p,v,9)}b.d(I,{a:()=>C,c:()=>h,f:()=>A}),Object.freeze(Object.defineProperty({__proto__:null,clone:function S(p){return[p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8]]},create:h,createView:C,fromValues:A},Symbol.toStringTag,{value:"Module"}))},78451:(k,I,b)=>{function h(){return[0,0,0,1]}function S(v){return[v[0],v[1],v[2],v[3]]}function C(v,g){return new Float64Array(v,g,4)}b.d(I,{I:()=>M,a:()=>h,b:()=>S,c:()=>C});const M=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:M,clone:S,create:h,createView:C,fromValues:function A(v,g,O,P){return[v,g,O,P]}},Symbol.toStringTag,{value:"Module"}))},6810:(k,I,b)=>{b.r(I),b.d(I,{default:()=>W});var h=b(62208),S=b(55713),A=b(48977),C=b(56729),M=b(84161),p=b(14658),v=b(55915),g=b(65234),O=b(53776),P=b(23899),w=b(98610),R=b(92852),F=b(61566);function U(u,t,l){return(0,h.pC)(u)&&u.attributeInfo.useElevation?t?function Z(u,t){const l=new Float64Array(t);for(let o=0;o<t;o++)l[o]=u[3*o+2];return l}(t,l):null:(0,h.pC)(u)&&u.attributeInfo.storageInfo?(0,R.qM)(u.attributeInfo.storageInfo,u.buffer,l):null}function T(u){return null==u||"none"===u?null:"low-four-bit"===u?t=>15&t:"high-four-bit"===u?t=>(240&t)>>4:"absolute-value"===u?t=>Math.abs(t):"modulo-ten"===u?t=>t%10:null}function z(u){let t=0;for(const l of u||[])t|=1<<l;return t}class E{transform(t){const l=this._transform(t),o=[l.points.buffer,l.rgb.buffer];(0,h.pC)(l.pointIdFilterMap)&&o.push(l.pointIdFilterMap.buffer);for(const s of l.attributes)"buffer"in s.values&&(0,S.eP)(s.values.buffer)&&s.values.buffer!==l.rgb.buffer&&o.push(s.values.buffer);return Promise.resolve({result:l,transferList:o})}_transform(t){const l=function J(u,t){if(null==u.encoding||""===u.encoding){const l=(0,R.W7)(t,u);if((0,h.Wi)(l.vertexAttributes.position))return;const o=(0,R.I_)(t,l.vertexAttributes.position),s=l.header.fields,m=[s.offsetX,s.offsetY,s.offsetZ],n=[s.scaleX,s.scaleY,s.scaleZ],a=o.length/3,e=new Float64Array(3*a);for(let f=0;f<a;f++)e[3*f]=o[3*f]*n[0]+m[0],e[3*f+1]=o[3*f+1]*n[1]+m[1],e[3*f+2]=o[3*f+2]*n[2]+m[2];return e}if("lepcc-xyz"===u.encoding)return(0,F.Gi)(t).result}(t.schema,t.geometryBuffer);let o=l.length/3,s=null;const m=[],n=U(t.primaryAttributeData,l,o);(0,h.pC)(t.primaryAttributeData)&&n&&m.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:n});const a=U(t.modulationAttributeData,l,o);(0,h.pC)(t.modulationAttributeData)&&a&&m.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:a});let e=function D(u,t,l,o){const{rendererJSON:s,isRGBRenderer:m}=u;let n=null,a=null;if(t&&m)n=t;else if(t&&"pointCloudUniqueValueRenderer"===s?.type){a=w.Z.fromJSON(s);const e=a.colorUniqueValueInfos;n=new Uint8Array(3*o);const f=T(a.fieldTransformType);for(let r=0;r<o;r++){const c=(f?f(t[r]):t[r])+"";for(let i=0;i<e.length;i++)if(e[i].values.includes(c)){n[3*r]=e[i].color.r,n[3*r+1]=e[i].color.g,n[3*r+2]=e[i].color.b;break}}}else if(t&&"pointCloudStretchRenderer"===s?.type){a=P.Z.fromJSON(s);const e=a.stops;n=new Uint8Array(3*o);const f=T(a.fieldTransformType);for(let r=0;r<o;r++){const c=f?f(t[r]):t[r],i=e.length-1;if(c<e[0].value)n[3*r]=e[0].color.r,n[3*r+1]=e[0].color.g,n[3*r+2]=e[0].color.b;else if(c>=e[i].value)n[3*r]=e[i].color.r,n[3*r+1]=e[i].color.g,n[3*r+2]=e[i].color.b;else for(let d=1;d<e.length;d++)if(c<e[d].value){const y=(c-e[d-1].value)/(e[d].value-e[d-1].value);n[3*r]=e[d].color.r*y+e[d-1].color.r*(1-y),n[3*r+1]=e[d].color.g*y+e[d-1].color.g*(1-y),n[3*r+2]=e[d].color.b*y+e[d-1].color.b*(1-y);break}}}else if(t&&"pointCloudClassBreaksRenderer"===s?.type){a=O.Z.fromJSON(s);const e=a.colorClassBreakInfos;n=new Uint8Array(3*o);const f=T(a.fieldTransformType);for(let r=0;r<o;r++){const c=f?f(t[r]):t[r];for(let i=0;i<e.length;i++)if(c>=e[i].minValue&&c<=e[i].maxValue){n[3*r]=e[i].color.r,n[3*r+1]=e[i].color.g,n[3*r+2]=e[i].color.b;break}}}else{n=new Uint8Array(3*o);for(let e=0;e<n.length;e++)n[e]=255}if(l&&a&&a.colorModulation){const e=a.colorModulation.minValue,f=a.colorModulation.maxValue,r=.3;for(let c=0;c<o;c++){const i=l[c],d=i>=f?1:i<=e?r:r+(1-r)*(i-e)/(f-e);n[3*c]=d*n[3*c],n[3*c+1]=d*n[3*c+1],n[3*c+2]=d*n[3*c+2]}}return n}(t.rendererInfo,n,a,o);if(t.filterInfo&&t.filterInfo.length>0&&(0,h.pC)(t.filterAttributesData)){const r=t.filterAttributesData.filter(h.pC).map(c=>{const i=U(c,l,o),d={attributeInfo:c.attributeInfo,values:i};return m.push(d),d});s=new Uint32Array(o),o=function j(u,t,l,o,s){const m=u.length/3;let n=0;for(let a=0;a<m;a++){let e=!0;for(let f=0;f<o.length&&e;f++){const{filterJSON:r}=o[f],c=s[f].values[a];switch(r.type){case"pointCloudValueFilter":{const i="exclude"===r.mode;r.values.includes(c)===i&&(e=!1);break}case"pointCloudBitfieldFilter":{const i=z(r.requiredSetBits),d=z(r.requiredClearBits);(c&i)===i&&!(c&d)||(e=!1);break}case"pointCloudReturnFilter":{const i=15&c,d=c>>>4&15,y=d>1,Y=1===i,x=i===d;let N=!1;for(const V of r.includedReturns)if("last"===V&&x||"firstOfMany"===V&&Y&&y||"lastOfMany"===V&&x&&y||"single"===V&&!y){N=!0;break}N||(e=!1);break}}}e&&(l[n]=a,u[3*n]=u[3*a],u[3*n+1]=u[3*a+1],u[3*n+2]=u[3*a+2],t[3*n]=t[3*a],t[3*n+1]=t[3*a+1],t[3*n+2]=t[3*a+2],n++)}return n}(l,e,s,t.filterInfo,r)}for(const r of t.userAttributesData){const c=U(r,l,o);m.push({attributeInfo:r.attributeInfo,values:c})}3*o<e.length&&(e=new Uint8Array(e.buffer.slice(0,3*o))),this._applyElevationOffsetInPlace(l,o,t.elevationOffset);const f=this._transformCoordinates(l,o,t.obb,g.Z.fromJSON(t.inSR),g.Z.fromJSON(t.outSR));return{obb:t.obb,points:f,rgb:e,attributes:m,pointIdFilterMap:s}}_transformCoordinates(t,l,o,s,m){if(!(0,v.CM)(t,s,0,t,m,0,l))throw new Error("Can't reproject");const n=(0,p.f)(o.center[0],o.center[1],o.center[2]),a=(0,p.c)(),e=(0,p.c)();(0,A.c)(B,o.quaternion);const f=new Float32Array(3*l);for(let r=0;r<l;r++)a[0]=t[3*r]-n[0],a[1]=t[3*r+1]-n[1],a[2]=t[3*r+2]-n[2],(0,M.q)(e,a,B),o.halfSize[0]=Math.max(o.halfSize[0],Math.abs(e[0])),o.halfSize[1]=Math.max(o.halfSize[1],Math.abs(e[1])),o.halfSize[2]=Math.max(o.halfSize[2],Math.abs(e[2])),f[3*r]=a[0],f[3*r+1]=a[1],f[3*r+2]=a[2];return f}_applyElevationOffsetInPlace(t,l,o){if(0!==o)for(let s=0;s<l;s++)t[3*s+2]+=o}}const B=(0,C.c)();function W(){return new E}}}]);
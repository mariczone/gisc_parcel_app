"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[4029],{91365:(k,Z,b)=>{b.d(Z,{Qn:()=>h,iG:()=>m});var T,v=b(25919),F=b(21837);class E{}E.instance=new F.vF("Etc/UTC"),(T||(T={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const O={[T.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};class D extends Error{constructor(n,l){super((0,v.Hy)(O[n],l)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,D)}}class m{constructor(n){this._date=n,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(n=0,l=1,I=1,R=0,U=0,P=0,p=0,S){if(isNaN(n)||isNaN(l)||isNaN(I)||isNaN(R)||isNaN(U)||isNaN(P)||isNaN(p))return null;let x=0;const M=F.ou.local(n,l).daysInMonth;I<1&&(x=I-1,I=1),I>M&&(x=I-M,I=M);let N=0;l>12?(N=l-12,l=12):l<1&&(N=l-1,l=1);let B=0;U>59?(B=U-59,U=59):U<0&&(B=U,U=0);let L=0;P>59?(L=P-59,P=59):P<0&&(L=P,P=0);let _=0;p>999?(_=p-999,p=999):p<0&&(_=p,p=0);let c=F.ou.fromObject({day:I,year:n,month:l,hour:R,minute:U,second:P,millisecond:p},{zone:h(S)});return 0!==N&&(c=c.plus({months:N})),0!==x&&(c=c.plus({days:x})),0!==B&&(c=c.plus({minutes:B})),0!==L&&(c=c.plus({seconds:L})),0!==_&&(c=c.plus({milliseconds:_})),new m(c)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(n,l){const I=h(l);return n.isUnknownTimeZone||I===E.instance?m.fromParts(n.year,n.monthJS+1,n.day,n.hour,n.minute,n.second,n.millisecond,I):new m(n._date.setZone(l))}static dateJSToArcadeDate(n){return new m(F.ou.fromJSDate(n,{zone:"system"}))}static dateJSAndZoneToArcadeDate(n,l="system"){return new m(F.ou.fromJSDate(n,{zone:l}))}static unknownEpochToArcadeDate(n){return new m(F.ou.fromMillis(n,{zone:E.instance}))}static unknownDateJSToArcadeDate(n){return new m(F.ou.fromMillis(n.getTime(),{zone:E.instance}))}static epochToArcadeDate(n,l="system"){return new m(F.ou.fromMillis(n,{zone:l}))}static dateTimeToArcadeDate(n){return new m(n)}changeTimeZone(n){const l=h(n);return m.dateTimeToArcadeDate(this._date.setZone(l))}static dateTimeAndZoneToArcadeDate(n,l){const I=h(l);return n.zone===E.instance||I===E.instance?m.fromParts(n.year,n.month,n.day,n.hour,n.minute,n.second,n.millisecond,I):new m(n.setZone(I))}static nowToArcadeDate(n){return new m(F.ou.fromJSDate(new Date,{zone:n}))}static nowUTCToArcadeDate(){return new m(F.ou.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===m.systemTimeZoneCanonicalName}equals(n){return this.isSystem&&n.isSystem?this.toNumber()===n.toNumber():this.isUnknownTimeZone===n.isUnknownTimeZone&&this._date.equals(n._date)}get isUnknownTimeZone(){return this._date.zone===E.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let n=this._date.weekday;return n>6&&(n=0),n}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const n=this.zone;return"fixed"===n.type?0===n.fixed?"utc":n.formatOffset(0,"short"):n.name}stringify(){return JSON.stringify(this.toJSDate())}plus(n){return new m(this._date.plus(n))}diff(n,l="milliseconds"){return this._date.diff(n._date,l)[l]}toISOString(n){return this._date.toISO(n?{suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}:{includeOffset:!this.isUnknownTimeZone})}toFormat(n,l){return this._date.toFormat(n,l)}toJSDate(){return this._date.toJSDate()}toSQLString(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new m(this._date.toUTC())}toLocal(){return new m(this._date.toLocal())}toString(){return this.toISOString(!0)}}function h(g){if(g instanceof F.ld)return g;if("system"===g.toLowerCase())return"system";if("utc"===g.toLowerCase())return"utc";if("unknown"===g.toLowerCase())return E.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(g)){const l=F.Qf.parseSpecifier("UTC"+(g.startsWith("+")||g.startsWith("-")?"":"+")+g);if(l)return l}const n=F.vF.create(g);if(!n.isValid)throw new D(T.TimeZoneNotRecognised);return n}},29050:(k,Z,b)=>{b.d(Z,{nu:()=>g}),b(91365);var F=b(60466),O=(b(41039),b(21837),b(60194));class g{constructor(){this.dateTimeReferenceMetaData=null,this._fieldTimeZoneIndex={},this._fieldIndex=null,this._ianaPreferred=null,this._ianaTimeInfo=null,this._ianaEditFields=null,this._ianaLayerDateFields=null}static create(l,I){const R=new g;return R.dateTimeReferenceMetaData=I,R._fieldIndex=l instanceof F.Z?l:new F.Z(l),R}static createFromLayer(l){if(!l)return null;if(!l.fieldsIndex)return!l.declaredClass&&l.fields?g.create(l.fields,l):null;const I=new g;return I._fieldIndex=l.fieldsIndex,I.dateTimeReferenceMetaData={timeInfo:l?.timeInfo?.toJSON()??null,editFieldsInfo:l?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:l?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:l?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===l?.datesInUnknownTimezone},I}fieldTimeZone(l){const I=this._fieldIndex?.get(l);if(!I||"date"!==I.type&&"esriFieldTypeDate"!==I.type)return null;const R=this._fieldTimeZoneIndex[I.name];if(void 0!==R)return R;const U=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(const p of U)if(p.field===I.name){const S=this.convertToIANA(p.timeReference,p.isunknown);return this._fieldTimeZoneIndex[I.name]=S,S}const P=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);return this._fieldTimeZoneIndex[I.name]=P,P}convertToIANA(l,I){return I?"unknown":function h(n){return n?.timeZoneIANA?n?.timeZoneIANA:n?.timeZone?(0,O.G)(n,""):""}(l)}get layerPreferredTimeZone(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";const l=this.dateTimeReferenceMetaData?.preferredTimeReference;return this._ianaPreferred=this.convertToIANA(l,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaPreferred}get layerTimeInfoTimeZone(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;this._ianaTimeInfo="";const l=this.dateTimeReferenceMetaData?.timeInfo?.timeReference;return this._ianaTimeInfo=this.convertToIANA(l,!1),this._ianaTimeInfo}get layerEditFieldsTimeZone(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";const l=this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference;return this._ianaEditFields=this.convertToIANA(l,this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaEditFields}get layerDateFieldsTimeZone(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;this._ianaLayerDateFields="";const l=this.dateTimeReferenceMetaData?.dateFieldsTimeReference;return this._ianaLayerDateFields=this.convertToIANA(l,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaLayerDateFields}}},77044:(k,Z,b)=>{b.d(Z,{Y:()=>E});var v=b(62208);function F(n,l){return n?l?4:3:l?3:2}function E(n,l,I,R,U){if((0,v.Wi)(l)||!l.lengths.length)return null;const P="upperLeft"===U?.originPosition?-1:1;n.lengths.length&&(n.lengths.length=0),n.coords.length&&(n.coords.length=0);const p=n.coords,S=[],x=I?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:M,coords:N}=l,B=F(I,R);let L=0;for(const _ of M){const c=T(x,N,L,_,I,R,P);c&&S.push(c),L+=_*B}if(S.sort((_,c)=>{let u=P*_[2]-P*c[2];return 0===u&&I&&(u=_[4]-c[4]),u}),S.length){let _=6*S[0][2];p[0]=S[0][0]/_,p[1]=S[0][1]/_,I&&(_=6*S[0][4],p[2]=0!==_?S[0][3]/_:0),(p[0]<x[0]||p[0]>x[1]||p[1]<x[2]||p[1]>x[3]||I&&(p[2]<x[4]||p[2]>x[5]))&&(p.length=0)}if(!p.length){const _=l.lengths[0]?function O(n,l,I,R,U){const P=F(R,U);let p=l,S=l+P,x=0,M=0,N=0,B=0;for(let L=0,_=I-1;L<_;L++,p+=P,S+=P){const c=n[p],u=n[p+1],f=n[p+2],y=n[S],A=n[S+1],C=n[S+2],w=R?m(c,u,f,y,A,C):D(c,u,y,A);if(w)if(x+=w,R){const z=g(c,u,f,y,A,C);M+=w*z[0],N+=w*z[1],B+=w*z[2]}else{const z=h(c,u,y,A);M+=w*z[0],N+=w*z[1]}}return x>0?R?[M/x,N/x,B/x]:[M/x,N/x]:I>0?R?[n[l],n[l+1],n[l+2]]:[n[l],n[l+1]]:null}(N,0,M[0],I,R):null;if(!_)return null;p[0]=_[0],p[1]=_[1],I&&_.length>2&&(p[2]=_[2])}return n}function T(n,l,I,R,U,P,p=1){const S=F(U,P);let x=I,M=I+S,N=0,B=0,L=0,_=0,c=0;for(let f=0,y=R-1;f<y;f++,x+=S,M+=S){const A=l[x],C=l[x+1],w=l[x+2],z=l[M],j=l[M+1],K=l[M+2];let W=A*j-z*C;_+=W,N+=(A+z)*W,B+=(C+j)*W,U&&(W=A*K-z*w,L+=(w+K)*W,c+=W),A<n[0]&&(n[0]=A),A>n[1]&&(n[1]=A),C<n[2]&&(n[2]=C),C>n[3]&&(n[3]=C),U&&(w<n[4]&&(n[4]=w),w>n[5]&&(n[5]=w))}if(_*p>0&&(_*=-1),c*p>0&&(c*=-1),!_)return null;const u=[N,B,.5*_];return U&&(u[3]=L,u[4]=.5*c),u}function D(n,l,I,R){const U=I-n,P=R-l;return Math.sqrt(U*U+P*P)}function m(n,l,I,R,U,P){const p=R-n,S=U-l,x=P-I;return Math.sqrt(p*p+S*S+x*x)}function h(n,l,I,R){return[n+.5*(I-n),l+.5*(R-l)]}function g(n,l,I,R,U,P){return[n+.5*(R-n),l+.5*(U-l),I+.5*(P-I)]}},99666:(k,Z,b)=>{b.d(Z,{KS:()=>g,PX:()=>O,QS:()=>l,_I:()=>v,jL:()=>h,nE:()=>n,vs:()=>m,xp:()=>D});const v=8388607,F=8388608,O=0,D=1,m=I=>(I&F)>>>23,h=I=>I&v,g=I=>m(I)===D?254:255;function n(I){return m(I)===D}function l(I,R){return((R?F:0)|I)>>>0}},31982:(k,Z,b)=>{b.d(Z,{J:()=>F,g:()=>v});const v=(E,T)=>E&&((...O)=>T.warn("DEBUG:",...O))||(()=>null),F=!1},36682:(k,Z,b)=>{b.d(Z,{Z:()=>B});var v=b(15861),F=b(26584),E=b(8314),T=b(63290),O=b(21286),D=b(62208),m=b(10699),h=b(84682),g=b(60466),n=b(39351),l=b(99666),I=b(87526),R=b(31982),U=b(6257),P=b(67969);const p=T.Z.getLogger("esri.views.layers.2d.features.support.AttributeStore"),S=(0,R.g)(R.J,p),x={sharedArrayBuffer:(0,E.Z)("esri-shared-array-buffer"),atomics:(0,E.Z)("esri-atomics")};function M(L,_){return c=>_(L(c))}class N{constructor(_,c,u,f){this.size=0,this.texelSize=4,this.dirtyStart=0,this.dirtyEnd=0;const{pixelType:y,layout:A,textureOnly:C}=f;this.textureOnly=C||!1,this.pixelType=y,this._ctype=c,this.layout=A,this._resetRange(),this._shared=_,this.size=u,C||(this.data=this._initData(y,u,_,c))}get buffer(){return(0,D.yw)(this.data,_=>_.buffer)}unsetComponentAllTexels(_,c){const u=(0,D.Wg)(this.data);for(let f=0;f<this.size*this.size;f++)u[f*this.texelSize+_]&=~c;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponentAllTexels(_,c){const u=(0,D.Wg)(this.data);for(let f=0;f<this.size*this.size;f++)u[f*this.texelSize+_]|=255&c;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponent(_,c,u){const f=(0,D.Wg)(this.data);for(const y of u)f[y*this.texelSize+_]|=c,this.dirtyStart=Math.min(this.dirtyStart,y),this.dirtyEnd=Math.max(this.dirtyEnd,y)}setComponentTexel(_,c,u){(0,D.Wg)(this.data)[u*this.texelSize+_]|=c,this.dirtyStart=Math.min(this.dirtyStart,u),this.dirtyEnd=Math.max(this.dirtyEnd,u)}unsetComponentTexel(_,c,u){(0,D.Wg)(this.data)[u*this.texelSize+_]&=~c,this.dirtyStart=Math.min(this.dirtyStart,u),this.dirtyEnd=Math.max(this.dirtyEnd,u)}getData(_,c){const u=(0,l.jL)(_);return(0,D.Wg)(this.data)[u*this.texelSize+c]}setData(_,c,u){const f=(0,l.jL)(_);this.layout&1<<c?(0,D.Wi)(this.data)||(this.data[f*this.texelSize+c]=u,this.dirtyStart=Math.min(this.dirtyStart,f),this.dirtyEnd=Math.max(this.dirtyEnd,f)):p.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}lock(){this.pixelType===P.Br.UNSIGNED_BYTE&&this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1)}unlock(){this.pixelType===P.Br.UNSIGNED_BYTE&&this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0)}expand(_){if(this.size=_,!this.textureOnly){const c=this._initData(this.pixelType,_,this._shared,this._ctype),u=(0,D.Wg)(this.data);c.set(u),this.data=c}}toMessage(){const _=this.dirtyStart,c=this.dirtyEnd,u=this.texelSize;if(_>c)return null;this._resetRange();const f=!(this._shared||"local"===this._ctype),y=this.pixelType,A=this.layout,C=(0,D.Wg)(this.data);return{start:_,end:c,data:f&&C.slice(_*u,(c+1)*u)||null,pixelType:y,layout:A}}_initData(_,c,u,f){const y=u&&"local"!==f?SharedArrayBuffer:ArrayBuffer,A=(0,I.UK)(_),C=new A(new y(c*c*4*A.BYTES_PER_ELEMENT));for(let w=0;w<C.length;w+=4)C[w+1]=255;return C}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}}class B{constructor(_,c,u=(()=>{})){this._client=_,this.config=c,this._notifyChange=u,this._blocks=new Array,this._filters=new Array(n.m4),this._attributeComputeInfo=null,this._targetType=0,this._abortController=new AbortController,this._hasScaleExpr=!1,this._size=32,this._nextUpdate=null,this._currUpdate=null,this._idsToHighlight=new Set;const f=c.supportsTextureFloat?P.Br.FLOAT:P.Br.UNSIGNED_BYTE;S(`Creating AttributeStore ${x.sharedArrayBuffer?"with":"without"} shared memory`),this._blockDescriptors=[{pixelType:P.Br.UNSIGNED_BYTE,layout:1},{pixelType:P.Br.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:P.Br.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:f,layout:15},{pixelType:f,layout:15},{pixelType:f,layout:15},{pixelType:f,layout:15}],this._blocks=this._blockDescriptors.map(()=>null)}destroy(){this._abortController.abort()}get hasScaleExpr(){return this._hasScaleExpr}get _signal(){return this._abortController.signal}get hasHighlight(){return this._idsToHighlight.size>0}isUpdating(){return!!this._currUpdate||!!this._nextUpdate}update(_,c){this.config=c;const u=c.schema.processors[0].storage,f=(0,h.Hg)(this._schema,u);if((_.targets.feature||_.targets.aggregate)&&(_.storage.data=!0),f&&((0,E.Z)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",f),_.storage.data=!0,this._schema=u,this._attributeComputeInfo=null,!(0,D.Wi)(u))){switch(u.target){case"feature":this._targetType=l.PX;break;case"aggregate":this._targetType=l.xp}if("subtype"===u.type){this._attributeComputeInfo={isSubtype:!0,subtypeField:u.subtypeField,map:new Map};for(const y in u.mapping){const A=u.mapping[y];if((0,D.pC)(A)&&(0,D.pC)(A.vvMapping))for(const C of A.vvMapping)this._bindAttribute(C,parseInt(y,10))}}else{if(this._attributeComputeInfo={isSubtype:!1,map:new Map},(0,D.pC)(u.vvMapping))for(const y of u.vvMapping)this._bindAttribute(y);if((0,D.pC)(u.attributeMapping))for(const y of u.attributeMapping)this._bindAttribute(y)}}}onTileData(_,c){if((0,D.Wi)(c.addOrUpdate))return;const u=c.addOrUpdate.getCursor();for(;u.next();){const f=u.getDisplayId();this.setAttributeData(f,u)}}setHighlight(_,c){var u=this;return(0,v.Z)(function*(){const y=u._getBlock(0),A=c.map(C=>(0,l.jL)(C));y.lock(),y.unsetComponentAllTexels(0,1),y.setComponent(0,1,A),y.unlock(),u._idsToHighlight.clear();for(const C of _)u._idsToHighlight.add(C);yield u.sendUpdates()})()}updateFilters(_,c,u){var f=this;return(0,v.Z)(function*(){const{service:y,spatialReference:A}=u,{filters:C}=c,w=C.map((z,j)=>f._updateFilter(z,j,y,A));(yield Promise.all(w)).some(z=>z)&&(_.storage.filters=!0,(0,E.Z)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))})()}setData(_,c,u,f){const y=(0,l.jL)(_);this._ensureSizeForTexel(y),this._getBlock(c).setData(_,u,f)}getData(_,c,u){return this._getBlock(c).getData(_,u)}getHighlightFlag(_){return this._idsToHighlight.has(_)?n.uG:0}unsetAttributeData(_){const c=(0,l.jL)(_);this._getBlock(0).setData(c,0,0)}setAttributeData(_,c){const u=(0,l.jL)(_);if(this._ensureSizeForTexel(u),this._getBlock(0).setData(u,0,this.getFilterFlags(c)),this._targetType!==(0,l.vs)(_))return;const f=this._attributeComputeInfo,y=this.config.supportsTextureFloat?1:2;let C=null;f&&(C=f.isSubtype?f.map.get(c.readAttribute(f.subtypeField)):f.map,C&&C.size&&C.forEach((w,z)=>{const j=z*y%4,K=Math.floor(z*y/4),W=this._getBlock(K+n.aK),G=w(c);if(this.config.supportsTextureFloat)W.setData(u,j,G);else if(G===n.AI)W.setData(u,j,255),W.setData(u,j+1,255);else{const J=(0,O.uZ)(Math.round(G),-32767,32766)+32768,Y=(65280&J)>>8;W.setData(u,j,255&J),W.setData(u,j+1,Y)}}))}sendUpdates(){if((0,E.Z)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate"),this._notifyChange(),this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=(0,m.hh)(),this._nextUpdate.promise;const _={blocks:this._blocks.map(c=>(0,D.pC)(c)?c.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{const c=()=>{if(this._currUpdate=null,this._nextUpdate){const f=this._nextUpdate;this._nextUpdate=null,this.sendUpdates().then(()=>f.resolve())}else(0,E.Z)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};(0,E.Z)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");const u=this._client.update(_,this._signal).then(c).catch(c);return this._client.render(this._signal),u}).catch(c=>{if((0,m.D_)(c))return this._createResourcesPromise=null,this._createResources();this._notifyChange(),p.error(new F.Z("mapview-attribute-store","Encountered an error during client update",c))}),this._currUpdate}_ensureSizeForTexel(_){for(;_>=this._size*this._size;)if(this._expand())return}_bindAttribute(_,c){let y;if(null!=_.fieldIndex)y=function f(){return _.normalizationField&&p.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported."),z=>z.getComputedNumericAtIndex(_.fieldIndex)}();else{if(!_.field)return;y=function u(){const{normalizationField:z}=_;return z?j=>{const K=j.readAttribute(z);return K?j.readAttribute(_.field)/K:null}:j=>j.readAttribute(_.field)}()}const{valueRepresentation:A}=_;A&&(y=M(y,z=>(0,U.qc)(z,A)));const C=z=>null===z||isNaN(z)||z===1/0||z===-1/0?n.AI:z,w=this._attributeComputeInfo;if(w.isSubtype){const z=w.map.get(c)??new Map;z.set(_.binding,M(y,C)),w.map.set(c,z)}else w.map.set(_.binding,M(y,C))}_createResources(){if((0,D.pC)(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(n.xl),this._getBlock(n.pU),S("Initializing AttributeStore");const _={shared:x.sharedArrayBuffer&&"local"!==this._client.type,size:this._size,blocks:(0,D.Fd)(this._blocks,u=>({textureOnly:u.textureOnly,buffer:u.buffer,pixelType:u.pixelType}))},c=this._client.initialize(_,this._signal).catch(u=>{(0,m.D_)(u)?this._createResourcesPromise=null:p.error(new F.Z("mapview-attribute-store","Encountered an error during client initialization",u))});return this._createResourcesPromise=c,c.then(()=>(0,D.Wi)(this._createResourcesPromise)?this._createResources():void 0),c}_getBlock(_){const c=this._blocks[_];if((0,D.pC)(c))return c;S(`Initializing AttributeBlock at index ${_}`);const y=new N(x.sharedArrayBuffer,this._client.type,this._size,this._blockDescriptors[_]);return this._blocks[_]=y,this._createResourcesPromise=null,y}_expand(){if(this._size<this.config.maxTextureSize){const _=this._size<<=1;return S("Expanding block size to",_,this._blocks),(0,D.JR)(this._blocks,c=>c.expand(_)),this._createResourcesPromise=null,this._size=_,0}return p.error(new F.Z("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}_updateFilter(_,c,u,f){var y=this;return(0,v.Z)(function*(){const A=y._filters[c],C=(0,D.pC)(A)&&A.hash;if(!A&&!_||C===JSON.stringify(_))return!1;if((0,D.Wi)(_)){if(!A)return!1;const z=1<<c+1,j=y._getBlock(0);return y._filters[c]=null,j.setComponentAllTexels(0,z),y.sendUpdates(),!0}return yield(yield y._getFilter(c,u)).update(_,f),!0})()}_getFilter(_,c){var u=this;return(0,v.Z)(function*(){const f=u._filters[_];if((0,D.pC)(f))return f;const{default:y}=yield Promise.all([b.e(8592),b.e(6263)]).then(b.bind(b,8967)),A=new y({geometryType:c.geometryType,hasM:!1,hasZ:!1,timeInfo:c.timeInfo,fieldsIndex:new g.Z(c.fields)});return u._filters[_]=A,A})()}isVisible(_){return!!(2&this._getBlock(0).getData(_,0))}getFilterFlags(_){let c=0;const u=(0,l.KS)(_.getDisplayId());for(let y=0;y<this._filters.length;y++){const C=this._filters[y];c|=(u&1<<y&&!(0,D.Wi)(C)&&!C.check(_)?0:1)<<y}let f=0;if(this._idsToHighlight.size){const y=_.getObjectId();f=this.getHighlightFlag(y)}return c<<1|f}}},93872:(k,Z,b)=>{b.d(Z,{O:()=>O});var v=b(99666);class F{constructor(){this._freeIds=[],this._idCounter=1}createId(m=!1){return(0,v.QS)(this._getFreeId(),m)}releaseId(m){this._freeIds.push(m)}_getFreeId(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}var E=b(42797);function T(D,m,h){if(!(D.length>m))for(;D.length<=m;)D.push(h)}class O{constructor(){this._numerics=[],this._strings=[],this._idGenerator=new F,this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[]}createBitset(){const m=this._bitsets.length;return this._bitsets.push(E.p.create(this._allocatedSize,v._I)),m+1}getBitset(m){return this._bitsets[m-1]}_expand(){this._allocatedSize<<=1;for(const m of this._bitsets)m.resize(this._allocatedSize)}_ensureNumeric(m,h){this._numerics[m]||(this._numerics[m]=[]),T(this._numerics[m],h,0)}_ensureInstanceId(m){T(this._instanceIds,m,0)}_ensureString(m,h){this._strings[m]||(this._strings[m]=[]),T(this._strings[m],h,null)}createDisplayId(m=!1){const h=this._idGenerator.createId();return h>this._allocatedSize&&this._expand(),(0,v.QS)(h,m)}releaseDisplayId(m){for(const h of this._bitsets)h.unset(m);return this._idGenerator.releaseId(m&v._I)}getComputedNumeric(m,h){return this.getComputedNumericAtIndex(m&v._I,0)}setComputedNumeric(m,h,g){return this.setComputedNumericAtIndex(m&v._I,g,0)}getComputedString(m,h){return this.getComputedStringAtIndex(m&v._I,0)}setComputedString(m,h,g){return this.setComputedStringAtIndex(m&v._I,0,g)}getComputedNumericAtIndex(m,h){const g=m&v._I;return this._ensureNumeric(h,g),this._numerics[h][g]}setComputedNumericAtIndex(m,h,g){const n=m&v._I;this._ensureNumeric(h,n),this._numerics[h][n]=g}getInstanceId(m){const h=m&v._I;return this._ensureInstanceId(h),this._instanceIds[h]}setInstanceId(m,h){const g=m&v._I;this._ensureInstanceId(g),this._instanceIds[g]=h}getComputedStringAtIndex(m,h){const g=m&v._I;return this._ensureString(h,g),this._strings[h][g]}setComputedStringAtIndex(m,h,g){const n=m&v._I;this._ensureString(h,n),this._strings[h][n]=g}getXMin(m){return this._bounds[4*(m&v._I)]}getYMin(m){return this._bounds[4*(m&v._I)+1]}getXMax(m){return this._bounds[4*(m&v._I)+2]}getYMax(m){return this._bounds[4*(m&v._I)+3]}setBounds(m,h){const g=h.readHydratedGeometry();if(!g||!g.coords.length)return!1;let n=1/0,l=1/0,I=-1/0,R=-1/0;g.forEachVertex((P,p)=>{n=Math.min(n,P),l=Math.min(l,p),I=Math.max(I,P),R=Math.max(R,p)});const U=m&v._I;return T(this._bounds,4*U+4,0),this._bounds[4*U]=n,this._bounds[4*U+1]=l,this._bounds[4*U+2]=I,this._bounds[4*U+3]=R,!0}}},25208:(k,Z,b)=>{b.d(Z,{s:()=>_}),b(29132);var F=b(91365),E=b(29050),T=b(8314),O=b(62208),D=b(77044),m=b(82054),h=b(88071),g=b(42797),n=b(91179);let l=0;const I=(0,T.Z)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],R=I[0],U=I[1],P=I[2],p=I[3],S=(0,T.Z)("featurelayer-simplify-payload-size-factors")??[1,2,4],x=S[0],M=S[1],N=S[2],B=(0,T.Z)("featurelayer-simplify-mobile-factor")??2,L=(0,T.Z)("esri-mobile");class _{constructor(u,f){this.type="FeatureSetReader",this.arcadeDeclaredClass="esri.arcade.Feature",this.seen=!1,this.instance=0,this._tx=0,this._ty=0,this._sx=1,this._sy=1,this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._level=0,this._datetimeMetadata=null,this.contextTimeReference=null,this.instance=u,this._layerSchema=f}static createInstance(){return l++,l=l>65535?0:l,l}get isEmpty(){return(0,O.pC)(this._deleted)&&this._deleted.countSet()===this.getSize()}set level(u){this._level=u}getAreaSimplificationThreshold(u,f){let y=1;const A=L?B:1;f>4e6?y=N*A:f>1e6?y=M*A:f>5e5?y=x*A:f>1e5&&(y=A);let C=0;u>4e3?C=p*y:u>2e3?C=P*y:u>100?C=U:u>15&&(C=R);let w=8;return this._level<4?w=1:this._level<5?w=2:this._level<6&&(w=4),C*w}createQuantizedExtrudedQuad(u,f){return new h.Z([5],[u-1,f,1,-1,1,1,-1,1,-1,-1])}setArcadeSpatialReference(u){this._arcadeSpatialReference=u}attachStorage(u){this._storage=u}getQuantizationTransform(){throw new Error("Unable to find transform for featureSet")}getStorage(){return this._storage}getComputedNumeric(u){return this.getComputedNumericAtIndex(0)}setComputedNumeric(u,f){return this.setComputedNumericAtIndex(f,0)}getComputedString(u){return this.getComputedStringAtIndex(0)}setComputedString(u,f){return this.setComputedStringAtIndex(0,f)}getComputedNumericAtIndex(u){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),u)}setComputedNumericAtIndex(u,f){this._storage.setComputedNumericAtIndex(this.getDisplayId(),u,f)}getComputedStringAtIndex(u){return this._storage.getComputedStringAtIndex(this.getDisplayId(),u)}setComputedStringAtIndex(u,f){return this._storage.setComputedStringAtIndex(this.getDisplayId(),u,f)}transform(u,f,y,A){const C=this.copy();return C._tx+=u,C._ty+=f,C._sx*=y,C._sy*=A,C}readAttribute(u,f=!1){const y=this._readAttribute(u,f);if(void 0!==y)return y;for(const A of this._joined){A.setIndex(this.getIndex());const C=A._readAttribute(u,f);if(void 0!==C)return C}}readAttributes(){const u=this._readAttributes();for(const f of this._joined){f.setIndex(this.getIndex());const y=f._readAttributes();for(const A of Object.keys(y))u[A]=y[A]}return u}joinAttributes(u){this._joined.push(u)}readArcadeFeature(){return this}geometry(){const u=this.readHydratedGeometry(),f=(0,m.di)(u,this.geometryType,this.hasZ,this.hasM),y=(0,n.im)(f);return y&&(y.spatialReference=this._arcadeSpatialReference),y}get dateTimeReferenceFieldIndex(){return this._datetimeMetadata||(this._datetimeMetadata=E.nu.create(this._layerSchema.fields,this._layerSchema)),this._datetimeMetadata}autocastArcadeDate(u,f){return f&&f instanceof Date?this.isUnknownDateTimeField(u)?F.iG.unknownDateJSToArcadeDate(f):F.iG.dateJSAndZoneToArcadeDate(f,this.contextTimeReference?.timeZone??"system"):f}isUnknownDateTimeField(u){return"unknown"===this.dateTimeReferenceFieldIndex?.fieldTimeZone(u)}fieldSourceTimeZone(u){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(u)??""}get layerPreferredTimeZone(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}field(u){if(this.hasField(u))return this.autocastArcadeDate(u,this.readAttribute(u,!0));for(const f of this._joined)if(f.setIndex(this.getIndex()),f.hasField(u)){const y=f._readAttribute(u,!0);return this.autocastArcadeDate(u,y)}throw new Error(`Field ${u} does not exist`)}setField(u,f){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.getFieldNames()}castToText(u=!1){if(!u)return JSON.stringify(this.readLegacyFeature());const f=this.readLegacyFeature();if(!f)return JSON.stringify(null);const y={geometry:f.geometry,attributes:{...f.attributes?f.attributes:{}}};for(const A in y.attributes){const C=y.attributes[A];C instanceof Date&&(y.attributes[A]=C.getTime())}return JSON.stringify(y)}gdbVersion(){return null}fullSchema(){return this._layerSchema}castAsJson(u=null){return{attributes:this._readAttributes(),geometry:!0===u?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(u=null,f=null){return Promise.resolve(this.castAsJson(f))}removeIds(u){if((0,O.Wi)(this._objectIdToIndex)){const y=new Map,A=this.getCursor();for(;A.next();){const C=(0,O.s3)(A.getObjectId());y.set(C,A.getIndex())}this._objectIdToIndex=y}const f=this._objectIdToIndex;for(const y of u)f.has(y)&&this.removeAtIndex(f.get(y))}removeAtIndex(u){(0,O.Wi)(this._deleted)&&(this._deleted=g.p.create(this.getSize())),this._deleted.set(u)}readGeometryForDisplay(){return this.readUnquantizedGeometry(!0)}readLegacyGeometryForDisplay(){return this.readLegacyGeometry(!0)}*features(){const u=this.getCursor();for(;u.next();)yield u.readOptimizedFeature()}_getExists(){return(0,O.Wi)(this._deleted)||!this._deleted.has(this.getIndex())}_computeCentroid(){if("esriGeometryPolygon"!==this.geometryType)return null;const u=this.readUnquantizedGeometry();if(!u||u.hasIndeterminateRingOrder)return null;const f=(0,O.Pt)(this.getQuantizationTransform(),null);return(0,D.Y)(new h.Z,u,this.hasM,this.hasZ,f)}copyInto(u){u.seen=this.seen,u._storage=this._storage,u._arcadeSpatialReference=this._arcadeSpatialReference,u._joined=this._joined,u._tx=this._tx,u._ty=this._ty,u._sx=this._sx,u._sy=this._sy,u._deleted=this._deleted,u._objectIdToIndex=this._objectIdToIndex}}},64822:(k,Z,b)=>{b.d(Z,{i:()=>D});var v=b(62208),F=b(82054),E=b(66385),T=b(25208);class D extends T.s{static fromFeatures(h,g){const{objectIdField:n,geometryType:l}=g,I=(0,F.Yn)([],h,l,!1,!1,n);for(let R=0;R<I.length;R++)I[R].displayId=h[R].displayId;return D.fromOptimizedFeatures(I,g)}static fromFeatureSet(h,g){const n=(0,F.h_)(h,g.objectIdField);return D.fromOptimizedFeatureSet(n,g)}static fromOptimizedFeatureSet(h,g){const{features:n}=h,l=D.fromOptimizedFeatures(n,g);l._exceededTransferLimit=h.exceededTransferLimit,l._transform=h.transform;for(const I of h.fields)"esriFieldTypeDate"===I.type&&l._dateFields.add(I.name);return l}static fromOptimizedFeatures(h,g,n){const l=T.s.createInstance(),I=new D(l,h,g);return I._transform=n,I}constructor(h,g,n){super(h,n),this._exceededTransferLimit=!1,this._featureIndex=-1,this._dateFields=new Set,this._geometryType=n?.geometryType,this._features=g}get _current(){return this._features[this._featureIndex]}get geometryType(){return this._geometryType}get hasFeatures(){return!!this._features.length}get hasNext(){return this._featureIndex+1<this._features.length}get exceededTransferLimit(){return this._exceededTransferLimit}get hasZ(){return!1}get hasM(){return!1}removeIds(h){const g=new Set(h);this._features=this._features.filter(n=>!(n.objectId&&g.has(n.objectId)))}append(h){for(const g of h)this._features.push(g)}getSize(){return this._features.length}getCursor(){return this.copy()}getQuantizationTransform(){return this._transform}getAttributeHash(){let h="";for(const g in this._current.attributes)h+=this._current.attributes[g];return h}getIndex(){return this._featureIndex}setIndex(h){this._featureIndex=h}getObjectId(){return this._current?.objectId}getDisplayId(){return this._current.displayId}setDisplayId(h){this._current.displayId=h}getGroupId(){return this._current.groupId}setGroupId(h){this._current.groupId=h}copy(){const h=new D(this.instance,this._features,this.fullSchema());return this.copyInto(h),h}next(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}readLegacyFeature(){return(0,F.EI)(this._current,this.geometryType,this.hasZ,this.hasM)}readOptimizedFeature(){return this._current}readLegacyPointGeometry(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null}readLegacyGeometry(){const h=this.readGeometry();return(0,F.di)(h,this.geometryType,this.hasZ,this.hasM)}readLegacyCentroid(){const h=this.readCentroid();return(0,v.Wi)(h)?null:{x:h.coords[0]*this._sx+this._tx,y:h.coords[1]*this._sy+this._ty}}readGeometryArea(){return(0,E.S6)(this._current)?(0,F.lz)(this._current.geometry,2):0}readUnquantizedGeometry(){const h=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!h)return h;const g=h.clone();return function O({coords:m,lengths:h}){let g=0;for(const n of h){for(let l=1;l<n;l++)m[2*(g+l)]+=m[2*(g+l)-2],m[2*(g+l)+1]+=m[2*(g+l)-1];g+=n}}(g),g}readHydratedGeometry(){const h=this._current.geometry;if((0,v.Wi)(h))return null;const g=h.clone();return(0,v.pC)(this._transform)&&(0,F.$g)(g,g,this.hasZ,this.hasM,this._transform),g}getXHydrated(){if(!(0,E.S6)(this._current))return 0;const h=this._current.geometry.coords[0],g=this.getQuantizationTransform();return(0,v.Wi)(g)?h:h*g.scale[0]+g.translate[0]}getYHydrated(){if(!(0,E.S6)(this._current))return 0;const h=this._current.geometry.coords[1],g=this.getQuantizationTransform();return(0,v.Wi)(g)?h:g.translate[1]-h*g.scale[1]}getX(){return(0,E.S6)(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0}getY(){return(0,E.S6)(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0}readGeometry(){if(!(0,E.S6)(this._current)){if((0,v.pC)(this._current.centroid)){const[n,l]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(n,l)}return null}const h=this._current.geometry.clone();if(h.isPoint)return h.coords[0]=h.coords[0]*this._sx+this._tx,h.coords[1]=h.coords[1]*this._sy+this._ty,h;let g=0;for(const n of h.lengths)h.coords[2*g]=h.coords[2*g]*this._sx+this._tx,h.coords[2*g+1]=h.coords[2*g+1]*this._sy+this._ty,g+=n;return h}readCentroid(){return(0,E.S6)(this._current)?this._computeCentroid():this._current.centroid}hasField(h){return h in this._current.attributes||this.getFieldNames().map(g=>g.toLowerCase()).includes(h.toLowerCase())}getFieldNames(){return Object.keys(this._current.attributes)}_readAttribute(h,g){const n=this._current.attributes[h];if(void 0!==n)return null!=n&&g&&this._dateFields.has(h)?new Date(n):n;const l=this.readAttributes(),I=h?.toLocaleLowerCase().trim();for(const R in l)if(R.toLocaleLowerCase().trim()===I){const U=this._current.attributes[R];return null!=U&&g&&this._dateFields.has(R)?new Date(U):U}}copyInto(h){super.copyInto(h),h._featureIndex=this._featureIndex,h._transform=this._transform,h._dateFields=this._dateFields}_readAttributes(){return this._current.attributes}}},42797:(k,Z,b)=>{b.d(Z,{p:()=>v});class v{static fromBuffer(E,T){return new v(E,T)}static create(E,T=4294967295){const O=new Uint32Array(Math.ceil(E/32));return new v(O,T)}constructor(E,T){this._mask=0,this._buf=E,this._mask=T}_getIndex(E){return Math.floor(E/32)}has(E){const T=this._mask&E;return!!(this._buf[this._getIndex(T)]&1<<T%32)}hasRange(E,T){let O=E,D=T;for(;O%32&&O!==D;){if(this.has(O))return!0;O++}for(;D%32&&O!==D;){if(this.has(O))return!0;D--}if(O===D)return!1;for(let m=O/32;m!==D/32;m++)if(this._buf[m])return!0;return!1}set(E){const T=this._mask&E,O=this._getIndex(T);this._buf[O]|=1<<T%32}setRange(E,T){let O=E,D=T;for(;O%32&&O!==D;)this.set(O++);for(;D%32&&O!==D;)this.set(D--);if(O!==D)for(let m=O/32;m!==D/32;m++)this._buf[m]=4294967295}unset(E){const T=this._mask&E,O=this._getIndex(T);this._buf[O]&=4294967295^1<<T%32}resize(E){const T=this._buf,O=new Uint32Array(Math.ceil(E/32));O.set(T),this._buf=O}or(E){for(let T=0;T<this._buf.length;T++)this._buf[T]|=E._buf[T];return this}and(E){for(let T=0;T<this._buf.length;T++)this._buf[T]&=E._buf[T];return this}xor(E){for(let T=0;T<this._buf.length;T++)this._buf[T]^=E._buf[T];return this}ior(E){for(let T=0;T<this._buf.length;T++)this._buf[T]|=~E._buf[T];return this}iand(E){for(let T=0;T<this._buf.length;T++)this._buf[T]&=~E._buf[T];return this}ixor(E){for(let T=0;T<this._buf.length;T++)this._buf[T]^=~E._buf[T];return this}any(){for(let E=0;E<this._buf.length;E++)if(this._buf[E])return!0;return!1}copy(E){for(let T=0;T<this._buf.length;T++)this._buf[T]=E._buf[T];return this}clone(){return new v(this._buf.slice(),this._mask)}clear(){for(let E=0;E<this._buf.length;E++)this._buf[E]=0}forEachSet(E){for(let T=0;T<this._buf.length;T++){let O=this._buf[T],D=32*T;if(O)for(;O;)1&O&&E(D),O>>>=1,D++}}countSet(){let E=0;return this.forEachSet(T=>{E++}),E}}},6257:(k,Z,b)=>{b.d(Z,{I:()=>I,qc:()=>m});var v=b(62208),F=b(23841),E=b(81295),T=b(39351),O=b(39406),D=b(25310);function m(p,S){if(!p||!S)return p;switch(S){case"radius":case"distance":return 2*p;case"diameter":case"width":return p;case"area":return Math.sqrt(p)}return p}function g(p){return(p??[]).map(S=>function h(p){return{value:p.value,size:(0,F.t_)(p.size)}}(S))}function n(p){return"string"==typeof p||"number"==typeof p?(0,F.t_)(p):{type:"size",expression:p.expression,stops:g(p.stops)}}const l=p=>{const S=[],x=[],M=g(p),N=M.length;for(let B=0;B<6;B++){const L=M[Math.min(B,N-1)];S.push(L.value),x.push(null==L.size?T.AI:(0,F.F2)(L.size))}return{values:new Float32Array(S),sizes:new Float32Array(x)}};function I(p){const S=p&&p.length>0?{}:null,x=S?{}:null;if(!S||!x)return{vvFields:S,vvRanges:x};for(const M of p)if(M.field&&(S[M.type]=M.field),"size"===M.type){x.size||(x.size={});const N=M;switch((0,D.a)(N)){case O.X.SIZE_MINMAX_VALUE:x.size.minMaxValue={minDataValue:N.minDataValue,maxDataValue:N.maxDataValue,minSize:n(N.minSize),maxSize:n(N.maxSize)};break;case O.X.SIZE_SCALE_STOPS:x.size.scaleStops={stops:g(N.stops)};break;case O.X.SIZE_FIELD_STOPS:if(N.levels){const B={};for(const L in N.levels)B[L]=l(N.levels[L]);x.size.fieldStops={type:"level-dependent",levels:B}}else x.size.fieldStops={type:"static",...l(N.stops)};break;case O.X.SIZE_UNIT_VALUE:x.size.unitValue={unit:N.valueUnit,valueRepresentation:N.valueRepresentation??void 0}}}else"color"===M.type?x.color=P(M):"opacity"===M.type?x.opacity=R(M):"rotation"===M.type&&(x.rotation={type:M.rotationType});return{vvFields:S,vvRanges:x}}function R(p){const S={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof p.field){if(!p.stops)return null;{if(p.stops.length>8)return null;const x=p.stops;for(let M=0;M<8;++M){const N=x[Math.min(M,x.length-1)];S.values[M]=N.value,S.opacities[M]=N.opacity}}}else{if(!(p.stops&&p.stops.length>=0))return null;{const x=p.stops&&p.stops.length>=0?p.stops[0].opacity:0;for(let M=0;M<8;M++)S.values[M]=1/0,S.opacities[M]=x}}return S}function U(p,S,x){p[4*S+0]=x.r/255,p[4*S+1]=x.g/255,p[4*S+2]=x.b/255,p[4*S+3]=x.a}function P(p){if((0,v.Wi)(p)||p.normalizationField)return null;const S={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof p.field){if(!p.stops)return null;{if(p.stops.length>8)return null;S.field=p.field;const x=p.stops;for(let M=0;M<8;++M){const N=x[Math.min(M,x.length-1)];S.values[M]=N.value,U(S.colors,M,N.color)}}}else{if(!(p.stops&&p.stops.length>=0))return null;{const x=p.stops&&p.stops.length>=0&&p.stops[0].color;for(let M=0;M<8;M++)S.values[M]=1/0,U(S.colors,M,x)}}for(let x=0;x<32;x+=4)(0,E.pr)(S.colors,x,!0);return S}}}]);
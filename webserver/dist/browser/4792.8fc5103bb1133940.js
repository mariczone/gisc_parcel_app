"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[4792],{11915:(te,K,m)=>{m.d(K,{e:()=>R});var x,f,R={};x={get exports(){return R},set exports(D){R=D}},void 0!==(f=function(){function D(e,t,r){r=r||2;var n,s,i,o,y,E,F,Y=t&&t.length,X=Y?t[0]*r:e.length,Z=P(e,0,X,r,!0),C=[];if(!Z||Z.next===Z.prev)return C;if(Y&&(Z=function U(e,t,r,n){var s,i,o,y=[];for(s=0,i=t.length;s<i;s++)(o=P(e,t[s]*n,s<i-1?t[s+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),y.push(ee(o));for(y.sort(B),s=0;s<y.length;s++)r=T(r=G(y[s],r),r.next);return r}(e,t,Z,r)),e.length>80*r){n=i=e[0],s=o=e[1];for(var I=r;I<X;I+=r)(y=e[I])<n&&(n=y),(E=e[I+1])<s&&(s=E),y>i&&(i=y),E>o&&(o=E);F=0!==(F=Math.max(i-n,o-s))?1/F:0}return V(Z,C,r,n,s,F),C}function P(e,t,r,n,s){var i,o;if(s===A(e,t,r,n)>0)for(i=t;i<r;i+=n)o=w(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=w(i,e[i],e[i+1],o);if(o&&l(o,o.next)){var y=o.next;_(o),o=y}return o}function T(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!l(n,n.next)&&0!==h(n.prev,n,n.next))n=n.next;else{var s=n.prev;if(_(n),(n=t=s)===n.next)break;r=!0}}while(r||n!==t);return t}function V(e,t,r,n,s,i,o){if(e){!o&&i&&function q(e,t,r,n){var s=e;do{null===s.z&&(s.z=$(s.x,s.y,t,r,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,function H(e){var t,r,n,s,i,o,y,E,F=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,y=0,t=0;t<F&&(y++,n=n.nextZ);t++);for(E=F;y>0||E>0&&n;)0!==y&&(0===E||!n||r.z<=n.z)?(s=r,r=r.nextZ,y--):(s=n,n=n.nextZ,E--),i?i.nextZ=s:e=s,s.prevZ=i,i=s;r=n}i.nextZ=null,F*=2}while(o>1)}(s)}(e,n,s,i);for(var y,E,F=e;e.prev!==e.next;)if(y=e.prev,E=e.next,i?L(e,n,s,i):c(e))t.push(y.i/r),t.push(e.i/r),t.push(E.i/r),_(e),e=E.next,F=E.next;else if((e=E)===F){o?1===o?V(e=M(T(e),t,r),t,r,n,s,i,2):2===o&&O(e,t,r,n,s,i):V(T(e),t,r,n,s,i,1);break}}}function c(e){var t=e.prev,r=e,n=e.next;if(h(t,r,n)>=0)return!1;for(var s=e.next.next;s!==e.prev;){if(W(t.x,t.y,r.x,r.y,n.x,n.y,s.x,s.y)&&h(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function L(e,t,r,n){var s=e.prev,i=e,o=e.next;if(h(s,i,o)>=0)return!1;for(var F=s.x>i.x?s.x>o.x?s.x:o.x:i.x>o.x?i.x:o.x,Y=s.y>i.y?s.y>o.y?s.y:o.y:i.y>o.y?i.y:o.y,X=$(s.x<i.x?s.x<o.x?s.x:o.x:i.x<o.x?i.x:o.x,s.y<i.y?s.y<o.y?s.y:o.y:i.y<o.y?i.y:o.y,t,r,n),Z=$(F,Y,t,r,n),C=e.prevZ,I=e.nextZ;C&&C.z>=X&&I&&I.z<=Z;){if(C!==e.prev&&C!==e.next&&W(s.x,s.y,i.x,i.y,o.x,o.y,C.x,C.y)&&h(C.prev,C,C.next)>=0||(C=C.prevZ,I!==e.prev&&I!==e.next&&W(s.x,s.y,i.x,i.y,o.x,o.y,I.x,I.y)&&h(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;C&&C.z>=X;){if(C!==e.prev&&C!==e.next&&W(s.x,s.y,i.x,i.y,o.x,o.y,C.x,C.y)&&h(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;I&&I.z<=Z;){if(I!==e.prev&&I!==e.next&&W(s.x,s.y,i.x,i.y,o.x,o.y,I.x,I.y)&&h(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function M(e,t,r){var n=e;do{var s=n.prev,i=n.next.next;!l(s,i)&&a(s,n,n.next,i)&&p(s,i)&&p(i,s)&&(t.push(s.i/r),t.push(n.i/r),t.push(i.i/r),_(n),_(n.next),n=e=i),n=n.next}while(n!==e);return T(n)}function O(e,t,r,n,s,i){var o=e;do{for(var y=o.next.next;y!==o.prev;){if(o.i!==y.i&&J(o,y)){var E=g(o,y);return o=T(o,o.next),E=T(E,E.next),V(o,t,r,n,s,i),void V(E,t,r,n,s,i)}y=y.next}o=o.next}while(o!==e)}function B(e,t){return e.x-t.x}function j(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function G(e,t){var r=function Q(e,t){var r,n=t,s=e.x,i=e.y,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var y=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(y<=s&&y>o){if(o=y,y===s){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(s===o)return r;var E,F=r,Y=r.x,X=r.y,Z=1/0;n=r;do{s>=n.x&&n.x>=Y&&s!==n.x&&W(i<X?s:o,i,Y,X,i<X?o:s,i,n.x,n.y)&&(E=Math.abs(i-n.y)/(s-n.x),p(n,e)&&(E<Z||E===Z&&(n.x>r.x||n.x===r.x&&k(r,n)))&&(r=n,Z=E)),n=n.next}while(n!==F);return r}(e,t);if(!r)return t;var n=g(r,e),s=T(r,r.next);let i=j(n);return T(i,i.next),s=j(s),j(t===r?s:t)}function k(e,t){return h(e.prev,e,t.prev)<0&&h(t.next,e,e.next)<0}function $(e,t,r,n,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ee(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function W(e,t,r,n,s,i,o,y){return(s-o)*(t-y)-(e-o)*(i-y)>=0&&(e-o)*(n-y)-(r-o)*(t-y)>=0&&(r-o)*(i-y)-(s-o)*(n-y)>=0}function J(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function d(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&a(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(p(e,t)&&p(t,e)&&function S(e,t){var r=e,n=!1,s=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&s<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(h(e.prev,e,t.prev)||h(e,t.prev,t))||l(e,t)&&h(e.prev,e,e.next)>0&&h(t.prev,t,t.next)>0)}function h(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function l(e,t){return e.x===t.x&&e.y===t.y}function a(e,t,r,n){var s=v(h(e,t,r)),i=v(h(e,t,n)),o=v(h(r,n,e)),y=v(h(r,n,t));return s!==i&&o!==y||!(0!==s||!u(e,r,t))||!(0!==i||!u(e,n,t))||!(0!==o||!u(r,e,n))||!(0!==y||!u(r,t,n))}function u(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function v(e){return e>0?1:e<0?-1:0}function p(e,t){return h(e.prev,e,e.next)<0?h(e,t,e.next)>=0&&h(e,e.prev,t)>=0:h(e,t,e.prev)<0||h(e,e.next,t)<0}function g(e,t){var r=new z(e.i,e.x,e.y),n=new z(t.i,t.x,t.y),s=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=s,s.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function w(e,t,r,n){var s=new z(e,t,r);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function _(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function z(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,r,n){for(var s=0,i=t,o=r-n;i<r;i+=n)s+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return s}return D.deviation=function(e,t,r,n){var s=t&&t.length,o=Math.abs(A(e,0,s?t[0]*r:e.length,r));if(s)for(var y=0,E=t.length;y<E;y++)o-=Math.abs(A(e,t[y]*r,y<E-1?t[y+1]*r:e.length,r));var X=0;for(y=0;y<n.length;y+=3){var Z=n[y]*r,C=n[y+1]*r,I=n[y+2]*r;X+=Math.abs((e[Z]-e[I])*(e[C+1]-e[Z+1])-(e[Z]-e[C])*(e[I+1]-e[Z+1]))}return 0===o&&0===X?0:Math.abs((X-o)/o)},D.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,s=0;s<e.length;s++){for(var i=0;i<e[s].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[s][i][o]);s>0&&r.holes.push(n+=e[s-1].length)}return r},D}())&&(x.exports=f)},36161:(te,K,m)=>{m.d(K,{I:()=>b,v:()=>f});var x=m(21286);function b(T,V,c=0){const L=(0,x.uZ)(T,0,D);for(let M=0;M<4;M++)V[c+M]=Math.floor(256*P(L*R[M]))}function f(T,V=0){let c=0;for(let L=0;L<4;L++)c+=T[V+L]*N[L];return c}const R=[1,256,65536,16777216],N=[1/256,1/65536,1/16777216,1/4294967296],D=f(new Uint8ClampedArray([255,255,255,255]));function P(T){return T-Math.floor(T)}},39236:(te,K,m)=>{m.d(K,{Z:()=>N});var x=m(26584),b=m(63290),f=m(62208),R=m(7848);function N(V,c,L,M,O){if((0,f.Wi)(V))return null;const U=V.referencesGeometry()&&O?function P(V,c,L){const{transform:M,hasZ:O,hasM:U}=L;D.has(c)||D.set(c,function T(V){const c={};switch(V){case"esriGeometryPoint":return(L,M,O,U)=>(0,R.U1)(M,c,L,O,U);case"esriGeometryPolygon":return(L,M,O,U)=>(0,R.Ie)(M,c,L,O,U);case"esriGeometryPolyline":return(L,M,O,U)=>(0,R.G6)(M,c,L,O,U);case"esriGeometryMultipoint":return(L,M,O,U)=>(0,R.J9)(M,c,L,O,U);default:return b.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new x.Z("mapview-arcade",`Unable to handle geometryType: ${V}`)),L=>L}}(c));const B=D.get(c)(V.geometry,M,O,U);return{...V,geometry:B}}(c,M,O):c,B=V.repurposeFeature(U);try{return V.evaluate({...L,$feature:B})}catch(j){return b.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",j),null}}const D=new Map},43289:(te,K,m)=>{m.d(K,{k3:()=>P,s5:()=>D}),Math;const f=1/Math.LN2;function D(c){return function R(c,L){return(c%=L)>=0?c:c+L}(.7111111111111111*c,256)}function P(c){return Math.log(c)*f}},40028:(te,K,m)=>{var x,b,c;function f(c){switch(c){case"left":return x.Left;case"right":return x.Right;case"center":return x.Center}}function R(c){switch(c){case"top":return b.Top;case"middle":return b.Center;case"baseline":return b.Baseline;case"bottom":return b.Bottom}}function N(c){switch(c){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[x.Right,b.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[x.Center,b.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[x.Left,b.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[x.Right,b.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[x.Center,b.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[x.Left,b.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[x.Right,b.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[x.Center,b.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[x.Left,b.Top];default:return console.debug(`Found invalid placement type ${c}`),[x.Center,b.Center]}}function D(c){switch(c){case x.Right:return-1;case x.Center:return 0;case x.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${c}`),0}}function P(c){switch(c){case b.Top:return 1;case b.Center:return 0;case b.Bottom:case b.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${c}`),0}}function T(c){switch(c){case"left":return x.Left;case"right":return x.Right;case"center":return x.Center}}function V(c){switch(c){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}m.d(K,{Hd:()=>T,M7:()=>x,NS:()=>V,TR:()=>b,b7:()=>R,g:()=>D,kH:()=>f,qv:()=>N,tf:()=>P}),(c=x||(x={}))[c.Left=-1]="Left",c[c.Center=0]="Center",c[c.Right=1]="Right",function(c){c[c.Top=1]="Top",c[c.Center=0]="Center",c[c.Bottom=-1]="Bottom",c[c.Baseline=2]="Baseline"}(b||(b={}))},18716:(te,K,m)=>{m.d(K,{CA:()=>h,Gq:()=>A,Xp:()=>J,a:()=>_,dk:()=>g,hF:()=>a,jj:()=>l,jy:()=>W,m2:()=>u,mE:()=>w,qr:()=>z});var x=m(26584),b=m(40028),f=m(39406);const $=Object.keys(f.mD).filter(e=>"number"==typeof f.mD[e]).reduce((e,t)=>({...e,[t]:f.mD[t]}),{});function W(e){return e===f.mD.OUTLINE_FILL||e===f.mD.OUTLINE_FILL_SIMPLE}function J(e){return function ee(e){return e===f.mD.SIMPLE||e===f.mD.OUTLINE_FILL_SIMPLE}(e.symbologyType)}function h(e){return W(e.symbologyType)}function l(e,t){switch(e){case f.LW.FILL:return g.from(t);case f.LW.LINE:return _.from(t);case f.LW.MARKER:return w.from(t);case f.LW.TEXT:return z.from(t);case f.LW.LABEL:return A.from(t);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${e}`)}}function a(e){switch(u.load(e).geometryType){case f.LW.MARKER:return new w(e);case f.LW.FILL:return new g(e);case f.LW.LINE:return new _(e);case f.LW.TEXT:return new z(e);case f.LW.LABEL:return new A(e)}}class u{static load(t){const r=this.shared;return r.data=t,r}constructor(t){this._data=0,this._data=t}set data(t){this._data=t??0}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(t){this.setBits(t,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(t){this.setBit(20,t)}get sdf(){return!!this.bit(11)}set sdf(t){this.setBit(11,t??!1)}get pattern(){return!!this.bit(12)}set pattern(t){this.setBit(12,t)}get textureBinding(){return this.bits(0,8)}set textureBinding(t){this.setBits(t,0,8)}get symbologyType(){return this.bits(21,26)}set symbologyType(t){this.setBits(t,21,26)}get geometryTypeString(){switch(this.geometryType){case f.LW.FILL:return"fill";case f.LW.MARKER:return"marker";case f.LW.LINE:return"line";case f.LW.TEXT:return"text";case f.LW.LABEL:return"label";default:throw new x.Z(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(t,r){const n=1<<t;r?this._data|=n:this._data&=~n}bit(t){return(this._data&1<<t)>>t}setBits(t,r,n){for(let s=r,i=0;s<n;s++,i++)this.setBit(s,0!=(t&1<<i))}bits(t,r){let n=0;for(let s=t,i=0;s<r;s++,i++)n|=this.bit(s)<<i;return n}hasVV(){return!1}setVV(t,r){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:f.mD[this.symbologyType],options:$,namespace:"SYMBOLOGY_TYPE"}}}getVariationHash(){return this._data&~(7&this.textureBinding)}}u.shared=new u(0);const v=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(t){this.setBit(16,t)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(t){this.setBit(17,t)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(t){this.setBit(18,t)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(t){this.setBit(19,t)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(t,r){super.setVV(t,r);const n=function R(e,t,r){const n=f.X.SIZE_FIELD_STOPS|f.X.SIZE_MINMAX_VALUE|f.X.SIZE_SCALE_STOPS|f.X.SIZE_UNIT_VALUE,s=(t&(f.mf.FIELD_TARGETS_OUTLINE|f.mf.MINMAX_TARGETS_OUTLINE|f.mf.SCALE_TARGETS_OUTLINE|f.mf.UNIT_TARGETS_OUTLINE))>>>4;return e===f.LW.LINE&&r.isOutline||e===f.LW.FILL&&W(r.symbologyType)?n&s:n&~s}(this.geometryType,t,r)&t;this.vvSizeMinMaxValue=!!(n&f.X.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(n&f.X.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(n&f.X.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(n&f.X.SIZE_SCALE_STOPS)}},d=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(t){this.setBit(15,t)}hasVV(){return super.hasVV()||this.vvRotation}setVV(t,r){super.setVV(t,r),this.vvRotation=!r.isOutline&&!!(t&f.X.ROTATION)}},p=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(t){this.setBit(13,t)}hasVV(){return super.hasVV()||this.vvColor}setVV(t,r){super.setVV(t,r),this.vvColor=!r.isOutline&&!!(t&f.X.COLOR)}},S=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(t){this.setBit(14,t)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(t,r){super.setVV(t,r),this.vvOpacity=!r.isOutline&&!!(t&f.X.OPACITY)}};class g extends(p(S(v(u)))){static load(t){const r=this.shared;return r.data=t,r}static from(t){const{symbologyType:r,vvFlags:n}=t,s=this.load(0);return s.geometryType=f.LW.FILL,s.symbologyType=r,r!==f.mD.DOT_DENSITY&&s.setVV(n,t),s.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}g.shared=new g(0);class w extends(p(S(d(v(u))))){static load(t){const r=this.shared;return r.data=t,r}static from(t){const{symbologyType:r,vvFlags:n}=t,s=this.load(0);return s.geometryType=f.LW.MARKER,s.symbologyType=r,r!==f.mD.HEATMAP&&s.setVV(n,t),s.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}w.shared=new w(0);class _ extends(p(S(v(u)))){static load(t){const r=this.shared;return r.data=t,r}static from(t){const r=this.load(0);return r.geometryType=f.LW.LINE,r.symbologyType=t.symbologyType,r.setVV(t.vvFlags,t),r.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}_.shared=new _(0);class z extends(p(S(d(v(u))))){static load(t){const r=this.shared;return r.data=t,r}static from(t){const r=this.load(0);return r.geometryType=f.LW.TEXT,r.symbologyType=t.symbologyType,r.setVV(t.vvFlags,t),r.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}z.shared=new z(0);class A extends(v(u)){static load(t){const r=this.shared;return r.data=t,r}static from(t){const r=this.load(0);return r.geometryType=f.LW.LABEL,r.symbologyType=t.symbologyType,r.setVV(t.vvFlags,t),r.mapAligned=(0,b.NS)(t.placement),r.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}A.shared=new A(0)},61517:(te,K,m)=>{m.r(K),m.d(K,{default:()=>h});var x=m(15861),b=m(17626),f=m(986),P=(m(26584),m(8314),m(63290),m(62208)),T=m(10699),L=(m(90912),m(85931),m(76898)),M=m(84682),O=m(65234),U=m(99666),B=m(39406),j=m(55130),G=m(246),Q=m(1825),k=m(32940),q=m(32954),H=m(13112);class ${constructor(a){this._remoteClient=a,this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){}fetchResource(a,u){var v=this;return(0,x.Z)(function*(){const d=v._resourceMap,p=d.get(a);if(p)return p;let S=v._inFlightResourceMap.get(a);if(S)return S;try{S=v._remoteClient.invoke("tileRenderer.fetchResource",{url:a},{...u}),v._inFlightResourceMap.set(a,S),S.then(g=>(v._inFlightResourceMap.delete(a),d.set(a,g),g))}catch(g){return(0,T.D_)(g)?null:{width:0,height:0}}return S})()}getResource(a){return this._resourceMap.get(a)??null}}function ee(l,a){return(!l.minScale||l.minScale>=a)&&(!l.maxScale||l.maxScale<=a)}function W(l){const a=l.message,u={message:{data:{},tileKey:a.tileKey,tileKeyOrigin:a.tileKeyOrigin,version:a.version},transferList:new Array};for(const v in a.data){const d=a.data[v];if(u.message.data[v]=null,(0,P.pC)(d)){const p=d.stride,S=d.indices.slice(0),g=d.vertices.slice(0),w=d.records.slice(0),_={stride:p,indices:S,vertices:g,records:w,metrics:(0,P.yw)(d.metrics,z=>z.slice(0))};u.transferList.push(S,g,w),u.message.data[v]=_}}return u}let J=class extends H.Z{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map,this._bufferIds=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._resourceManagerProxy=new $(this.remoteClient)}destroy(){this._resourceManagerProxy.destroy()}get supportsTileUpdates(){return!0}forEachBufferId(l){this._bufferIds.forEach(a=>{a.forEach(l)})}update(l,a){var u=this;return(0,x.Z)(function*(){const v=a.schema.processors[0];if("symbol"!==v.type)return;const d=(0,M.Hg)(u._schema,v);((0,M.uD)(d,"mesh")||(0,M.uD)(d,"target"))&&(l.mesh=!0,l.why?.mesh.push("Symbology changed"),u._schema=v,u._factory=u._createFactory(v),u._factory.update(v,u.tileStore.tileScheme.tileInfo))})()}onTileMessage(l,a,u,v){return(0,T.k_)(v),this._onTileData(l,a,u,v)}onTileClear(l){return this._bufferData.delete(l.key.id),this._bufferIds.delete(l.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{clear:!0}})}onTileError(l,a,u){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:l.id,error:a},{signal:u.signal})}onTileUpdate(l){for(const a of l.removed)this._bufferData.has(a.key.id)&&this._bufferData.delete(a.key.id),this._bufferIds.has(a.key.id)&&this._bufferIds.delete(a.key.id);for(const a of l.added)this._bufferData.forEach(u=>{for(const v of u)v.message.tileKey===a.id&&this._updateTileMesh("append",a,W(v),[],!1,!1,null)})}_addBufferData(l,a){this._bufferData.has(l)||this._bufferData.set(l,[]),this._bufferData.get(l)?.push(W(a))}_createFactory(l){const{geometryType:a,objectIdField:u,fields:v}=this.service,p={geometryType:a,fields:v,spatialReference:O.Z.fromJSON(this.spatialReference)},S=new Q.Wr((_,z)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",_,z),this.tileStore.tileScheme.tileInfo),{matcher:g,aggregateMatcher:w}=l.mesh;return this._store=S,this._matchers.feature=(0,k.fL)(g,S,p,this._resourceManagerProxy),this._matchers.aggregate=(0,P.yw)(w,_=>(0,k.fL)(_,S,p,this._resourceManagerProxy)),new G.j(a,u,S)}_onTileData(l,a,u,v){var d=this;return(0,x.Z)(function*(){(0,T.k_)(v);const{type:p,addOrUpdate:S,remove:g,clear:w,end:_}=a,z=!!d._schema.mesh.sortKey;if(!S)return d.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{type:p,addOrUpdate:null,remove:g,clear:w,end:_,sort:z}},v);const A=d._processFeatures(l,S,u,v,a.status?.version);try{const e=yield A;if((0,P.Wi)(e))return d.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l.id,data:{type:p,addOrUpdate:null,remove:g,clear:w,end:_,sort:z}},v);const t=[];for(const r of e){let n=!1;const s=r.message.bufferIds,i=l.key.id,o=r.message.tileKey;if(i!==o&&(0,P.pC)(s)){if(!d.tileStore.get(o)){d._addBufferData(i,r),t.push(r);continue}let y=d._bufferIds.get(o);y||(y=new Set,d._bufferIds.set(o,y));const E=Array.from(s);for(const F of E){if(y.has(F)){n=!0;break}y.add(F)}}n||(d._addBufferData(i,r),t.push(r))}yield Promise.all(t.map(r=>{const n=l.key.id===r.message.tileKey;return d._updateTileMesh(p,l,r,n?a.remove:[],n&&a.end,!!a.clear,v.signal)}))}catch(e){d._handleError(l,e,v)}})()}_updateTileMesh(l,a,u,v,d,p,S){var g=this;return(0,x.Z)(function*(){const w=l,_=u.message.tileKey,z=!!g._schema.mesh.sortKey;_!==a.key.id&&(d=!1);const A=(0,P.yw)(u,n=>n.message),e=(0,P.yw)(u,n=>n.transferList)||[],t={type:w,addOrUpdate:A,remove:v,clear:p,end:d,sort:z},r={transferList:(0,P.Wg)(e)||[],signal:S};return(0,T.k_)(r),g.remoteClient.invoke("tileRenderer.onTileData",{tileKey:_,data:t},r)})()}_processFeatures(l,a,u,v,d){var p=this;return(0,x.Z)(function*(){if((0,P.Wi)(a)||!a.hasFeatures)return null;const S={transform:l.transform,hasZ:!1,hasM:!1},g=p._factory,w={viewingMode:"",scale:l.scale},_=yield p._matchers.feature,z=yield p._matchers.aggregate;(0,T.k_)(v);const A=p._getLabelInfos(l,a);return yield g.analyze(a.getCursor(),p._resourceManagerProxy,_,z,S,w),(0,T.k_)(v),p._writeFeatureSet(l,a,S,A,g,u,d)})()}_writeFeatureSet(l,a,u,v,d,p,S){const g=a.getSize(),w=this._schema.mesh.matcher.symbologyType,_=new j._(l.key.id,{features:g,records:g,metrics:0},w,p,w!==B.mD.HEATMAP,S),z={viewingMode:"",scale:l.scale},A=a.getCursor();for(;A.next();)try{const t=A.getDisplayId(),r=(0,P.pC)(v)?v.get(t):null;d.writeCursor(_,A,u,z,l.level,r,this._resourceManagerProxy)}catch{}return _.serialize(l.tileInfoView.tileInfo.isWrappable)}_handleError(l,a,u){return(0,T.D_)(a)?Promise.resolve():this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:l.id,error:a.message},{signal:u.signal})}_getLabelingSchemaForScale(l){const a=this._schema.mesh.labels;if((0,P.Wi)(a))return null;if("subtype"===a.type){const v={type:"subtype",classes:{}};let d=!1;for(const p in a.classes){const S=a.classes[p].filter(g=>ee(g,l.scale));d=d||!!S.length,v.classes[p]=S}return d?v:null}const u=a.classes.filter(v=>ee(v,l.scale));return u.length?{type:"simple",classes:u}:null}_getLabels(l,a){if("subtype"===a.type){const v=(0,P.s3)(this.service.subtypeField,"Expected to find subtype Field"),d=l.readAttribute(v);return null==d?[]:a.classes[d]??[]}return a.classes}_getLabelInfos(l,a){const u=this._getLabelingSchemaForScale(l);if((0,P.Wi)(u))return null;const v=new Map,d=a.getCursor();for(;d.next();){const p=d.getDisplayId(),S=[],g=(0,U.nE)(p),w=g&&1!==d.readAttribute("cluster_count")?"aggregate":"feature",_=this._getLabels(d,u);for(const z of _){if(z.target!==w)continue;const e=d.getStorage().getComputedStringAtIndex(g&&"feature"===w?d.readAttribute("referenceId"):p,z.fieldIndex);if(!e)continue;const t=(0,f.E)(e.toString()),n=t[1];this._store.getMosaicItem(z.symbol,(0,q._)(t[0])).then(s=>{S[z.index]={glyphs:s.glyphMosaicItems??[],rtl:n,index:z.index}})}v.set(p,S)}return v}};J=(0,b._)([(0,L.j)("esri.views.2d.layers.features.processors.SymbolProcessor")],J);const h=J},11263:(te,K,m)=>{m.d(K,{x:()=>J,B:()=>ee});var x=m(15861),b=m(13871),f=m(39406),R=m(18716);const N={marker:f.LW.MARKER,fill:f.LW.FILL,line:f.LW.LINE,text:f.LW.TEXT};class D{constructor(l,a,u,v){const d={minScale:a?.minScale,maxScale:a?.maxScale},p=function P(h){return h.minScale||h.maxScale?h.minScale+"-"+h.maxScale:""}(d);this.layers=l,this.data=a,this.hash=this._createHash()+p,this.rendererKey=u;const S={isOutline:!1,placement:null,symbologyType:f.mD.DEFAULT,vvFlags:u};for(const g of l){const w=N[g.type];S.isOutline="line"===g.type&&g.isOutline,g.materialKey=(0,R.jj)(w,S),g.maxVVSize=v,g.scaleInfo=d,g.templateHash+=p}}get type(){return"expanded-cim"}_createHash(){let l="";for(const a of this.layers)l+=a.templateHash;return l}}var T=m(83100),V=m(26584),c=m(62208),L=m(10699),M=m(21726),O=m(84687),U=m(29840),B=m(71937);function j(h,l,a){return G.apply(this,arguments)}function G(){return(G=(0,x.Z)(function*(h,l,a){if(!h.name)throw new V.Z("style-symbol-reference-name-missing","Missing name in style symbol reference");if(h.styleName&&"Esri2DPointSymbolsStyle"===h.styleName)return Q(h,a);try{return q(yield(0,B.n2)(h,l,a),h.name,l,a)}catch(u){return(0,L.k_)(u),null}})).apply(this,arguments)}function Q(h,l){return k.apply(this,arguments)}function k(){return(k=(0,x.Z)(function*(h,l){const a=B.wm.replace(/\{SymbolName\}/gi,h.name);try{const u=yield(0,B.EJ)(a,l);return(0,B.KV)(u.data)}catch(u){return(0,L.k_)(u),null}})).apply(this,arguments)}function q(h,l,a,u){return H.apply(this,arguments)}function H(){return(H=(0,x.Z)(function*(h,l,a,u){const v=h.data,d={portal:a&&(0,c.pC)(a.portal)?a.portal:O.Z.getDefault(),url:(0,M.mN)(h.baseUrl),origin:"portal-item"},p=v.items.find(g=>g.name===l);if(!p)throw new V.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${l}' could not be found`,{symbolName:l});let S=(0,U.f)((0,B.v9)(p,"cimRef"),d);(0,T.XO)()&&(S=(0,T.pJ)(S));try{const g=yield(0,B.EJ)(S,u);return(0,B.KV)(g.data)}catch(g){return(0,L.k_)(g),null}})).apply(this,arguments)}const $=function(){var h=(0,x.Z)(function*(l,a,u){return new D(yield(0,b.c)(l.data,a,u),l.data,l.rendererKey,l.maxVVSize)});return function(a,u,v){return h.apply(this,arguments)}}();function ee(h,l,a,u){return W.apply(this,arguments)}function W(){return(W=(0,x.Z)(function*(h,l,a,u){if(!h)return null;if("cim"===h.type)return $(h,l,a);if("web-style"===h.type){const v={type:"cim",data:(yield j(h,null,u))??void 0,rendererKey:h.rendererKey,maxVVSize:h.maxVVSize};return $(v,l,a)}return h})).apply(this,arguments)}function J(h){if(!h)return null;const{avoidSDFRasterization:l,type:a,cim:u,url:v,materialHash:d}=h,p={cim:u,type:a,mosaicHash:d,url:v,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:l};switch(a){case"marker":p.size=h.size,p.path=h.path,p.animatedSymbolProperties=h.animatedSymbolProperties;break;case"line":p.dashTemplate=h.dashTemplate;break;case"text":p.text=h.text,p.fontName=h.fontName}return p}}}]);
"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[9347],{550:(Mt,G,u)=>{function y(){return[1,0,0,0,1,0,0,0,1]}function Y(B,P,N,D,M,C,T,tt,lt){return[B,P,N,D,M,C,T,tt,lt]}function U(B,P){return new Float64Array(B,P,9)}u.d(G,{a:()=>U,c:()=>y,f:()=>Y}),Object.freeze(Object.defineProperty({__proto__:null,clone:function K(B){return[B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8]]},create:y,createView:U,fromValues:Y},Symbol.toStringTag,{value:"Module"}))},36592:(Mt,G,u)=>{u.d(G,{Q:()=>g});var y=u(85931),K=u(62208),Y=u(77029),U=u(14259);class g{constructor(e=9,i){this._compareMinX=D,this._compareMinY=M,this._toBBox=s=>s,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),Z.prune(),H.prune(),w.prune(),x.prune()}all(e){this._all(this._data,e)}search(e,i){let s=this._data;const h=this._toBBox;if(F(e,s))for(Z.clear();s;){for(let c=0,m=s.children.length;c<m;c++){const _=s.children[c],I=s.leaf?h(_):_;F(e,I)&&(s.leaf?i(_):Q(e,I)?this._all(_,i):Z.push(_))}s=Z.pop()}}collides(e){let i=this._data;const s=this._toBBox;if(!F(e,i))return!1;for(Z.clear();i;){for(let h=0,c=i.children.length;h<c;h++){const m=i.children[h],_=i.leaf?s(m):m;if(F(e,_)){if(i.leaf||Q(e,_))return!0;Z.push(m)}}i=Z.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let s=0,h=e.length;s<h;s++)this.insert(e[s]);return this}let i=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const s=this._data;this._data=i,i=s}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new d([]),this}remove(e){if(!e)return this;let i,s=this._data,h=null,c=0,m=!1;const _=this._toBBox(e);for(w.clear(),x.clear();s||w.length>0;){if(s||(s=(0,K.j0)(w.pop()),h=w.data[w.length-1],c=x.pop()??0,m=!0),s.leaf&&(i=(0,y.cq)(s.children,e,s.children.length,s.indexHint),-1!==i))return s.children.splice(i,1),w.push(s),this._condense(w),this;m||s.leaf||!Q(s,_)?h?(c++,s=h.children[c],m=!1):s=null:(w.push(s),x.push(c),c=0,h=s,s=s.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,i){let s=e;for(H.clear();s;){if(!0===s.leaf)for(const h of s.children)i(h);else H.pushArray(s.children);s=H.pop()??null}}_build(e,i,s,h){const c=s-i+1;let m=this._maxEntries;if(c<=m){const L=new d(e.slice(i,s+1));return B(L,this._toBBox),L}h||(h=Math.ceil(Math.log(c)/Math.log(m)),m=Math.ceil(c/m**(h-1)));const _=new v([]);_.height=h;const I=Math.ceil(c/m),S=I*Math.ceil(Math.sqrt(m));et(e,i,s,S,this._compareMinX);for(let L=i;L<=s;L+=S){const X=Math.min(L+S-1,s);et(e,L,X,I,this._compareMinY);for(let b=L;b<=X;b+=I){const $=Math.min(b+I-1,X);_.children.push(this._build(e,b,$,h-1))}}return B(_,this._toBBox),_}_chooseSubtree(e,i,s,h){for(;h.push(i),!0!==i.leaf&&h.length-1!==s;){let c,m=1/0,_=1/0;for(let I=0,S=i.children.length;I<S;I++){const L=i.children[I],X=C(L),b=tt(e,L)-X;b<_?(_=b,m=X<m?X:m,c=L):b===_&&X<m&&(m=X,c=L)}i=c||i.children[0]}return i}_insert(e,i,s){const c=s?e:(0,this._toBBox)(e);w.clear();const m=this._chooseSubtree(c,this._data,i,w);for(m.children.push(e),N(m,c);i>=0&&w.data[i].children.length>this._maxEntries;)this._split(w,i),i--;this._adjustParentBBoxes(c,w,i)}_split(e,i){const s=e.data[i],h=s.children.length,c=this._minEntries;this._chooseSplitAxis(s,c,h);const m=this._chooseSplitIndex(s,c,h);if(!m)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const _=s.children.splice(m,s.children.length-m),I=s.leaf?new d(_):new v(_);I.height=s.height,B(s,this._toBBox),B(I,this._toBBox),i?e.data[i-1].children.push(I):this._splitRoot(s,I)}_splitRoot(e,i){this._data=new v([e,i]),this._data.height=e.height+1,B(this._data,this._toBBox)}_chooseSplitIndex(e,i,s){let h,c,m;h=c=1/0;for(let _=i;_<=s-i;_++){const I=P(e,0,_,this._toBBox),S=P(e,_,s,this._toBBox),L=lt(I,S),X=C(I)+C(S);L<h?(h=L,m=_,c=X<c?X:c):L===h&&X<c&&(c=X,m=_)}return m}_chooseSplitAxis(e,i,s){const h=e.leaf?this._compareMinX:D,c=e.leaf?this._compareMinY:M;this._allDistMargin(e,i,s,h)<this._allDistMargin(e,i,s,c)&&e.children.sort(h)}_allDistMargin(e,i,s,h){e.children.sort(h);const c=this._toBBox,m=P(e,0,i,c),_=P(e,s-i,s,c);let I=T(m)+T(_);for(let S=i;S<s-i;S++){const L=e.children[S];N(m,e.leaf?c(L):L),I+=T(m)}for(let S=s-i-1;S>=i;S--){const L=e.children[S];N(_,e.leaf?c(L):L),I+=T(_)}return I}_adjustParentBBoxes(e,i,s){for(let h=s;h>=0;h--)N(i.data[h],e)}_condense(e){for(let i=e.length-1;i>=0;i--){const s=e.data[i];if(0===s.children.length)if(i>0){const h=e.data[i-1],c=h.children;c.splice((0,y.cq)(c,s,c.length,h.indexHint),1)}else this.clear();else B(s,this._toBBox)}}_initFormat(e){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(e[0])),this._compareMinY=new Function("a","b",i.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function B(r,e){P(r,0,r.children.length,e,r)}function P(r,e,i,s,h){h||(h=new d([])),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(let c,m=e;m<i;m++)c=r.children[m],N(h,r.leaf?s(c):c);return h}function N(r,e){r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY)}function D(r,e){return r.minX-e.minX}function M(r,e){return r.minY-e.minY}function C(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function T(r){return r.maxX-r.minX+(r.maxY-r.minY)}function tt(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function lt(r,e){const i=Math.max(r.minX,e.minX),s=Math.max(r.minY,e.minY),h=Math.min(r.maxX,e.maxX),c=Math.min(r.maxY,e.maxY);return Math.max(0,h-i)*Math.max(0,c-s)}function Q(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function F(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function et(r,e,i,s,h){const c=[e,i];for(;c.length;){const m=(0,K.j0)(c.pop()),_=(0,K.j0)(c.pop());if(m-_<=s)continue;const I=_+Math.ceil((m-_)/s/2)*s;(0,U.q)(r,I,_,m,h),c.push(_,I,I,m)}}const Z=new Y.Z,H=new Y.Z,w=new Y.Z,x=new Y.Z({deallocator:void 0});class a{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class f extends a{constructor(){super(...arguments),this.height=1,this.indexHint=new y.SO}}class d extends f{constructor(e){super(),this.children=e,this.leaf=!0}}class v extends f{constructor(e){super(),this.children=e,this.leaf=!1}}},65629:(Mt,G,u)=>{u.d(G,{SR:()=>D,Ui:()=>N});var y=u(62208),K=u(65401),Y=u(32442),U=u(25748),g=u(91179),B=u(74618),P=u(37053);function N(x){return M(x,!0)}function D(x){return M(x,!1)}function M(x,a){if((0,y.Wi)(x))return null;const f=x.spatialReference,d=(0,P.C5)(f),v="toJSON"in x?x.toJSON():x;if(!d)return v;const r=(0,P.sS)(f)?102100:4326,e=B.UZ[r].maxX,i=B.UZ[r].minX;if((0,g.wp)(v))return T(v,e,i);if((0,g.aW)(v))return v.points=v.points.map(s=>T(s,e,i)),v;if((0,g.YX)(v))return function C(x,a){if(!a)return x;const f=function tt(x,a){const f=[],{ymin:d,ymax:v,xmin:r,xmax:e}=x,i=x.xmax-x.xmin,[s,h]=a.valid,{x:c,frameId:m}=lt(x.xmin,a),{x:_,frameId:I}=lt(x.xmax,a),S=c===_&&i>0;if(i>2*h){const L={xmin:r<e?c:_,ymin:d,xmax:h,ymax:v},X={xmin:s,ymin:d,xmax:r<e?_:c,ymax:v},b={xmin:0,ymin:d,xmax:h,ymax:v},$={xmin:s,ymin:d,xmax:0,ymax:v},ht=[],W=[];Q(L,b)&&ht.push(m),Q(L,$)&&W.push(m),Q(X,b)&&ht.push(I),Q(X,$)&&W.push(I);for(let k=m+1;k<I;k++)ht.push(k),W.push(k);f.push(new Z(L,[m]),new Z(X,[I]),new Z(b,ht),new Z($,W))}else c>_||S?f.push(new Z({xmin:c,ymin:d,xmax:h,ymax:v},[m]),new Z({xmin:s,ymin:d,xmax:_,ymax:v},[I])):f.push(new Z({xmin:c,ymin:d,xmax:_,ymax:v},[m]));return f}(x,a).map(d=>d.extent);return f.length<2?f[0]||x:f.length>2?(x.xmin=a.valid[0],x.xmax=a.valid[1],x):{rings:f.map(d=>[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]])}}(v,d);if((0,g.oU)(v)||(0,g.l9)(v)){const s=(0,Y.$P)(H,v),h={xmin:s[0],ymin:s[1],xmax:s[2],ymax:s[3]},c=(0,B.XZ)(h.xmin,i)*(2*e),m=0===c?v:(0,B.Sy)(v,c);return h.xmin+=c,h.xmax+=c,h.xmax>e?et(m,e,a):h.xmin<i?et(m,i,a):m}return v}function T(x,a,f){if(Array.isArray(x)){const d=x[0];if(d>a){const v=(0,B.XZ)(d,a);x[0]=d+v*(-2*a)}else if(d<f){const v=(0,B.XZ)(d,f);x[0]=d+v*(-2*f)}}else{const d=x.x;if(d>a){const v=(0,B.XZ)(d,a);x.x+=v*(-2*a)}else if(d<f){const v=(0,B.XZ)(d,f);x.x+=v*(-2*f)}}return x}function lt(x,a){const[f,d]=a.valid,v=2*d;let r,e=0;return x>d?(r=Math.ceil(Math.abs(x-d)/v),x-=r*v,e=r):x<f&&(r=Math.ceil(Math.abs(x-f)/v),x+=r*v,e=-r),{x,frameId:e}}function Q(x,a){const{xmin:f,ymin:d,xmax:v,ymax:r}=a;return F(x,f,d)&&F(x,f,r)&&F(x,v,r)&&F(x,v,d)}function F(x,a,f){return a>=x.xmin&&a<=x.xmax&&f>=x.ymin&&f<=x.ymax}function et(x,a,f=!0){const d=!(0,g.l9)(x);if(d&&(0,U.Zy)(x),f)return(new w).cut(x,a);const v=d?x.rings:x.paths,r=d?4:2,e=v.length,i=-2*a;for(let s=0;s<e;s++){const h=v[s];if(h&&h.length>=r){const c=[];for(const m of h)c.push([m[0]+i,m[1]]);v.push(c)}}return d?x.rings=v:x.paths=v,x}class Z{constructor(a,f){this.extent=a,this.frameIds=f}}const H=(0,K.Ue)();class w{constructor(){this._linesIn=[],this._linesOut=[]}cut(a,f){let d;if(this._xCut=f,a.rings)this._closed=!0,d=a.rings,this._minPts=4;else{if(!a.paths)return null;this._closed=!1,d=a.paths,this._minPts=2}for(const r of d){if(!r||r.length<this._minPts)continue;let e=!0;for(const i of r)e?(this.moveTo(i),e=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),d=[];for(const r of this._linesIn)r&&r.length>=this._minPts&&d.push(r);const v=-2*this._xCut;for(const r of this._linesOut)if(r&&r.length>=this._minPts){for(const e of r)e[0]+=v;d.push(r)}return this._closed?a.rings=d:a.paths=d,a}moveTo(a){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(a[0]),this._moveTo(a[0],a[1],this._prevSide),this._prevPt=a,this._firstPt=a}lineTo(a){const f=this._side(a[0]);if(f*this._prevSide==-1){const d=this._intersect(this._prevPt,a);this._lineTo(this._xCut,d,0),this._prevSide=0,this._lineTo(a[0],a[1],f)}else this._lineTo(a[0],a[1],f);this._prevSide=f,this._prevPt=a}close(){const a=this._firstPt,f=this._prevPt;a[0]===f[0]&&a[1]===f[1]||this.lineTo(a),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(a,f,d){this._closed?(this._lineIn.push([d<=0?a:this._xCut,f]),this._lineOut.push([d>=0?a:this._xCut,f])):(d<=0&&this._lineIn.push([a,f]),d>=0&&this._lineOut.push([a,f]))}_lineTo(a,f,d){this._closed?(this._addPolyVertex(this._lineIn,d<=0?a:this._xCut,f),this._addPolyVertex(this._lineOut,d>=0?a:this._xCut,f)):d<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([a,f])):d>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([a,f])):this._prevSide<0?(this._lineIn.push([a,f]),this._lineOut.push([a,f])):this._prevSide>0&&(this._lineOut.push([a,f]),this._lineIn.push([a,f]))}_addPolyVertex(a,f,d){const v=a.length;v>1&&a[v-1][0]===f&&a[v-2][0]===f?a[v-1][1]=d:a.push([f,d])}_checkClosingPt(a){const f=a.length;f>3&&a[0][0]===this._xCut&&a[f-2][0]===this._xCut&&a[1][0]===this._xCut&&(a[0][1]=a[f-2][1],a.pop())}_side(a){return a<this._xCut?-1:a>this._xCut?1:0}_intersect(a,f){return a[1]+(this._xCut-a[0])/(f[0]-a[0])*(f[1]-a[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}},24762:(Mt,G,u)=>{u.r(G),u.d(G,{default:()=>le});var y=u(17626),K=u(74333),Y=u(26584),U=u(63290),g=u(62208),B=u(99959),P=u(77712),N=u(66656),M=(u(85931),u(68653)),C=u(76898),T=u(99433),tt=u(44917),lt=u(552),Q=u(49286),F=u(99555),et=u(15861),Z=u(84792),H=u(21726),w=u(35948),a=(u(90912),u(61996)),f=u(86810),d=u(47996),v=u(14517),r=u(88070),e=u(23841),i=u(30217),s=u(550),h=u(67831),c=u(99770),m=u(72642),_=u(37118),I=u(55915),S=u(65234),L=u(79608);u(8314);let b=class extends L.j{projectOrWarn(t,n){if((0,g.Wi)(t))return t;const{geometry:o,pending:l}=(0,I.dz)(t,n);return l?null:l||o?o:(U.Z.getLogger(this.declaredClass).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:t,sourceSpatialReference:t.spatialReference,targetSpatialReference:n}),null)}};b=(0,y._)([(0,C.j)("esri.layers.support.GeoreferenceBase")],b);const $=b,ht=(0,s.c)(),W=(0,c.a)();let k=class extends v.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,y._)([(0,P.Cb)()],k.prototype,"sourcePoint",void 0),(0,y._)([(0,P.Cb)({type:m.Z})],k.prototype,"mapPoint",void 0),k=(0,y._)([(0,C.j)("esri.layers.support.ControlPoint")],k);let J=class extends((0,f.eC)($)){constructor(t){super(t),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(t,n){const o=S.Z.fromJSON(n.spatialReference),l=(0,s.f)(...n.coefficients,1);return t.map(p=>((0,h.s)(W,p.x,p.y),(0,r.H)(W,W,l),{sourcePoint:p,mapPoint:new m.Z({x:W[0],y:W[1],spatialReference:o})}))}writeControlPoints(t,n,o,l){if((0,g.Wi)(this.transform)){const p=new Y.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:l?.layer,georeference:this});l?.messages?l.messages.push(p):U.Z.getLogger(this.declaredClass).error(p.name,p.message)}else(0,g.pC)(t)&&A(t[0])&&(n.controlPoints=t.map(p=>{const R=(0,g.Wg)(p.sourcePoint);return{x:R.x,y:R.y}}),n.spatialReference=t[0].mapPoint.spatialReference.toJSON(),n.coefficients=this.transform.slice(0,8))}get coords(){if((0,g.Wi)(this.controlPoints))return null;const t=this._updateTransform(ht);return(0,g.Wi)(t)||!A(this.controlPoints[0])?null:function Ht(t,n,o,l){const p=(0,c.f)(0,o),R=(0,c.f)(0,0),O=(0,c.f)(n,0),E=(0,c.f)(n,o);return(0,r.H)(p,p,t),(0,r.H)(R,R,t),(0,r.H)(O,O,t),(0,r.H)(E,E,t),new _.Z({rings:[[p,R,O,E,p]],spatialReference:l})}(t,this.width,this.height,this.controlPoints[0].mapPoint.spatialReference)}set coords(t){if((0,g.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return;const n=this.controlPoints[0].mapPoint.spatialReference;if(t=this.projectOrWarn(t,n),(0,g.Wi)(t))return;const{width:o,height:l}=this,{rings:[[p,R,O,E]]}=t,j={sourcePoint:(0,e.vW)(0,l),mapPoint:new m.Z({x:p[0],y:p[1],spatialReference:n})},z={sourcePoint:(0,e.vW)(0,0),mapPoint:new m.Z({x:R[0],y:R[1],spatialReference:n})},q={sourcePoint:(0,e.vW)(o,0),mapPoint:new m.Z({x:O[0],y:O[1],spatialReference:n})},pt={sourcePoint:(0,e.vW)(o,l),mapPoint:new m.Z({x:E[0],y:E[1],spatialReference:n})};A(j)&&A(z)&&A(q)&&A(pt)&&(Lt(ht,j,z,q,pt),this.controlPoints=(0,g.Wg)(this.controlPoints).map(({sourcePoint:at})=>((0,h.s)(W,at.x,at.y),(0,r.H)(W,W,ht),{sourcePoint:at,mapPoint:new m.Z({x:W[0],y:W[1],spatialReference:n})})))}get inverseTransform(){return(0,g.Wi)(this.transform)?null:(0,i.e)((0,s.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(t){if((0,g.Wi)(t)||(0,g.Wi)(this.transform)||(0,g.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return null;(0,h.s)(W,t.x,t.y);const n=this.controlPoints[0].mapPoint.spatialReference;return(0,r.H)(W,W,this.transform),new m.Z({x:W[0],y:W[1],spatialReference:n})}toSource(t){if((0,g.Wi)(t)||(0,g.Wi)(this.inverseTransform)||(0,g.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return null;const n=this.controlPoints[0].mapPoint.spatialReference;return t=t.normalize(),t=(0,I.dz)(t,n).geometry,(0,g.Wi)(t)?null:((0,h.s)(W,t.x,t.y),(0,r.H)(W,W,this.inverseTransform),(0,e.vW)(W[0],W[1]))}_updateTransform(t){const{controlPoints:n,width:o,height:l}=this;if((0,g.Wi)(n)||!(o>0)||!(l>0))return null;const[p,R,O,E]=n;if(!A(p))return null;const j=p.mapPoint.spatialReference,z=this._projectControlPoint(R,j),q=this._projectControlPoint(O,j),pt=this._projectControlPoint(E,j);if(!(z.valid&&q.valid&&pt.valid&&A(z.controlPoint)))return null;(0,g.Wi)(t)&&(t=(0,s.c)());let at=null;return at=A(q.controlPoint)&&A(pt.controlPoint)?Lt(t,p,z.controlPoint,q.controlPoint,pt.controlPoint):A(q.controlPoint)?function Ut(t,n,o,l){return rt(nt,it,n),rt(st,ot,o),rt(ft,xt,l),(0,h.l)(ct,nt,st,.5),(0,h.r)(ct,ft,ct,Math.PI),(0,h.l)(dt,it,ot,.5),(0,h.r)(dt,xt,dt,Math.PI),Ct(t,nt,st,ft,ct,it,ot,xt,dt)}(t,p,z.controlPoint,q.controlPoint):function bt(t,n,o){return rt(nt,it,n),rt(st,ot,o),(0,h.r)(ft,st,nt,Rt),(0,h.r)(ct,nt,st,Rt),(0,h.r)(xt,ot,it,-Rt),(0,h.r)(dt,it,ot,-Rt),Ct(t,nt,st,ft,ct,it,ot,xt,dt)}(t,p,z.controlPoint),at.every(he=>0===he)?null:at}_projectControlPoint(t,n){if(!A(t))return{valid:!0,controlPoint:t};const{sourcePoint:o,mapPoint:l}=t,{geometry:p,pending:R}=(0,I.dz)(l,n);return R?{valid:!1,controlPoint:null}:R||p?{valid:!0,controlPoint:{sourcePoint:o,mapPoint:p}}:(U.Z.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:t,sourceSpatialReference:l.spatialReference,targetSpatialReference:n}),{valid:!1,controlPoint:null})}};function A(t){return(0,g.pC)(t)&&(0,g.pC)(t.sourcePoint)&&(0,g.pC)(t.mapPoint)}(0,y._)([(0,P.Cb)({type:[k],json:{write:{allowNull:!1,isRequired:!0}}})],J.prototype,"controlPoints",void 0),(0,y._)([(0,M.r)("controlPoints")],J.prototype,"readControlPoints",null),(0,y._)([(0,T.c)("controlPoints")],J.prototype,"writeControlPoints",null),(0,y._)([(0,P.Cb)()],J.prototype,"coords",null),(0,y._)([(0,P.Cb)({json:{write:!0}})],J.prototype,"height",void 0),(0,y._)([(0,P.Cb)({readOnly:!0})],J.prototype,"inverseTransform",null),(0,y._)([(0,P.Cb)({readOnly:!0})],J.prototype,"transform",null),(0,y._)([(0,P.Cb)({json:{write:!0}})],J.prototype,"width",void 0),J=(0,y._)([(0,C.j)("esri.layers.support.ControlPointsGeoreference")],J);const nt=(0,c.a)(),st=(0,c.a)(),ft=(0,c.a)(),ct=(0,c.a)(),it=(0,c.a)(),ot=(0,c.a)(),xt=(0,c.a)(),dt=(0,c.a)(),Rt=Math.PI/2;function rt(t,n,o){(0,h.s)(t,o.sourcePoint.x,o.sourcePoint.y),(0,h.s)(n,o.mapPoint.x,o.mapPoint.y)}function Lt(t,n,o,l,p){return rt(nt,it,n),rt(st,ot,o),rt(ft,xt,l),rt(ct,dt,p),Ct(t,nt,st,ft,ct,it,ot,xt,dt)}const Dt=new Array(8).fill(0),At=new Array(8).fill(0);function Wt(t,n,o,l,p){return t[0]=n[0],t[1]=n[1],t[2]=o[0],t[3]=o[1],t[4]=l[0],t[5]=l[1],t[6]=p[0],t[7]=p[1],t}function Ct(t,n,o,l,p,R,O,E,j){return(0,r.E)(t,Wt(Dt,n,o,l,p),Wt(At,R,O,E,j))}const St=J;let ut=class extends ${constructor(t){super(t),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:l}=this;if((0,g.Wi)(t)||(0,g.Wi)(n)||(0,g.Wi)(o)||(0,g.Wi)(l))return null;const p=t.spatialReference;return n=this.projectOrWarn(n,p),o=this.projectOrWarn(o,p),l=this.projectOrWarn(l,p),(0,g.Wi)(n)||(0,g.Wi)(o)||(0,g.Wi)(l)?null:new _.Z({rings:[[[o.x,o.y],[t.x,t.y],[n.x,n.y],[l.x,l.y],[o.x,o.y]]],spatialReference:p})}set coords(t){const{topLeft:n}=this;if((0,g.Wi)(n))return;const o=n.spatialReference;if(t=this.projectOrWarn(t,o),(0,g.Wi)(t))return;const{rings:[[l,p,R,O]]}=t;this.bottomLeft=new m.Z({x:l[0],y:l[1],spatialReference:o}),this.topLeft=new m.Z({x:p[0],y:p[1],spatialReference:o}),this.topRight=new m.Z({x:R[0],y:R[1],spatialReference:o}),this.bottomRight=new m.Z({x:O[0],y:O[1],spatialReference:o})}};(0,y._)([(0,P.Cb)()],ut.prototype,"coords",null),(0,y._)([(0,P.Cb)({type:m.Z})],ut.prototype,"bottomLeft",void 0),(0,y._)([(0,P.Cb)({type:m.Z})],ut.prototype,"bottomRight",void 0),(0,y._)([(0,P.Cb)({type:m.Z})],ut.prototype,"topLeft",void 0),(0,y._)([(0,P.Cb)({type:m.Z})],ut.prototype,"topRight",void 0),ut=(0,y._)([(0,C.j)("esri.layers.support.CornersGeoreference")],ut);const Vt=ut;var Kt=u(21286),Nt=u(39863),It=u(2004);let yt=class extends ${constructor(t){super(t),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if((0,g.Wi)(this.extent))return null;const{xmin:t,ymin:n,xmax:o,ymax:l,spatialReference:p}=this.extent;let R;if(this.rotation){const{x:O,y:E}=this.extent.center,j=jt(O,E,this.rotation);R=[j(t,n),j(t,l),j(o,l),j(o,n)],R.push(R[0])}else R=[[t,n],[t,l],[o,l],[o,n],[t,n]];return new _.Z({rings:[R],spatialReference:p})}set coords(t){if((0,g.Wi)(t)||(0,g.Wi)(this.extent))return;const n=this.extent.spatialReference;if(t=this.projectOrWarn(t,n),(0,g.Wi)(t)||(0,g.Wi)(t.extent))return;const{rings:[[o,l,p]],extent:{center:{x:R,y:O}}}=t,E=(0,Kt.BV)(Math.PI/2-Math.atan2(l[1]-o[1],l[0]-o[0])),j=jt(R,O,-E),[z,q]=j(o[0],o[1]),[pt,at]=j(p[0],p[1]);this.extent=new It.Z({xmin:z,ymin:q,xmax:pt,ymax:at,spatialReference:n}),this.rotation=E}};function jt(t,n,o){const l=(0,Nt.t)(o),p=Math.cos(l),R=Math.sin(l);return(O,E)=>[p*(O-t)+R*(E-n)+t,p*(E-n)-R*(O-t)+n]}(0,y._)([(0,P.Cb)()],yt.prototype,"coords",null),(0,y._)([(0,P.Cb)({type:It.Z})],yt.prototype,"extent",void 0),(0,y._)([(0,P.Cb)({type:Number})],yt.prototype,"rotation",void 0),yt=(0,y._)([(0,C.j)("esri.layers.support.ExtentAndRotationGeoreference")],yt);const zt={key:"type",base:$,typeMap:{"control-points":St,corners:Vt,"extent-and-rotation":yt}};let gt=class extends((0,a.iv)((0,f.eC)(d.Z))){constructor(){super(...arguments),this.georeference=null,this.opacity=1}readGeoreference(t){return St.fromJSON(t)}};(0,y._)([(0,P.Cb)({types:zt,json:{write:!0}})],gt.prototype,"georeference",void 0),(0,y._)([(0,M.r)("georeference")],gt.prototype,"readGeoreference",null),(0,y._)([(0,P.Cb)()],gt.prototype,"opacity",void 0),gt=(0,y._)([(0,C.j)("esri.layers.support.MediaElementBase")],gt);const Bt=gt;var Ft=u(61556),_t=u(29840);let mt=class extends Bt{constructor(t){super(t),this.content=null,this.image=null,this.type="image",this.image=null}load(){const t=this.image;if("string"==typeof t){const n=(0,Z.default)(t,{responseType:"image"}).then(({data:o})=>{this._set("content",o)});this.addResolvingPromise(n)}else if(t instanceof HTMLImageElement){const n=t.decode().then(()=>{this._set("content",t)});this.addResolvingPromise(n)}else t?this._set("content",t):this.addResolvingPromise(Promise.reject(new Y.Z("image-element:invalid-image-type","Invalid image type",{image:t})));return Promise.resolve(this)}readImage(t,n,o){return(0,_t.f)(n.url,o)}writeImage(t,n,o,l){if((0,g.Wi)(t))return;const p=l?.portalItem,R=l?.resources;if(!p||!R)return void("string"==typeof t&&(n[o]=(0,_t.t)(t,l)));const O="string"!=typeof t||(0,H.HK)(t)||(0,H.jc)(t)?null:t;if(O){if(null==(0,_t.i)(O))return void(n[o]=O);const E=(0,_t.t)(O,{...l,verifyItemRelativeUrls:l&&l.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},_t.M.NO);if(p&&E&&!(0,H.YP)(E))return R.toKeep.push({resource:p.resourceFromPath(E),compress:!1}),void(n[o]=E)}n[o]="<pending>",R.pendingOperations.push(Zt(t).then(E=>{const j=function Gt(t,n){const o=(0,w.D)(),l=`${(0,H.v_)("media",o)}.${(0,Ft.B)(t)}`;return n.resourceFromPath(l)}(E,p);n[o]=j.itemRelativeUrl,R.toAdd.push({resource:j,content:E,compress:!1,finish:z=>{this.image=z.url}})}))}};(0,y._)([(0,P.Cb)({readOnly:!0})],mt.prototype,"content",void 0),(0,y._)([(0,P.Cb)({json:{name:"url",type:String}})],mt.prototype,"image",void 0),(0,y._)([(0,M.r)("image",["url"])],mt.prototype,"readImage",null),(0,y._)([(0,T.c)("image")],mt.prototype,"writeImage",null),(0,y._)([(0,P.Cb)({readOnly:!0,json:{name:"mediaType"}})],mt.prototype,"type",void 0),mt=(0,y._)([(0,C.j)("esri.layers.support.ImageElement")],mt);const Tt=mt;function Zt(t){return Et.apply(this,arguments)}function Et(){return(Et=(0,et.Z)(function*(t){if("string"==typeof t){if((0,H.jc)(t)){const{data:n}=yield(0,Z.default)(t,{responseType:"blob"});return n}return(0,H.HK)(t)?(0,H.fw)(t):Zt((yield(0,Z.default)(t,{responseType:"image"})).data)}return new Promise(n=>Jt(t).toBlob(n))})).apply(this,arguments)}function Jt(t){if(t instanceof HTMLCanvasElement)return t;const n=t instanceof HTMLImageElement?t.naturalWidth:t.width,o=t instanceof HTMLImageElement?t.naturalHeight:t.height,l=document.createElement("canvas"),p=l.getContext("2d");return l.width=n,l.height=o,t instanceof HTMLImageElement?p.drawImage(t,0,0,t.width,t.height):t instanceof ImageData&&p.putImageData(t,0,0),l}u(29132);var Qt=u(89726),$t=u(61885),kt=u(80542),qt=u(60330),te=u(10699),ee=u(32917),ne=u(65401),se=u(11519),ie=u(37053),oe=u(61256),re=u(17732);let Pt=class extends Bt{constructor(t){super(t),this.content=null,this.type="video"}load(){const t=this.video;if("string"==typeof t){const n=document.createElement("video");n.src=t,n.crossOrigin="anonymous",n.autoplay=!0,n.muted=!0,n.loop=!0,this.addResolvingPromise(this._loadVideo(n).then(()=>{this._set("content",n)}))}else t instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)})):this.addResolvingPromise(Promise.reject(new Y.Z("video-element:invalid-video-type","Invalid video type",{video:t})));return Promise.resolve(this)}set video(t){"not-loaded"===this.loadStatus?this._set("video",t):U.Z.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(t){return new Promise((n,o)=>{t.oncanplay=()=>{t.oncanplay=null,t.play().then(n,o)},"anonymous"!==t.crossOrigin&&(t.crossOrigin="anonymous",t.src=t.src)})}};(0,y._)([(0,P.Cb)({readOnly:!0})],Pt.prototype,"content",void 0),(0,y._)([(0,P.Cb)()],Pt.prototype,"video",null),Pt=(0,y._)([(0,C.j)("esri.layers.support.VideoElement")],Pt);const Xt=Pt,wt=K.Z.ofType({key:"type",defaultKeyValue:"image",base:Bt,typeMap:{image:Tt,video:Xt}});let vt=class extends(d.Z.LoadableMixin((0,qt.v)((0,kt.p)($t.Z.EventedAccessor)))){constructor(t){super(t),this._index=new oe.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=n=>{for(const l of n.removed){const p=this._elementViewsMap.get(l);this._elementViewsMap.delete(l),this._index.delete(p),this.handles.remove(p),p.destroy(),this.notifyChange("fullExtent")}const{spatialReference:o}=this;for(const l of n.added){if(this._elementViewsMap.get(l))continue;const p=new re.L({spatialReference:o,element:l});this._elementViewsMap.set(l,p);const R=(0,ee.YP)(()=>p.coords,()=>this._updateIndexForElement(p,!1));this._updateIndexForElement(p,!0),this.handles.add(R,p)}this._elementsIndexes.clear(),this.elements.forEach((l,p)=>this._elementsIndexes.set(l,p)),this.emit("refresh")},this.elements=new wt}load(t){var n=this;return(0,et.Z)(function*(){if((0,te.k_)(t),!n.spatialReference){const o=n.elements.find(l=>(0,g.pC)(l.georeference)&&(0,g.pC)(l.georeference.coords));n._set("spatialReference",o?(0,g.Wg)((0,g.Wg)(o.georeference).coords).spatialReference:S.Z.WGS84)}return n._elementsChangedHandler({added:n.elements.items,removed:[]}),n.handles.add(n.elements.on("change",n._elementsChangedHandler)),n})()}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(t){this._set("elements",(0,Qt.Z)(t,this._get("elements"),wt))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const t=this._index.fullBounds;return(0,g.Wi)(t)?null:new It.Z({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:this.spatialReference})}set spatialReference(t){"not-loaded"===this.loadStatus?this._set("spatialReference",t):U.Z.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}queryElements(t,n){var o=this;return(0,et.Z)(function*(){yield o.load(),yield(0,I.iQ)(t.spatialReference,o.spatialReference,null,n);const l=(0,ie.fS)(t.spatialReference,o.spatialReference)?t:(0,I.iV)(t,o.spatialReference);if(!l)return[];const p=l.normalize(),R=[];for(const O of p)o._index.forEachInBounds((0,ne.oJ)(O),({normalizedCoords:E,element:j})=>{(0,g.pC)(E)&&(0,se.Nl)(O,E)&&R.push(j)});return R.sort((O,E)=>o._elementsIndexes.get(O)-o._elementsIndexes.get(E)),R})()}_updateIndexForElement(t,n){const o=t.normalizedBounds,l=this._index.has(t),p=(0,g.pC)(o);this._index.delete(t),p&&this._index.set(t,o),this.notifyChange("fullExtent"),n||(l!==p?this.emit("refresh"):this.emit("change",{element:t.element}))}};(0,y._)([(0,P.Cb)()],vt.prototype,"elements",null),(0,y._)([(0,P.Cb)({readOnly:!0})],vt.prototype,"fullExtent",null),(0,y._)([(0,P.Cb)()],vt.prototype,"spatialReference",null),vt=(0,y._)([(0,C.j)("esri.layers.support.LocalMediaElementSource")],vt);const Ot=vt;function Yt(t){return"object"==typeof t&&null!=t&&"type"in t}let V=class extends((0,lt.h)((0,F.M)((0,Q.q)((0,B.R)(tt.Z))))){constructor(t){super(t),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Ot}load(t){const n=this.source;if(!n)return this.addResolvingPromise(Promise.reject(new Y.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const o=Yt(n)?new Ot({elements:new K.Z([n])}):n;this._set("effectiveSource",o),this.spatialReference&&(o.spatialReference=this.spatialReference);const l=o.load(t).then(()=>{this.spatialReference=o.spatialReference});return this.addResolvingPromise(l),Promise.resolve(this)}destroy(){(0,g.Wg)(this.effectiveSource)?.destroy(),(0,g.Wg)(this.source)?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(t){"not-loaded"===this.loadStatus?this._set("source",t):U.Z.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(t){return t?Array.isArray(t)||t instanceof K.Z?new Ot({elements:t}):t:null}readSource(t,n,o){const l="image"===n.mediaType?new Tt:"video"===n.mediaType?new Xt:null;return l?.read(n,o),l}writeSource(t,n,o,l){t&&Yt(t)&&"image"===t.type?t.write(n,l):l?.messages&&l?.messages?.push(new Y.Z("media-layer:unsupported-source","source must be an 'ImageElement'"))}};(0,y._)([(0,P.Cb)({readOnly:!0})],V.prototype,"effectiveSource",void 0),(0,y._)([(0,P.Cb)({type:String})],V.prototype,"copyright",void 0),(0,y._)([(0,P.Cb)({readOnly:!0})],V.prototype,"fullExtent",null),(0,y._)([(0,P.Cb)({type:["MediaLayer"]})],V.prototype,"operationalLayerType",void 0),(0,y._)([(0,P.Cb)({type:["show","hide"]})],V.prototype,"listMode",void 0),(0,y._)([(0,P.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],V.prototype,"source",null),(0,y._)([(0,N.p)("source")],V.prototype,"castSource",null),(0,y._)([(0,M.r)("source",["url"])],V.prototype,"readSource",null),(0,y._)([(0,T.c)("source")],V.prototype,"writeSource",null),(0,y._)([(0,P.Cb)()],V.prototype,"spatialReference",void 0),(0,y._)([(0,P.Cb)({readOnly:!0})],V.prototype,"type",void 0),V=(0,y._)([(0,C.j)("esri.layers.MediaLayer")],V);const le=V},61256:(Mt,G,u)=>{u.d(G,{H:()=>N});var y=u(8314),K=u(36592),Y=u(65401);const g={minX:0,minY:0,maxX:0,maxY:0};class N{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new K.Q(9,(0,y.Z)("esri-csp-restrictions")?M=>({minX:M[0],minY:M[1],maxX:M[2],maxY:M[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const M=new Array(this._idByBounds.size);let C=0;this._idByBounds.forEach((T,tt)=>{M[C++]=tt}),this._indexInvalid=!1,this._index.clear(),this._index.load(M)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(M=>this._idByBounds.has(M))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const M=(0,Y.cS)();for(const C of this._boundsById.values())C&&(M[0]=Math.min(C[0],M[0]),M[1]=Math.min(C[1],M[1]),M[2]=Math.max(C[2],M[2]),M[3]=Math.max(C[3],M[3]));return M}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(M){const C=this._boundsById.get(M);this._boundsById.delete(M),C&&(this._idByBounds.delete(C),this._indexInvalid||this._index.remove(C))}forEachInBounds(M,C){this._loadIndex(),function P(D,M,C){(function B(D){g.minX=D[0],g.minY=D[1],g.maxX=D[2],g.maxY=D[3]})(M),D.search(g,C)}(this._index,M,T=>C(this._idByBounds.get(T)))}get(M){return this._boundsById.get(M)}has(M){return this._boundsById.has(M)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(M,C){if(!this._indexInvalid){const T=this._boundsById.get(M);T&&(this._index.remove(T),this._idByBounds.delete(T))}this._boundsById.set(M,C),C&&(this._idByBounds.set(C,M),this._indexInvalid||(this._boundsToLoad.push(C),this._boundsToLoad.length>5e4&&this._loadIndex()))}}}}]);
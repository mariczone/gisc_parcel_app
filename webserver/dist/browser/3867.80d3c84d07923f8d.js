"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[3867],{52376:(ue,G,d)=>{d.d(G,{S:()=>ee,b:()=>X,g:()=>Q});var v=d(62208),h=d(67831),O=d(99770),x=d(39523),b=d(47923),C=d(39832),M=d(95285),I=d(65787),R=d(17625),F=d(22355),Z=d(35387);function X(){const B=new F.kG,H=B.fragment;return B.include(x.k),H.include(b.S),B.include(C.G),H.uniforms.add(new I.p("radius",(D,L)=>Q(L.camera))),H.code.add(R.H`vec3 sphere[16];
void fillSphere() {
sphere[0] = vec3(0.186937, 0.0, 0.0);
sphere[1] = vec3(0.700542, 0.0, 0.0);
sphere[2] = vec3(-0.864858, -0.481795, -0.111713);
sphere[3] = vec3(-0.624773, 0.102853, -0.730153);
sphere[4] = vec3(-0.387172, 0.260319, 0.007229);
sphere[5] = vec3(-0.222367, -0.642631, -0.707697);
sphere[6] = vec3(-0.01336, -0.014956, 0.169662);
sphere[7] = vec3(0.122575, 0.1544, -0.456944);
sphere[8] = vec3(-0.177141, 0.85997, -0.42346);
sphere[9] = vec3(-0.131631, 0.814545, 0.524355);
sphere[10] = vec3(-0.779469, 0.007991, 0.624833);
sphere[11] = vec3(0.308092, 0.209288,0.35969);
sphere[12] = vec3(0.359331, -0.184533, -0.377458);
sphere[13] = vec3(0.192633, -0.482999, -0.065284);
sphere[14] = vec3(0.233538, 0.293706, -0.055139);
sphere[15] = vec3(0.417709, -0.386701, 0.442449);
}
float fallOffFunction(float vv, float vn, float bias) {
float f = max(radius * radius - vv, 0.0);
return f * f * f * max(vn-bias, 0.0);
}`),H.code.add(R.H`float aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {
vec3 v = Q - C;
float vv = dot(v, v);
float vn = dot(normalize(v), n_C);
return fallOffFunction(vv, vn, 0.1);
}`),H.uniforms.add([new M.A("nearFar",(D,L)=>L.camera.nearFar),new Z.A("normalMap",D=>D.normalTexture),new Z.A("depthMap",D=>D.depthTexture),new M.A("zScale",(D,L)=>(0,C.R)(L)),new I.p("projScale",D=>D.projScale),new Z.A("rnm",D=>D.noiseTexture),new M.A("rnmScale",(D,L)=>(0,h.s)(ae,L.camera.fullWidth/(0,v.Wg)(D.noiseTexture).descriptor.width,L.camera.fullHeight/(0,v.Wg)(D.noiseTexture).descriptor.height)),new I.p("intensity",D=>D.intensity),new M.A("screenSize",(D,L)=>(0,h.s)(ae,L.camera.fullWidth,L.camera.fullHeight))]),H.code.add(R.H`
    void main(void) {
      fillSphere();
      vec3 fres = normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));
      float currentPixelDepth = linearDepthFromTexture(depthMap, uv, nearFar);

      if (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {
        gl_FragColor = vec4(0.0);
        return;
      }

      vec3 currentPixelPos = reconstructPosition(gl_FragCoord.xy,currentPixelDepth);

      // get the normal of current fragment
      vec4 norm4 = texture2D(normalMap, uv);
      vec3 norm = vec3(-1.0) + 2.0 * norm4.xyz;
      bool isTerrain = norm4.w<0.5;

      float sum = .0;
      vec3 tapPixelPos;

      // note: the factor 2.0 should not be necessary, but makes ssao much nicer.
      // bug or deviation from CE somewhere else?
      float ps = projScale / (2.0 * currentPixelPos.z * zScale.x + zScale.y);

      for(int i = 0; i < ${R.H.int(16)}; ++i) {
        vec2 unitOffset = reflect(sphere[i], fres).xy;
        vec2 offset = vec2(-unitOffset * radius * ps);

        //don't use current or very nearby samples
        if ( abs(offset.x)<2.0 || abs(offset.y)<2.0) continue;

        vec2 tc = vec2(gl_FragCoord.xy + offset);
        if (tc.x < 0.0 || tc.y < 0.0 || tc.x > screenSize.x || tc.y > screenSize.y) continue;
        vec2 tcTap = tc / screenSize;
        float occluderFragmentDepth = linearDepthFromTexture(depthMap, tcTap, nearFar);

        if (isTerrain) {
          bool isTerrainTap = texture2D(normalMap, tcTap).w<0.5;
          if (isTerrainTap) {
            continue;
          }
        }

        tapPixelPos = reconstructPosition(tc, occluderFragmentDepth);

        sum+= aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);
      }

      // output the result
      float A = max(1.0 - sum * intensity / float(${R.H.int(16)}),0.0);

      // Anti-tone map to reduce contrast and drag dark region farther: (x^0.2 + 1.2 * x^4)/2.2
      A = (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;
      gl_FragColor = vec4(A);
    }
  `),B}function Q(B){return Math.max(10,20*B.computeRenderPixelSizeAtDist(Math.abs(4*B.relativeElevation)))}const ae=(0,O.a)(),ee=Object.freeze(Object.defineProperty({__proto__:null,build:X,getRadius:Q},Symbol.toStringTag,{value:"Module"}))},86962:(ue,G,d)=>{d.d(G,{S:()=>X,b:()=>z});var v=d(84161),h=d(39523),O=d(47923),x=d(32181),b=d(95285),C=d(65787),M=d(17625),I=d(22355),R=d(5864),F=d(35387);function z(){const Q=new I.kG,ae=Q.fragment;return Q.include(h.k),ae.include(O.S),ae.uniforms.add([new F.A("depthMap",H=>H.depthTexture),new R.R("tex",H=>H.colorTexture),new x.q("blurSize",H=>H.blurSize),new C.p("projScale",(H,D)=>{const L=(0,v.i)(D.camera.eye,D.camera.center);return L>5e4?Math.max(0,H.projScale-(L-5e4)):H.projScale}),new b.A("nearFar",(H,D)=>D.camera.nearFar)]),ae.code.add(M.H`
    void blurFunction(vec2 uv, float r, float center_d, float sharpness, inout float wTotal, inout float bTotal) {
      float c = texture2D(tex, uv).r;
      float d = linearDepthFromTexture(depthMap, uv, nearFar);

      float ddiff = d - center_d;

      float w = exp(-r * r * ${M.H.float(.08)} - ddiff * ddiff * sharpness);
      wTotal += w;
      bTotal += w * c;
    }
  `),ae.code.add(M.H`
    void main(void) {
      float b = 0.0;
      float w_total = 0.0;

      float center_d = linearDepthFromTexture(depthMap, uv, nearFar);

      float sharpness = -0.05 * projScale / center_d;
      for (int r = -${M.H.int(4)}; r <= ${M.H.int(4)}; ++r) {
        float rf = float(r);
        vec2 uvOffset = uv + rf * blurSize;
        blurFunction(uvOffset, rf, center_d, sharpness, w_total, b);
      }

      gl_FragColor = vec4(b / w_total);
    }
  `),Q}const X=Object.freeze(Object.defineProperty({__proto__:null,build:z},Symbol.toStringTag,{value:"Module"}))},98361:(ue,G,d)=>{d.d(G,{T:()=>M,a:()=>R,b:()=>I});var v=d(4794),h=d(39523),O=d(69960),x=d(17625),b=d(22355),C=d(35387);class M extends x.K{constructor(){super(...arguments),this.color=(0,v.f)(1,1,1,1)}}function I(){const F=new b.kG;return F.include(h.k),F.fragment.uniforms.add([new C.A("tex",Z=>Z.texture),new O.N("uColor",Z=>Z.color)]),F.fragment.code.add(x.H`void main() {
vec4 texColor = texture2D(tex, uv);
gl_FragColor = texColor * uColor;
}`),F}const R=Object.freeze(Object.defineProperty({__proto__:null,TextureOnlyPassParameters:M,build:I},Symbol.toStringTag,{value:"Module"}))},48977:(ue,G,d)=>{d.d(G,{c:()=>H,g:()=>R,i:()=>B,j:()=>k,k:()=>L,m:()=>F,r:()=>he,s:()=>I});var v=d(550),h=d(78451),O=d(28093),x=d(39863),b=d(84161),C=d(993);function I($,te,pe){pe*=.5;const fe=Math.sin(pe);return $[0]=fe*te[0],$[1]=fe*te[1],$[2]=fe*te[2],$[3]=Math.cos(pe),$}function R($,te){const pe=2*Math.acos(te[3]),fe=Math.sin(pe/2);return fe>(0,x.g)()?($[0]=te[0]/fe,$[1]=te[1]/fe,$[2]=te[2]/fe):($[0]=1,$[1]=0,$[2]=0),pe}function F($,te,pe){const fe=te[0],ge=te[1],Oe=te[2],xe=te[3],Re=pe[0],Se=pe[1],be=pe[2],Le=pe[3];return $[0]=fe*Le+xe*Re+ge*be-Oe*Se,$[1]=ge*Le+xe*Se+Oe*Re-fe*be,$[2]=Oe*Le+xe*be+fe*Se-ge*Re,$[3]=xe*Le-fe*Re-ge*Se-Oe*be,$}function ae($,te,pe,fe){const ge=te[0],Oe=te[1],xe=te[2],Re=te[3];let Se,be,Le,Fe,we,Ne=pe[0],We=pe[1],je=pe[2],Be=pe[3];return be=ge*Ne+Oe*We+xe*je+Re*Be,be<0&&(be=-be,Ne=-Ne,We=-We,je=-je,Be=-Be),1-be>(0,x.g)()?(Se=Math.acos(be),Le=Math.sin(Se),Fe=Math.sin((1-fe)*Se)/Le,we=Math.sin(fe*Se)/Le):(Fe=1-fe,we=fe),$[0]=Fe*ge+we*Ne,$[1]=Fe*Oe+we*We,$[2]=Fe*xe+we*je,$[3]=Fe*Re+we*Be,$}function B($,te){const pe=te[0],fe=te[1],ge=te[2],Oe=te[3],xe=pe*pe+fe*fe+ge*ge+Oe*Oe,Re=xe?1/xe:0;return $[0]=-pe*Re,$[1]=-fe*Re,$[2]=-ge*Re,$[3]=Oe*Re,$}function H($,te){return $[0]=-te[0],$[1]=-te[1],$[2]=-te[2],$[3]=te[3],$}function D($,te){const pe=te[0]+te[4]+te[8];let fe;if(pe>0)fe=Math.sqrt(pe+1),$[3]=.5*fe,fe=.5/fe,$[0]=(te[5]-te[7])*fe,$[1]=(te[6]-te[2])*fe,$[2]=(te[1]-te[3])*fe;else{let ge=0;te[4]>te[0]&&(ge=1),te[8]>te[3*ge+ge]&&(ge=2);const Oe=(ge+1)%3,xe=(ge+2)%3;fe=Math.sqrt(te[3*ge+ge]-te[3*Oe+Oe]-te[3*xe+xe]+1),$[ge]=.5*fe,fe=.5/fe,$[3]=(te[3*Oe+xe]-te[3*xe+Oe])*fe,$[Oe]=(te[3*Oe+ge]+te[3*ge+Oe])*fe,$[xe]=(te[3*xe+ge]+te[3*ge+xe])*fe}return $}function L($,te,pe,fe){const ge=.5*Math.PI/180;te*=ge,pe*=ge,fe*=ge;const Oe=Math.sin(te),xe=Math.cos(te),Re=Math.sin(pe),Se=Math.cos(pe),be=Math.sin(fe),Le=Math.cos(fe);return $[0]=Oe*Se*Le-xe*Re*be,$[1]=xe*Re*Le+Oe*Se*be,$[2]=xe*Se*be-Oe*Re*Le,$[3]=xe*Se*Le+Oe*Re*be,$}const U=C.c,y=C.s,K=C.a,Y=F,re=C.b,ie=C.d,V=C.l,A=C.e,S=A,w=C.f,W=w,N=C.n,k=C.g,de=C.h;function he($,te,pe){const fe=(0,b.e)(te,pe);return fe<-.999999?((0,b.f)(ne,le,te),(0,b.u)(ne)<1e-6&&(0,b.f)(ne,me,te),(0,b.n)(ne,ne),I($,ne,Math.PI),$):fe>.999999?($[0]=0,$[1]=0,$[2]=0,$[3]=1,$):((0,b.f)(ne,te,pe),$[0]=ne[0],$[1]=ne[1],$[2]=ne[2],$[3]=1+fe,N($,$))}const ne=(0,O.c)(),le=(0,O.f)(1,0,0),me=(0,O.f)(0,1,0),oe=(0,h.a)(),ve=(0,h.a)(),Me=(0,v.c)();Object.freeze(Object.defineProperty({__proto__:null,add:K,calculateW:function Q($,te){const pe=te[0],fe=te[1],ge=te[2];return $[0]=pe,$[1]=fe,$[2]=ge,$[3]=Math.sqrt(Math.abs(1-pe*pe-fe*fe-ge*ge)),$},conjugate:H,copy:U,dot:ie,equals:de,exactEquals:k,fromEuler:L,fromMat3:D,getAxisAngle:R,identity:function M($){return $[0]=0,$[1]=0,$[2]=0,$[3]=1,$},invert:B,len:S,length:A,lerp:V,mul:Y,multiply:F,normalize:N,random:function ee($){const te=x.R,pe=te(),fe=te(),ge=te(),Oe=Math.sqrt(1-pe),xe=Math.sqrt(pe);return $[0]=Oe*Math.sin(2*Math.PI*fe),$[1]=Oe*Math.cos(2*Math.PI*fe),$[2]=xe*Math.sin(2*Math.PI*ge),$[3]=xe*Math.cos(2*Math.PI*ge),$},rotateX:function Z($,te,pe){pe*=.5;const fe=te[0],ge=te[1],Oe=te[2],xe=te[3],Re=Math.sin(pe),Se=Math.cos(pe);return $[0]=fe*Se+xe*Re,$[1]=ge*Se+Oe*Re,$[2]=Oe*Se-ge*Re,$[3]=xe*Se-fe*Re,$},rotateY:function z($,te,pe){pe*=.5;const fe=te[0],ge=te[1],Oe=te[2],xe=te[3],Re=Math.sin(pe),Se=Math.cos(pe);return $[0]=fe*Se-Oe*Re,$[1]=ge*Se+xe*Re,$[2]=Oe*Se+fe*Re,$[3]=xe*Se-ge*Re,$},rotateZ:function X($,te,pe){pe*=.5;const fe=te[0],ge=te[1],Oe=te[2],xe=te[3],Re=Math.sin(pe),Se=Math.cos(pe);return $[0]=fe*Se+ge*Re,$[1]=ge*Se-fe*Re,$[2]=Oe*Se+xe*Re,$[3]=xe*Se-Oe*Re,$},rotationTo:he,scale:re,set:y,setAxes:function Te($,te,pe,fe){const ge=Me;return ge[0]=pe[0],ge[3]=pe[1],ge[6]=pe[2],ge[1]=fe[0],ge[4]=fe[1],ge[7]=fe[2],ge[2]=-te[0],ge[5]=-te[1],ge[8]=-te[2],N($,D($,ge))},setAxisAngle:I,slerp:ae,sqlerp:function J($,te,pe,fe,ge,Oe){return ae(oe,te,ge,Oe),ae(ve,pe,fe,Oe),ae($,oe,ve,2*Oe*(1-Oe)),$},sqrLen:W,squaredLength:w,str:function j($){return"quat("+$[0]+", "+$[1]+", "+$[2]+", "+$[3]+")"}},Symbol.toStringTag,{value:"Module"}))},14658:(ue,G,d)=>{function v(){return new Float32Array(3)}function h(ee){const B=new Float32Array(3);return B[0]=ee[0],B[1]=ee[1],B[2]=ee[2],B}function O(ee,B,H){const D=new Float32Array(3);return D[0]=ee,D[1]=B,D[2]=H,D}function b(){return v()}function C(){return O(1,1,1)}function M(){return O(1,0,0)}function I(){return O(0,1,0)}function R(){return O(0,0,1)}d.d(G,{b:()=>h,c:()=>v,f:()=>O});const F=b(),Z=C(),z=M(),X=I(),Q=R();Object.freeze(Object.defineProperty({__proto__:null,ONES:Z,UNIT_X:z,UNIT_Y:X,UNIT_Z:Q,ZEROS:F,clone:h,create:v,createView:function x(ee,B){return new Float32Array(ee,B,3)},fromValues:O,ones:C,unitX:M,unitY:I,unitZ:R,zeros:b},Symbol.toStringTag,{value:"Module"}))},1101:(ue,G,d)=>{d.d(G,{r:()=>v});class v{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return 0===this._outer.size}get(O,x){return this._outer.get(O)?.get(x)}set(O,x,b){const C=this._outer.get(O);C?C.set(x,b):this._outer.set(O,new Map([[x,b]]))}delete(O,x){const b=this._outer.get(O);b&&(b.delete(x),0===b.size&&this._outer.delete(O))}forEach(O){this._outer.forEach((x,b)=>O(x,b))}}},81096:(ue,G,d)=>{function v(b){switch(b){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}function h(b){switch(b){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0}}function O(b){switch(b){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1}}function x(b){switch(b){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303}}d.d(G,{B3:()=>h,Op:()=>x,U:()=>O,n1:()=>v})},10992:(ue,G,d)=>{d.d(G,{AR:()=>B,Gr:()=>ee,JG:()=>I,Jk:()=>Z,KU:()=>Q,Ue:()=>C,al:()=>R,ct:()=>ae,nF:()=>X,zk:()=>F});var v=d(21286),h=d(97535),O=d(84161),x=d(28093),b=d(26242);function C(U){return U?{origin:(0,x.a)(U.origin),vector:(0,x.a)(U.vector)}:{origin:(0,x.c)(),vector:(0,x.c)()}}function I(U,y=C()){return R(U.origin,U.vector,y)}function R(U,y,K=C()){return(0,O.c)(K.origin,U),(0,O.c)(K.vector,y),K}function F(U,y,K=C()){return(0,O.c)(K.origin,U),(0,O.b)(K.vector,y,U),K}function Z(U,y){const K=(0,O.b)(b.WM.get(),y,U.origin),Y=(0,O.e)(U.vector,K),re=(0,O.e)(U.vector,U.vector),ie=(0,v.uZ)(Y/re,0,1),V=(0,O.b)(b.WM.get(),(0,O.g)(b.WM.get(),U.vector,ie),K);return(0,O.e)(V,V)}function X(U,y,K){return ae(U,y,0,1,K)}function Q(U,y,K){return(0,O.a)(K,U.origin,(0,O.g)(K,U.vector,y))}function ae(U,y,K,Y,re){const{vector:ie,origin:V}=U,A=(0,O.b)(b.WM.get(),y,V),S=(0,O.e)(ie,A)/(0,O.p)(ie);return(0,O.g)(re,ie,(0,v.uZ)(S,K,Y)),(0,O.a)(re,re,U.origin)}function ee(U,y){if(D(U,function M(U,y){const K=j.get();return K.origin=U,K.vector=y,K}(y.origin,y.direction),!1,L)){const{tA:K,pB:Y,distance2:re}=L;if(K>=0&&K<=1)return re;if(K<0)return(0,O.d)(U.origin,Y);if(K>1)return(0,O.d)((0,O.a)(b.WM.get(),U.origin,U.vector),Y)}return null}function B(U,y,K){return!!D(U,y,!0,L)&&((0,O.c)(K,L.pA),!0)}function D(U,y,K,Y){const ie=U.origin,V=(0,O.a)(b.WM.get(),ie,U.vector),A=y.origin,S=(0,O.a)(b.WM.get(),A,y.vector),w=b.WM.get(),W=b.WM.get();if(w[0]=ie[0]-A[0],w[1]=ie[1]-A[1],w[2]=ie[2]-A[2],W[0]=S[0]-A[0],W[1]=S[1]-A[1],W[2]=S[2]-A[2],Math.abs(W[0])<1e-6&&Math.abs(W[1])<1e-6&&Math.abs(W[2])<1e-6)return!1;const N=b.WM.get();if(N[0]=V[0]-ie[0],N[1]=V[1]-ie[1],N[2]=V[2]-ie[2],Math.abs(N[0])<1e-6&&Math.abs(N[1])<1e-6&&Math.abs(N[2])<1e-6)return!1;const k=w[0]*W[0]+w[1]*W[1]+w[2]*W[2],de=W[0]*N[0]+W[1]*N[1]+W[2]*N[2],he=w[0]*N[0]+w[1]*N[1]+w[2]*N[2],ne=W[0]*W[0]+W[1]*W[1]+W[2]*W[2],le=(N[0]*N[0]+N[1]*N[1]+N[2]*N[2])*ne-de*de;if(Math.abs(le)<1e-6)return!1;let me=(k*de-he*ne)/le,J=(k+de*me)/ne;K&&(me=(0,v.uZ)(me,0,1),J=(0,v.uZ)(J,0,1));const oe=b.WM.get(),ve=b.WM.get();return oe[0]=ie[0]+me*N[0],oe[1]=ie[1]+me*N[1],oe[2]=ie[2]+me*N[2],ve[0]=A[0]+J*W[0],ve[1]=A[1]+J*W[1],ve[2]=A[2]+J*W[2],Y.tA=me,Y.tB=J,Y.pA=oe,Y.pB=ve,Y.distance2=(0,O.d)(oe,ve),!0}const L={tA:0,tB:0,pA:(0,x.c)(),pB:(0,x.c)(),distance2:0},j=new h.x(()=>C())},11544:(ue,G,d)=>{d.d(G,{bE:()=>Q,wu:()=>z});var v=d(97535),h=d(84161),O=d(28093),x=d(10992);function z(D,L,j){return.5*Math.abs((L[0]-D[0])*(j[1]-D[1])-(L[1]-D[1])*(j[0]-D[0]))}function Q(D,L,j){return(0,h.b)(B,L,D),(0,h.b)(H,j,D),(0,h.l)((0,h.f)(B,B,H))/2}d(26242),new v.x(x.Ue),new v.x(()=>function C(D){return D?{p0:(0,O.a)(D.p0),p1:(0,O.a)(D.p1),p2:(0,O.a)(D.p2)}:{p0:(0,O.c)(),p1:(0,O.c)(),p2:(0,O.c)()}}());const B=(0,O.c)(),H=(0,O.c)()},70026:(ue,G,d)=>{d.d(G,{t:()=>O});var v=d(15861),h=d(84792);function O(b,C){return x.apply(this,arguments)}function x(){return(x=(0,v.Z)(function*(b,C){const{data:M}=yield(0,h.default)(b,{responseType:"image",...C});return M})).apply(this,arguments)}},19625:(ue,G,d)=>{d.d(G,{U$:()=>b});var v=d(60479),h=d(81096);class O{constructor(M,I){this.layout=M,this.buffer="number"==typeof I?new ArrayBuffer(I*M.stride):I;for(const R of M.fieldNames){const F=M.fields.get(R);this[R]=new F.constructor(this.buffer,F.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(M,I){const R=this[M];return R&&R.elementCount===I.ElementCount&&R.elementType===I.ElementType?R:null}slice(M,I){return new O(this.layout,this.buffer.slice(M*this.stride,I*this.stride))}copyFrom(M,I,R,F){const Z=this.stride;if(Z%4==0){const z=new Uint32Array(M.buffer,I*Z,F*Z/4);new Uint32Array(this.buffer,R*Z,F*Z/4).set(z)}else{const z=new Uint8Array(M.buffer,I*Z,F*Z);new Uint8Array(this.buffer,R*Z,F*Z).set(z)}}}class x{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(M,I){return this._appendField(M,v.Eu,I),this}vec2f64(M,I){return this._appendField(M,v.q6,I),this}vec3f(M,I){return this._appendField(M,v.ct,I),this}vec3f64(M,I){return this._appendField(M,v.fP,I),this}vec4f(M,I){return this._appendField(M,v.ek,I),this}vec4f64(M,I){return this._appendField(M,v.Cd,I),this}mat3f(M,I){return this._appendField(M,v.gK,I),this}mat3f64(M,I){return this._appendField(M,v.ey,I),this}mat4f(M,I){return this._appendField(M,v.bj,I),this}mat4f64(M,I){return this._appendField(M,v.O1,I),this}vec4u8(M,I){return this._appendField(M,v.mc,I),this}f32(M,I){return this._appendField(M,v.ly,I),this}f64(M,I){return this._appendField(M,v.oS,I),this}u8(M,I){return this._appendField(M,v.D_,I),this}u16(M,I){return this._appendField(M,v.av,I),this}i8(M,I){return this._appendField(M,v.Hz,I),this}vec2i8(M,I){return this._appendField(M,v.Vs,I),this}vec2i16(M,I){return this._appendField(M,v.or,I),this}vec2u8(M,I){return this._appendField(M,v.xA,I),this}vec4u16(M,I){return this._appendField(M,v.v6,I),this}u32(M,I){return this._appendField(M,v.Nu,I),this}_appendField(M,I,R){const F=I.ElementCount*(0,h.n1)(I.ElementType);this.fields.set(M,{size:F,constructor:I,offset:this.stride,optional:R}),this.stride+=F,this.fieldNames.push(M)}alignTo(M){return this.stride=Math.floor((this.stride+M-1)/M)*M,this}hasField(M){return this.fieldNames.includes(M)}createBuffer(M){return new O(this,M)}createView(M){return new O(this,M)}clone(){const M=new x;return M.stride=this.stride,M.fields=new Map,this.fields.forEach((I,R)=>M.fields.set(R,I)),M.fieldNames=this.fieldNames.slice(),M.BufferType=this.BufferType,M}}function b(){return new x}},52382:(ue,G,d)=>{d.d(G,{Lm:()=>b,Zu:()=>C,bA:()=>M,qj:()=>I});var v=d(13934),h=d(51040),O=d(95285),x=d(17625);function b(R){R.varyings.add("linearDepth","float")}function C(R){R.vertex.uniforms.add(new O.A("nearFar",(F,Z)=>Z.camera.nearFar))}function M(R){R.vertex.code.add(x.H`float calculateLinearDepth(vec2 nearFar,float z) {
return (-z - nearFar[0]) / (nearFar[1] - nearFar[0]);
}`)}function I(R,F){const{vertex:Z}=R;switch(F.output){case v.H.Color:if(F.receiveShadows)return b(R),void Z.code.add(x.H`void forwardLinearDepth() { linearDepth = gl_Position.w; }`);break;case v.H.Depth:case v.H.Shadow:case v.H.ShadowHighlight:case v.H.ShadowExcludeHighlight:return R.include(h.up,F),b(R),C(R),M(R),void Z.code.add(x.H`void forwardLinearDepth() {
linearDepth = calculateLinearDepth(nearFar, vPosition_view.z);
}`)}Z.code.add(x.H`void forwardLinearDepth() {}`)}},39523:(ue,G,d)=>{d.d(G,{k:()=>O});var v=d(17625),h=d(16396);function O(x,b=!0){x.attributes.add(h.T.POSITION,"vec2"),b&&x.varyings.add("uv","vec2"),x.vertex.code.add(v.H`
    void main(void) {
      gl_Position = vec4(position, 0.0, 1.0);
      ${b?v.H`uv = position * 0.5 + vec2(0.5);`:""}
    }
  `)}},13934:(ue,G,d)=>{var v,h;d.d(G,{H:()=>v}),(h=v||(v={}))[h.Color=0]="Color",h[h.Depth=1]="Depth",h[h.Normal=2]="Normal",h[h.Shadow=3]="Shadow",h[h.ShadowHighlight=4]="ShadowHighlight",h[h.ShadowExcludeHighlight=5]="ShadowExcludeHighlight",h[h.Highlight=6]="Highlight",h[h.Alpha=7]="Alpha",h[h.ObjectAndLayerIdColor=8]="ObjectAndLayerIdColor",h[h.COUNT=9]="COUNT"},78925:(ue,G,d)=>{d.d(G,{f5:()=>Z});var v=d(62208),h=d(28347),O=d(43703),x=d(84161),b=d(28093),C=d(77739),I=(d(97139),d(17625));function Z(U,y){!function z(U,y,K){if(!y.hasSlicePlane){const V=I.H`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;return y.hasSliceInVertexProgram&&U.vertex.code.add(V),void U.fragment.code.add(V)}U.extensions.add("GL_OES_standard_derivatives"),y.hasSliceInVertexProgram&&U.vertex.uniforms.add(K),U.fragment.uniforms.add(K);const Y=I.H`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,re=I.H`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
if (sliceByFactors(factors)) {
return color;
}
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,ie=y.hasSliceHighlight?I.H`
        ${re}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `:I.H`#define highlightSlice(_color_, _pos_) (_color_)`;y.hasSliceInVertexProgram&&U.vertex.code.add(Y),U.fragment.code.add(Y),U.fragment.code.add(ie)}(U,y,[new C.B("slicePlaneOrigin",(K,Y)=>function ee(U,y,K){if((0,v.Wi)(K.slicePlane))return b.Z;const Y=X(U,y,K),re=Q(Y,K.slicePlane),ie=ae(U,Y,K);return(0,v.pC)(ie)?(0,x.m)(D,re,ie):re}(y,K,Y)),new C.B("slicePlaneBasis1",(K,Y)=>B(y,K,Y,(0,v.Wg)(Y.slicePlane)?.basis1)),new C.B("slicePlaneBasis2",(K,Y)=>B(y,K,Y,(0,v.Wg)(Y.slicePlane)?.basis2))])}function X(U,y,K){return U.instancedDoublePrecision?(0,x.s)(H,K.camera.viewInverseTransposeMatrix[3],K.camera.viewInverseTransposeMatrix[7],K.camera.viewInverseTransposeMatrix[11]):y.slicePlaneLocalOrigin}function Q(U,y){return(0,v.pC)(U)?(0,x.b)(D,y.origin,U):y.origin}function ae(U,y,K){return U.hasSliceTranslatedView?(0,v.pC)(y)?(0,h.w)(j,K.camera.viewMatrix,y):K.camera.viewMatrix:null}function B(U,y,K,Y){if((0,v.Wi)(Y)||(0,v.Wi)(K.slicePlane))return b.Z;const re=X(U,y,K),ie=Q(re,K.slicePlane),V=ae(U,re,K);return(0,v.pC)(V)?((0,x.a)(L,Y,ie),(0,x.m)(D,ie,V),(0,x.m)(L,L,V),(0,x.b)(L,L,D)):Y}const H=(0,b.c)(),D=(0,b.c)(),L=(0,b.c)(),j=(0,O.c)()},24255:(ue,G,d)=>{d.d(G,{w:()=>O});var v=d(52382),h=d(17625);function O(x,b){if((0,v.bA)(x),b.hasModelTransformation)return x.vertex.code.add(h.H`vec4 transformPositionWithDepth(mat4 proj, mat4 view, mat4 model, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * (model * vec4(pos, 1.0));
depth = calculateLinearDepth(nearFar, eye.z);
return proj * eye;
}`),void x.vertex.code.add(h.H`vec4 transformPosition(mat4 proj, mat4 view, mat4 model, vec3 pos) {
return proj * (view * (model * vec4(pos, 1.0)));
}`);x.vertex.code.add(h.H`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = calculateLinearDepth(nearFar,eye.z);
return proj * eye;
}`),x.vertex.code.add(h.H`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},26859:(ue,G,d)=>{d.d(G,{O:()=>b,h:()=>C});var v=d(94573),h=d(17625);function O(M){const I=h.H`vec3 decodeNormal(vec2 f) {
float z = 1.0 - abs(f.x) - abs(f.y);
return vec3(f + sign(f) * min(z, 0.0), z);
}`;M.vertex.code.add(I)}var C,M,x=d(16396);function b(M,I){switch(I.normalType){case C.CompressedAttribute:M.include(O),M.attributes.add(x.T.NORMALCOMPRESSED,"vec2"),M.vertex.code.add(h.H`vec3 normalModel() {
return decodeNormal(normalCompressed);
}`);break;case C.Attribute:M.attributes.add(x.T.NORMAL,"vec3"),M.vertex.code.add(h.H`vec3 normalModel() {
return normal;
}`);break;case C.ScreenDerivative:M.extensions.add("GL_OES_standard_derivatives"),M.fragment.code.add(h.H`vec3 screenDerivativeNormal(vec3 positionView) {
return normalize(cross(dFdx(positionView), dFdy(positionView)));
}`);break;default:(0,v.Bg)(I.normalType);case C.COUNT:case C.Ground:}}(M=C||(C={}))[M.Attribute=0]="Attribute",M[M.CompressedAttribute=1]="CompressedAttribute",M[M.Ground=2]="Ground",M[M.ScreenDerivative=3]="ScreenDerivative",M[M.COUNT=4]="COUNT"},23164:(ue,G,d)=>{d.d(G,{R:()=>x});var v=d(13934),h=d(17625),O=d(16396);function x(b,C){const M=C.output===v.H.ObjectAndLayerIdColor,I=C.objectAndLayerIdColorInstanced;M&&(b.varyings.add("objectAndLayerIdColorVarying","vec4"),b.attributes.add(I?O.T.OBJECTANDLAYERIDCOLOR_INSTANCED:O.T.OBJECTANDLAYERIDCOLOR,"vec4")),b.vertex.code.add(h.H`
     void forwardObjectAndLayerIdColor() {
      ${M?I?h.H`objectAndLayerIdColorVarying = objectAndLayerIdColor_instanced * 0.003921568627451;`:h.H`objectAndLayerIdColorVarying = objectAndLayerIdColor * 0.003921568627451;`:h.H``} }`),b.fragment.code.add(h.H`
      void outputObjectAndLayerIdColor() {
        ${M?h.H`gl_FragColor = objectAndLayerIdColorVarying;`:h.H``} }`)}},84833:(ue,G,d)=>{d.d(G,{f:()=>O});var v=d(17625),h=d(16396);function O(x){x.attributes.add(h.T.POSITION,"vec3"),x.vertex.code.add(v.H`vec3 positionModel() { return position; }`)}},36603:(ue,G,d)=>{d.d(G,{D:()=>b,N:()=>x});var x,C,v=d(94573),h=d(17625),O=d(16396);function b(C,M){switch(M.textureCoordinateType){case x.Default:return C.attributes.add(O.T.UV0,"vec2"),C.varyings.add("vuv0","vec2"),void C.vertex.code.add(h.H`void forwardTextureCoordinates() {
vuv0 = uv0;
}`);case x.Compressed:return C.attributes.add(O.T.UV0,"vec2"),C.varyings.add("vuv0","vec2"),void C.vertex.code.add(h.H`vec2 getUV0() {
return uv0 / 16384.0;
}
void forwardTextureCoordinates() {
vuv0 = getUV0();
}`);case x.Atlas:return C.attributes.add(O.T.UV0,"vec2"),C.varyings.add("vuv0","vec2"),C.attributes.add(O.T.UVREGION,"vec4"),C.varyings.add("vuvRegion","vec4"),void C.vertex.code.add(h.H`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:(0,v.Bg)(M.textureCoordinateType);case x.None:return void C.vertex.code.add(h.H`void forwardTextureCoordinates() {}`);case x.COUNT:return}}(C=x||(x={}))[C.None=0]="None",C[C.Default=1]="Default",C[C.Atlas=2]="Atlas",C[C.Compressed=3]="Compressed",C[C.COUNT=4]="COUNT"},58173:(ue,G,d)=>{d.d(G,{c:()=>O});var v=d(17625),h=d(16396);function O(x,b){b.hasVertexColors?(x.attributes.add(h.T.COLOR,"vec4"),x.varyings.add("vColor","vec4"),x.vertex.code.add(v.H`void forwardVertexColor() { vColor = color; }`),x.vertex.code.add(v.H`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):x.vertex.code.add(v.H`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},21799:(ue,G,d)=>{d.d(G,{Bb:()=>R,Pf:()=>Z,d4:()=>F});var v=d(94573),h=d(550),O=d(4794),x=d(26859),b=d(51040),C=d(17625),M=d(9546),I=d(91574);function R(z,X){switch(X.normalType){case x.h.Attribute:case x.h.CompressedAttribute:z.include(x.O,X),z.varyings.add("vNormalWorld","vec3"),z.varyings.add("vNormalView","vec3"),z.vertex.uniforms.add([new M.j("transformNormalGlobalFromModel",Q=>Q.transformNormalGlobalFromModel),new I.c("transformNormalViewFromGlobal",Q=>Q.transformNormalViewFromGlobal)]),z.vertex.code.add(C.H`void forwardNormal() {
vNormalWorld = transformNormalGlobalFromModel * normalModel();
vNormalView = transformNormalViewFromGlobal * vNormalWorld;
}`);break;case x.h.Ground:z.include(b.up,X),z.varyings.add("vNormalWorld","vec3"),z.vertex.code.add(C.H`
        void forwardNormal() {
          vNormalWorld = ${X.spherical?C.H`normalize(vPositionWorldCameraRelative);`:C.H`vec3(0.0, 0.0, 1.0);`}
        }
        `);break;case x.h.ScreenDerivative:z.vertex.code.add(C.H`void forwardNormal() {}`);break;default:(0,v.Bg)(X.normalType);case x.h.COUNT:}}class F extends b.su{constructor(){super(...arguments),this.transformNormalViewFromGlobal=(0,h.c)()}}class Z extends b.OU{constructor(){super(...arguments),this.transformNormalGlobalFromModel=(0,h.c)(),this.toMapSpace=(0,O.c)()}}},51040:(ue,G,d)=>{d.d(G,{OU:()=>ae,su:()=>Q,up:()=>X});var v=d(550),h=d(43703),O=d(14658),x=d(28093),b=d(84833),C=d(7228),M=d(77739),I=d(97139),R=d(17625),F=d(9546),Z=d(91574),z=d(63123);function X(ee,B){ee.include(b.f);const H=ee.vertex;H.include(C.$,B),ee.varyings.add("vPositionWorldCameraRelative","vec3"),ee.varyings.add("vPosition_view","vec3"),H.uniforms.add([new I.J("transformWorldFromViewTH",D=>D.transformWorldFromViewTH),new I.J("transformWorldFromViewTL",D=>D.transformWorldFromViewTL),new Z.c("transformViewFromCameraRelativeRS",D=>D.transformViewFromCameraRelativeRS),new z.g("transformProjFromView",D=>D.transformProjFromView),new F.j("transformWorldFromModelRS",D=>D.transformWorldFromModelRS),new M.B("transformWorldFromModelTH",D=>D.transformWorldFromModelTH),new M.B("transformWorldFromModelTL",D=>D.transformWorldFromModelTL)]),H.code.add(R.H`vec3 positionWorldCameraRelative() {
vec3 rotatedModelPosition = transformWorldFromModelRS * positionModel();
vec3 transform_CameraRelativeFromModel = dpAdd(
transformWorldFromModelTL,
transformWorldFromModelTH,
-transformWorldFromViewTL,
-transformWorldFromViewTH
);
return transform_CameraRelativeFromModel + rotatedModelPosition;
}`),H.code.add(R.H`
    void forwardPosition(float fOffset) {
      vPositionWorldCameraRelative = positionWorldCameraRelative();
      if (fOffset != 0.0) {
        vPositionWorldCameraRelative += fOffset * ${B.spherical?R.H`normalize(transformWorldFromViewTL + vPositionWorldCameraRelative)`:R.H`vec3(0.0, 0.0, 1.0)`};
      }

      vPosition_view = transformViewFromCameraRelativeRS * vPositionWorldCameraRelative;
      gl_Position = transformProjFromView * vec4(vPosition_view, 1.0);
    }
  `),ee.fragment.uniforms.add(new I.J("transformWorldFromViewTL",D=>D.transformWorldFromViewTL)),H.code.add(R.H`vec3 positionWorld() {
return transformWorldFromViewTL + vPositionWorldCameraRelative;
}`),ee.fragment.code.add(R.H`vec3 positionWorld() {
return transformWorldFromViewTL + vPositionWorldCameraRelative;
}`)}class Q extends R.K{constructor(){super(...arguments),this.transformWorldFromViewTH=(0,x.c)(),this.transformWorldFromViewTL=(0,x.c)(),this.transformViewFromCameraRelativeRS=(0,v.c)(),this.transformProjFromView=(0,h.c)()}}class ae extends R.K{constructor(){super(...arguments),this.transformWorldFromModelRS=(0,v.c)(),this.transformWorldFromModelTH=(0,O.c)(),this.transformWorldFromModelTL=(0,O.c)()}}},85982:(ue,G,d)=>{d.d(G,{i:()=>b});var v=d(94573),h=d(36603),O=d(17625);function x(C){C.extensions.add("GL_EXT_shader_texture_lod"),C.extensions.add("GL_OES_standard_derivatives"),C.fragment.code.add(O.H`#ifndef GL_EXT_shader_texture_lod
float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {
float deltaMaxSqr = max(dot(ddx, ddx), dot(ddy, ddy));
return max(0.0, 0.5 * log2(deltaMaxSqr));
}
#endif
vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
#ifdef GL_EXT_shader_texture_lod
return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);
#else
vec2 dUVdxAuto = dFdx(uvAtlas);
vec2 dUVdyAuto = dFdy(uvAtlas);
float mipMapLevel = calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);
float autoMipMapLevel = calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);
return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);
#endif
}`)}function b(C,M){switch(C.include(h.D,M),C.fragment.code.add(O.H`
  struct TextureLookupParameter {
    vec2 uv;
    ${M.supportsTextureAtlas?"vec2 size;":""}
  } vtc;
  `),M.textureCoordinateType){case h.N.Default:case h.N.Compressed:return void C.fragment.code.add(O.H`vec4 textureLookup(sampler2D texture, TextureLookupParameter params) {
return texture2D(texture, params.uv);
}`);case h.N.Atlas:return C.include(x),void C.fragment.code.add(O.H`vec4 textureLookup(sampler2D texture, TextureLookupParameter params) {
return textureAtlasLookup(texture, params.size, params.uv, vuvRegion);
}`);default:(0,v.Bg)(M.textureCoordinateType);case h.N.None:case h.N.COUNT:return}}},66085:(ue,G,d)=>{d.d(G,{L:()=>M,V:()=>R});var v=d(993),h=d(4794),O=d(71850),x=d(99198),b=d(69960),C=d(17625);function M(F,Z){const z=F.vertex;Z.hasVerticalOffset?(R(z),Z.hasScreenSizePerspective&&(F.include(O.cK),(0,O.m8)(z),(0,x.hY)(F.vertex,Z)),z.code.add(C.H`
      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
        ${Z.spherical?C.H`vec3 worldNormal = normalize(worldPos + localOrigin);`:C.H`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
        ${Z.hasScreenSizePerspective?C.H`
            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));
            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:C.H`
            float verticalOffsetScreenHeight = verticalOffset.x;`}
        // Screen sized offset in world space, used for example for line callouts
        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
        return worldNormal * worldOffset;
      }

      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        return worldPos + calculateVerticalOffset(worldPos, localOrigin);
      }
    `)):z.code.add(C.H`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const I=(0,h.c)();function R(F){F.uniforms.add(new b.N("verticalOffset",(Z,z)=>{const{minWorldLength:X,maxWorldLength:Q,screenLength:ae}=Z.verticalOffset,ee=Math.tan(.5*z.camera.fovY)/(.5*z.camera.fullViewport[3]);return(0,v.s)(I,ae*(z.camera.pixelRatio||1),ee,X,Q)}))}},54120:(ue,G,d)=>{d.d(G,{F:()=>x});var v=d(13934),h=d(19278),O=d(17625);function x(b,C){switch(b.fragment.include(h.n),C.output){case v.H.Shadow:case v.H.ShadowHighlight:case v.H.ShadowExcludeHighlight:b.extensions.add("GL_OES_standard_derivatives"),b.fragment.code.add(O.H`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 20.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`);break;case v.H.Depth:b.fragment.code.add(O.H`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)}}},62952:(ue,G,d)=>{d.d(G,{bA:()=>I});var v=d(4794),h=d(43177),O=d(17625),x=d(35387),b=d(19755);const C=(0,v.f)(1,1,0,1),M=(0,v.f)(1,0,1,1);function I(R,F){R.fragment.uniforms.add((0,x.J)("depthTex",(Z,z)=>z.highlightDepthTexture,F.hasWebGL2Context?b.D.None:b.D.InvSize)),R.fragment.constants.add("occludedHighlightFlag","vec4",C).add("unoccludedHighlightFlag","vec4",M),R.fragment.code.add(O.H`
    void outputHighlight() {
      vec3 fragCoord = gl_FragCoord.xyz;

      float sceneDepth = ${(0,h.b6)(F,"depthTex","fragCoord.xy")}.x;
      if (fragCoord.z > sceneDepth + 5e-7) {
        gl_FragColor = occludedHighlightFlag;
      }
      else {
        gl_FragColor = unoccludedHighlightFlag;
      }
    }
  `)}},47923:(ue,G,d)=>{d.d(G,{S:()=>O});var v=d(19278),h=d(17625);function O(x){x.include(v.n),x.code.add(h.H`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)}},44965:(ue,G,d)=>{d.d(G,{_:()=>R});var v=d(84161),h=d(28093),O=d(993),x=d(4794),b=d(92724),C=d(97139),M=d(69960),I=d(17625);function R(z,X){const Q=z.fragment,ae=void 0!==X.lightingSphericalHarmonicsOrder?X.lightingSphericalHarmonicsOrder:2;0===ae?(Q.uniforms.add(new C.J("lightingAmbientSH0",(ee,B)=>(0,v.s)(F,B.lighting.sh.r[0],B.lighting.sh.g[0],B.lighting.sh.b[0]))),Q.code.add(I.H`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {
vec3 ambientLight = 0.282095 * lightingAmbientSH0;
return ambientLight * (1.0 - ambientOcclusion);
}`)):1===ae?(Q.uniforms.add([new M.N("lightingAmbientSH_R",(ee,B)=>(0,O.s)(Z,B.lighting.sh.r[0],B.lighting.sh.r[1],B.lighting.sh.r[2],B.lighting.sh.r[3])),new M.N("lightingAmbientSH_G",(ee,B)=>(0,O.s)(Z,B.lighting.sh.g[0],B.lighting.sh.g[1],B.lighting.sh.g[2],B.lighting.sh.g[3])),new M.N("lightingAmbientSH_B",(ee,B)=>(0,O.s)(Z,B.lighting.sh.b[0],B.lighting.sh.b[1],B.lighting.sh.b[2],B.lighting.sh.b[3]))]),Q.code.add(I.H`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {
vec4 sh0 = vec4(
0.282095,
0.488603 * normal.x,
0.488603 * normal.z,
0.488603 * normal.y
);
vec3 ambientLight = vec3(
dot(lightingAmbientSH_R, sh0),
dot(lightingAmbientSH_G, sh0),
dot(lightingAmbientSH_B, sh0)
);
return ambientLight * (1.0 - ambientOcclusion);
}`)):2===ae&&(Q.uniforms.add([new C.J("lightingAmbientSH0",(ee,B)=>(0,v.s)(F,B.lighting.sh.r[0],B.lighting.sh.g[0],B.lighting.sh.b[0])),new M.N("lightingAmbientSH_R1",(ee,B)=>(0,O.s)(Z,B.lighting.sh.r[1],B.lighting.sh.r[2],B.lighting.sh.r[3],B.lighting.sh.r[4])),new M.N("lightingAmbientSH_G1",(ee,B)=>(0,O.s)(Z,B.lighting.sh.g[1],B.lighting.sh.g[2],B.lighting.sh.g[3],B.lighting.sh.g[4])),new M.N("lightingAmbientSH_B1",(ee,B)=>(0,O.s)(Z,B.lighting.sh.b[1],B.lighting.sh.b[2],B.lighting.sh.b[3],B.lighting.sh.b[4])),new M.N("lightingAmbientSH_R2",(ee,B)=>(0,O.s)(Z,B.lighting.sh.r[5],B.lighting.sh.r[6],B.lighting.sh.r[7],B.lighting.sh.r[8])),new M.N("lightingAmbientSH_G2",(ee,B)=>(0,O.s)(Z,B.lighting.sh.g[5],B.lighting.sh.g[6],B.lighting.sh.g[7],B.lighting.sh.g[8])),new M.N("lightingAmbientSH_B2",(ee,B)=>(0,O.s)(Z,B.lighting.sh.b[5],B.lighting.sh.b[6],B.lighting.sh.b[7],B.lighting.sh.b[8]))]),Q.code.add(I.H`vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {
vec3 ambientLight = 0.282095 * lightingAmbientSH0;
vec4 sh1 = vec4(
0.488603 * normal.x,
0.488603 * normal.z,
0.488603 * normal.y,
1.092548 * normal.x * normal.y
);
vec4 sh2 = vec4(
1.092548 * normal.y * normal.z,
0.315392 * (3.0 * normal.z * normal.z - 1.0),
1.092548 * normal.x * normal.z,
0.546274 * (normal.x * normal.x - normal.y * normal.y)
);
ambientLight += vec3(
dot(lightingAmbientSH_R1, sh1),
dot(lightingAmbientSH_G1, sh1),
dot(lightingAmbientSH_B1, sh1)
);
ambientLight += vec3(
dot(lightingAmbientSH_R2, sh2),
dot(lightingAmbientSH_G2, sh2),
dot(lightingAmbientSH_B2, sh2)
);
return ambientLight * (1.0 - ambientOcclusion);
}`),X.pbrMode!==b.f7.Normal&&X.pbrMode!==b.f7.Schematic||Q.code.add(I.H`const vec3 skyTransmittance = vec3(0.9, 0.9, 1.0);
vec3 calculateAmbientRadiance(float ambientOcclusion)
{
vec3 ambientLight = 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;
return ambientLight *= (1.0 - ambientOcclusion) * skyTransmittance;
}`))}const F=(0,h.c)(),Z=(0,x.c)()},31166:(ue,G,d)=>{d.d(G,{F1:()=>b,Pe:()=>x,kR:()=>M});var v=d(97139),h=d(65787),O=d(17625);function x(I){I.uniforms.add(new v.J("mainLightDirection",(R,F)=>F.lighting.mainLight.direction))}function b(I){I.uniforms.add(new v.J("mainLightIntensity",(R,F)=>F.lighting.mainLight.intensity))}function M(I,R){const F=I.fragment;x(F),b(F),function C(I,R){R.useLegacyTerrainShading?I.uniforms.add(new h.p("lightingFixedFactor",(F,Z)=>Z.lighting.noonFactor*(1-Z.lighting.globalFactor))):I.constants.add("lightingFixedFactor","float",0)}(F,R),F.code.add(O.H`vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {
float dotVal = clamp(dot(normal_global, mainLightDirection), 0.0, 1.0);
dotVal = mix(dotVal, 1.0, lightingFixedFactor);
return mainLightIntensity * ((1.0 - shadowing) * dotVal);
}`)}},10109:(ue,G,d)=>{d.d(G,{a:()=>C,l:()=>b});var v=d(47923),h=d(95285),O=d(17625),x=d(35387);function b(M,I){I.hasMultipassTerrain&&(M.fragment.include(v.S),M.fragment.uniforms.add(new x.A("terrainDepthTexture",(R,F)=>F.multipassTerrain.linearDepthTexture)),M.fragment.uniforms.add(new h.A("nearFar",(R,F)=>F.camera.nearFar)),M.fragment.uniforms.add(new h.A("inverseViewport",(R,F)=>F.inverseViewport)),M.fragment.code.add(O.H`
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){
      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, nearFar);
      if(fragmentDepth ${I.cullAboveGround?">":"<="} terrainDepth){
        discard;
      }
    }
  `))}class C{constructor(){this.enabled=!1,this.cullAboveGround=!1}}},98898:(ue,G,d)=>{d.d(G,{T:()=>b,g:()=>C});var v=d(17625);function h(M){const I=M.fragment.code;I.add(v.H`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)
{
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),I.add(v.H`float integratedRadiance(float cosTheta2, float roughness)
{
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),I.add(v.H`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)
{
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var O=d(92724),x=d(39337);function b(M,I){const R=M.fragment.code;M.include(x.e),I.pbrMode!==O.f7.Normal&&I.pbrMode!==O.f7.Schematic&&I.pbrMode!==O.f7.Terrain&&I.pbrMode!==O.f7.TerrainWithWater||(R.add(v.H`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),R.add(v.H`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`)),I.pbrMode!==O.f7.Normal&&I.pbrMode!==O.f7.Schematic||(M.include(h),R.add(v.H`struct PBRShadingInfo
{
float NdotL;
float NdotV;
float NdotH;
float VdotH;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),R.add(v.H`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`),R.add(v.H`float gamutMapChanel(float x, vec2 p){
return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );
}`),R.add(v.H`vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){
vec3 outColor;
vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));
outColor.x = gamutMapChanel(inColor.x, p) ;
outColor.y = gamutMapChanel(inColor.y, p) ;
outColor.z = gamutMapChanel(inColor.z, p) ;
return outColor;
}`))}function C(M,I){const R=M.fragment.code;M.include(x.e),R.add(v.H`
  struct PBRShadingWater
  {
      float NdotL;   // cos angle between normal and light direction
      float NdotV;   // cos angle between normal and view direction
      float NdotH;   // cos angle between normal and half vector
      float VdotH;   // cos angle between view direction and half vector
      float LdotH;   // cos angle between light direction and half vector
      float VdotN;   // cos angle between view direction and normal vector
  };

  float dtrExponent = ${I.useCustomDTRExponentForWater?"2.2":"2.0"};
  `),R.add(v.H`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),R.add(v.H`float normalDistributionWater(float NdotH, float roughness)
{
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),R.add(v.H`float geometricOcclusionKelemen(float LoH)
{
return 0.25 / (LoH * LoH);
}`),R.add(v.H`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)
{
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}
vec3 tonemapACES(const vec3 x) {
return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);
}`)}},92724:(ue,G,d)=>{d.d(G,{f7:()=>X,jV:()=>ae});var X,ee,v=d(14658),h=d(85982),O=d(43177),x=d(77739),b=d(97139),C=d(17625),M=d(5864),I=d(35387),R=d(19755),F=d(37847);function ae(ee,B){const H=ee.fragment,D=B.hasMetallicRoughnessTexture||B.hasEmissionTexture||B.hasOcclusionTexture;if(B.pbrMode===X.Normal&&D&&ee.include(h.i,B),B.pbrMode!==X.Schematic)if(B.pbrMode!==X.Disabled){if(B.pbrMode===X.Normal){H.code.add(C.H`vec3 mrr;
vec3 emission;
float occlusion;`);const L=B.supportsTextureAtlas?B.hasWebGL2Context?R.D.None:R.D.Size:R.D.None,j=B.pbrTextureBindType;B.hasMetallicRoughnessTexture&&(H.uniforms.add(j===F.P.Pass?(0,I.J)("texMetallicRoughness",U=>U.textureMetallicRoughness,L):(0,M.F)("texMetallicRoughness",U=>U.textureMetallicRoughness,L)),H.code.add(C.H`void applyMetallnessAndRoughness(TextureLookupParameter params) {
vec3 metallicRoughness = textureLookup(texMetallicRoughness, params).rgb;
mrr[0] *= metallicRoughness.b;
mrr[1] *= metallicRoughness.g;
}`)),B.hasEmissionTexture&&(H.uniforms.add(j===F.P.Pass?(0,I.J)("texEmission",U=>U.textureEmissive,L):(0,M.F)("texEmission",U=>U.textureEmissive,L)),H.code.add(C.H`void applyEmission(TextureLookupParameter params) {
emission *= textureLookup(texEmission, params).rgb;
}`)),B.hasOcclusionTexture?(H.uniforms.add(j===F.P.Pass?(0,I.J)("texOcclusion",U=>U.textureOcclusion,L):(0,M.F)("texOcclusion",U=>U.textureOcclusion,L)),H.code.add(C.H`void applyOcclusion(TextureLookupParameter params) {
occlusion *= textureLookup(texOcclusion, params).r;
}
float getBakedOcclusion() {
return occlusion;
}`)):H.code.add(C.H`float getBakedOcclusion() { return 1.0; }`),H.uniforms.add(j===F.P.Pass?[new b.J("emissionFactor",U=>U.emissiveFactor),new b.J("mrrFactors",U=>U.mrrFactors)]:[new x.B("emissionFactor",U=>U.emissiveFactor),new x.B("mrrFactors",U=>U.mrrFactors)]),H.code.add(C.H`
    void applyPBRFactors() {
      mrr = mrrFactors;
      emission = emissionFactor;
      occlusion = 1.0;
      ${D?C.H`vtc.uv = vuv0;`:""}
      ${B.hasMetallicRoughnessTextureTransform?C.H`vtc.uv = metallicRoughnessUV;`:""}
      ${B.hasMetallicRoughnessTexture?B.supportsTextureAtlas?C.H`
                vtc.size = ${(0,O.w_)(B,"texMetallicRoughness")};
                applyMetallnessAndRoughness(vtc);`:C.H`applyMetallnessAndRoughness(vtc);`:""}
      ${B.hasEmissiveTextureTransform?C.H`vtc.uv = emissiveUV;`:""}
      ${B.hasEmissionTexture?B.supportsTextureAtlas?C.H`
                vtc.size = ${(0,O.w_)(B,"texEmission")};
                applyEmission(vtc);`:C.H`applyEmission(vtc);`:""}
      ${B.hasOcclusionTextureTransform?C.H`vtc.uv = occlusionUV;`:""}
      ${B.hasOcclusionTexture?B.supportsTextureAtlas?C.H`
                vtc.size = ${(0,O.w_)(B,"texOcclusion")};
                applyOcclusion(vtc);`:C.H`applyOcclusion(vtc);`:""}
    }
  `)}}else H.code.add(C.H`float getBakedOcclusion() { return 1.0; }`);else H.code.add(C.H`vec3 mrr = vec3(0.0, 0.6, 0.2);
vec3 emission = vec3(0.0);
float occlusion = 1.0;
void applyPBRFactors() {}
float getBakedOcclusion() { return 1.0; }`)}d(33470),(0,v.f)(0,.6,.2),(ee=X||(X={}))[ee.Disabled=0]="Disabled",ee[ee.Normal=1]="Normal",ee[ee.Schematic=2]="Schematic",ee[ee.Water=3]="Water",ee[ee.WaterOnIntegratedMesh=4]="WaterOnIntegratedMesh",ee[ee.Terrain=5]="Terrain",ee[ee.TerrainWithWater=6]="TerrainWithWater",ee[ee.COUNT=7]="COUNT"},39337:(ue,G,d)=>{d.d(G,{e:()=>h});var v=d(17625);function h(O){O.vertex.code.add(v.H`const float PI = 3.141592653589793;`),O.fragment.code.add(v.H`const float PI = 3.141592653589793;
const float LIGHT_NORMALIZATION = 1.0 / PI;
const float INV_PI = 0.3183098861837907;
const float HALF_PI = 1.570796326794897;`)}},72968:(ue,G,d)=>{d.d(G,{XE:()=>ae,hb:()=>Q}),d(28093);var h=d(19278),O=d(43177),x=d(69960),b=d(18952),C=d(17625),M=d(85930),I=d(37847);class R extends M.x{constructor(H,D,L){super(H,"mat4",I.P.Draw,(j,U,y)=>j.setUniformMatrix4fv(H,D(U,y)),L)}}class F extends M.x{constructor(H,D,L){super(H,"mat4",I.P.Pass,(j,U,y)=>j.setUniformMatrix4fv(H,D(U,y)),L)}}var Z=d(35387),z=d(19755);function Q(B,H){H.receiveShadows&&(B.fragment.uniforms.add(new F("shadowMapMatrix",(D,L)=>L.shadowMap.getShadowMapMatrices(D.origin),4)),ee(B,H))}function ae(B,H){H.receiveShadows&&(B.fragment.uniforms.add(new R("shadowMapMatrix",(D,L)=>L.shadowMap.getShadowMapMatrices(D.origin),4)),ee(B,H))}function ee(B,H){const D=B.fragment;D.include(h.n),D.uniforms.add([...(0,Z.J)("shadowMapTex",(L,j)=>j.shadowMap.depthTexture,H.hasWebGL2Context?z.D.None:z.D.Size),new b._("numCascades",(L,j)=>j.shadowMap.numCascades),new x.N("cascadeDistances",(L,j)=>j.shadowMap.cascadeDistances)]),D.code.add(C.H`
    int chooseCascade(float depth, out mat4 mat) {
      vec4 distance = cascadeDistances;

      // choose correct cascade
      int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;

      mat = i == 0 ? shadowMapMatrix[0] : i == 1 ? shadowMapMatrix[1] : i == 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];

      return i;
    }

    vec3 lightSpacePosition(vec3 _vpos, mat4 mat) {
      vec4 lv = mat * vec4(_vpos, 1.0);
      lv.xy /= lv.w;
      return 0.5 * lv.xyz + vec3(0.5);
    }

    vec2 cascadeCoordinates(int i, vec3 lvpos) {
      return vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;
    }

    float readShadowMapDepth(vec2 uv, sampler2D _depthTex) {
      return rgba2float(texture2D(_depthTex, uv));
    }

    float posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {
      return readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;
    }

    float filterShadow(vec2 uv, vec3 lvpos, float textureSize, sampler2D _depthTex) {
      float halfPixelSize = 0.5 / textureSize;

      // filter, offset by half pixels
      vec2 st = fract((vec2(halfPixelSize) + uv) * textureSize);

      float s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);
      float s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);
      float s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);
      float s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);

      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);
    }

    float readShadowMap(const in vec3 _vpos, float _linearDepth) {
      mat4 mat;
      int i = chooseCascade(_linearDepth, mat);

      if (i >= numCascades) { return 0.0; }

      vec3 lvpos = lightSpacePosition(_vpos, mat);

      // vertex completely outside? -> no shadow
      if (lvpos.z >= 1.0) { return 0.0; }
      if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }

      // calc coord in cascade texture
      vec2 uv = cascadeCoordinates(i, lvpos);

      vec2 textureSize = ${(0,O.w_)(H,"shadowMapTex")};

      return filterShadow(uv, lvpos, textureSize.x, shadowMapTex);
    }
  `)}},92836:(ue,G,d)=>{d.d(G,{k:()=>I});var v=d(97139),h=d(48565),O=d(7090),x=d(17625),b=d(91574),C=d(16396),M=d(41857);function I(R,F){F.hasVvInstancing&&(F.vvSize||F.vvColor)&&R.attributes.add(C.T.INSTANCEFEATUREATTRIBUTE,"vec4");const Z=R.vertex;F.vvSize?(Z.uniforms.add(new v.J("vvSizeMinSize",z=>z.vvSizeMinSize)),Z.uniforms.add(new v.J("vvSizeMaxSize",z=>z.vvSizeMaxSize)),Z.uniforms.add(new v.J("vvSizeOffset",z=>z.vvSizeOffset)),Z.uniforms.add(new v.J("vvSizeFactor",z=>z.vvSizeFactor)),Z.uniforms.add(new b.c("vvSymbolRotationMatrix",z=>z.vvSymbolRotationMatrix)),Z.uniforms.add(new v.J("vvSymbolAnchor",z=>z.vvSymbolAnchor)),Z.code.add(x.H`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),Z.code.add(x.H`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${F.hasVvInstancing?x.H`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):Z.code.add(x.H`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),F.vvColor?(Z.constants.add("vvColorNumber","int",M.x),F.hasVvInstancing&&Z.uniforms.add([new O.O("vvColorValues",z=>z.vvColorValues,M.x),new h.b("vvColorColors",z=>z.vvColorColors,M.x)]),Z.code.add(x.H`
      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${F.hasVvInstancing?x.H`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):Z.code.add(x.H`vec4 vvColor() { return vec4(1.0); }`)}},67022:(ue,G,d)=>{d.d(G,{F:()=>v,b:()=>h});const v=.1,h=.001},39832:(ue,G,d)=>{d.d(G,{G:()=>I,R:()=>Z});var v=d(67831),h=d(99770),O=d(993),x=d(4794),b=d(95285),C=d(69960),M=d(17625);function I(X){X.fragment.uniforms.add(new C.N("projInfo",(Q,ae)=>function R(X){const Q=X.camera.projectionMatrix;return 0===Q[11]?(0,O.s)(F,2/(X.camera.fullWidth*Q[0]),2/(X.camera.fullHeight*Q[5]),(1+Q[12])/Q[0],(1+Q[13])/Q[5]):(0,O.s)(F,-2/(X.camera.fullWidth*Q[0]),-2/(X.camera.fullHeight*Q[5]),(1-Q[8])/Q[0],(1-Q[9])/Q[5])}(ae))),X.fragment.uniforms.add(new b.A("zScale",(Q,ae)=>Z(ae))),X.fragment.code.add(M.H`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}const F=(0,x.c)();function Z(X){return 0===X.camera.projectionMatrix[11]?(0,v.s)(z,0,1):(0,v.s)(z,1,0)}const z=(0,h.a)()},33726:(ue,G,d)=>{d.d(G,{Y:()=>h});var v=d(17625);function h(O){O.code.add(v.H`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},7228:(ue,G,d)=>{d.d(G,{$:()=>h});var v=d(17625);function h({code:O},x){O.add(x.doublePrecisionRequiresObfuscation?v.H`vec3 dpPlusFrc(vec3 a, vec3 b) {
return mix(a, a + b, vec3(notEqual(b, vec3(0))));
}
vec3 dpMinusFrc(vec3 a, vec3 b) {
return mix(vec3(0), a - b, vec3(notEqual(a, b)));
}
vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = dpPlusFrc(hiA, hiB);
vec3 e = dpMinusFrc(t1, hiA);
vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
return t1 + t2;
}`:v.H`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = hiA + hiB;
vec3 e = t1 - hiA;
vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
return t1 + t2;
}`)}},19278:(ue,G,d)=>{d.d(G,{n:()=>h});var v=d(17625);function h(O){O.code.add(v.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)}},71850:(ue,G,d)=>{d.d(G,{cK:()=>b,m8:()=>M,ww:()=>C});var v=d(993),h=d(4794),O=d(69960),x=d(17625);function b(F){F.vertex.code.add(x.H`float screenSizePerspectiveMinSize(float size, vec4 factor) {
float nonZeroSize = 1.0 - step(size, 0.0);
return (
factor.z * (
1.0 +
nonZeroSize *
2.0 * factor.w / (
size + (1.0 - nonZeroSize)
)
)
);
}`),F.vertex.code.add(x.H`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),F.vertex.code.add(x.H`vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
return vec4(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z,
params.w
);
}`),F.vertex.code.add(x.H`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
}`),F.vertex.code.add(x.H`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),F.vertex.code.add(x.H`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / max(1e-5, size.y), 1.0), size, factor.y);
}`),F.vertex.code.add(x.H`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function C(F){F.uniforms.add(new O.N("screenSizePerspective",Z=>I(Z.screenSizePerspective)))}function M(F){F.uniforms.add(new O.N("screenSizePerspectiveAlignment",Z=>I(Z.screenSizePerspectiveAlignment||Z.screenSizePerspective)))}function I(F){return(0,v.s)(R,F.parameters.divisor,F.parameters.offset,F.parameters.minPixelSize,F.paddingPixelsOverride)}const R=(0,h.c)()},99198:(ue,G,d)=>{d.d(G,{hY:()=>Z,Sv:()=>z,_8:()=>ae});var v=d(28347),h=d(55494),O=d(84161),x=d(28093),b=d(77739),C=d(97139),M=d(85930),I=d(37847);class R extends M.x{constructor(B,H){super(B,"mat4",I.P.Draw,(D,L,j)=>D.setUniformMatrix4fv(B,H(L,j)))}}var F=d(63123);function Z(ee,B){B.instancedDoublePrecision?ee.constants.add("cameraPosition","vec3",x.Z):ee.uniforms.add(new b.B("cameraPosition",(H,D)=>(0,O.s)(Q,D.camera.viewInverseTransposeMatrix[3]-H.origin[0],D.camera.viewInverseTransposeMatrix[7]-H.origin[1],D.camera.viewInverseTransposeMatrix[11]-H.origin[2])))}function z(ee,B){if(!B.instancedDoublePrecision)return void ee.uniforms.add([new F.g("proj",(D,L)=>L.camera.projectionMatrix),new R("view",(D,L)=>(0,v.w)(X,L.camera.viewMatrix,D.origin)),new b.B("localOrigin",D=>D.origin)]);const H=D=>(0,O.s)(Q,D.camera.viewInverseTransposeMatrix[3],D.camera.viewInverseTransposeMatrix[7],D.camera.viewInverseTransposeMatrix[11]);ee.uniforms.add([new F.g("proj",(D,L)=>L.camera.projectionMatrix),new F.g("view",(D,L)=>(0,v.w)(X,L.camera.viewMatrix,H(L))),new C.J("localOrigin",(D,L)=>H(L))])}const X=(0,h.c)(),Q=(0,x.c)();function ae(ee){ee.uniforms.add(new F.g("viewNormal",(B,H)=>H.camera.viewInverseTransposeMatrix))}},43177:(ue,G,d)=>{d.d(G,{aU:()=>O,b6:()=>b,o_:()=>h,w_:()=>x});var v=d(17625);const h="Size",O="InvSize";function x(C,M,I=!1,R=0){if(C.hasWebGL2Context){const F=v.H`vec2(textureSize(${M}, ${v.H.int(R)}))`;return I?"(1.0 / "+F+")":F}return I?M+O:M+h}function b(C,M,I,R=null,F=0){if(C.hasWebGL2Context)return v.H`texelFetch(${M}, ivec2(${I}), ${v.H.int(F)})`;let Z=v.H`texture2D(${M}, ${I} * `;return Z+=R?v.H`(${R}))`:v.H`${M+O})`,Z}},78038:(ue,G,d)=>{d.d(G,{U:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"bool",h.P.Pass,(M,I,R)=>M.setUniform1b(b,C(I,R)))}}},32181:(ue,G,d)=>{d.d(G,{q:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"vec2",h.P.Draw,(M,I,R,F)=>M.setUniform2fv(b,C(I,R,F)))}}},95285:(ue,G,d)=>{d.d(G,{A:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"vec2",h.P.Pass,(M,I,R)=>M.setUniform2fv(b,C(I,R)))}}},77739:(ue,G,d)=>{d.d(G,{B:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"vec3",h.P.Draw,(M,I,R,F)=>M.setUniform3fv(b,C(I,R,F)))}}},97139:(ue,G,d)=>{d.d(G,{J:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"vec3",h.P.Pass,(M,I,R)=>M.setUniform3fv(b,C(I,R)))}}},69960:(ue,G,d)=>{d.d(G,{N:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"vec4",h.P.Pass,(M,I,R)=>M.setUniform4fv(b,C(I,R)))}}},48565:(ue,G,d)=>{d.d(G,{b:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C,M){super(b,"vec4",h.P.Pass,(I,R,F)=>I.setUniform4fv(b,C(R,F)),M)}}},65787:(ue,G,d)=>{d.d(G,{p:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"float",h.P.Pass,(M,I,R)=>M.setUniform1f(b,C(I,R)))}}},7090:(ue,G,d)=>{d.d(G,{O:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C,M){super(b,"float",h.P.Pass,(I,R,F)=>I.setUniform1fv(b,C(R,F)),M)}}},18952:(ue,G,d)=>{d.d(G,{_:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"int",h.P.Pass,(M,I,R)=>M.setUniform1i(b,C(I,R)))}}},9546:(ue,G,d)=>{d.d(G,{j:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"mat3",h.P.Draw,(M,I,R)=>M.setUniformMatrix3fv(b,C(I,R)))}}},91574:(ue,G,d)=>{d.d(G,{c:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"mat3",h.P.Pass,(M,I,R)=>M.setUniformMatrix3fv(b,C(I,R)))}}},63123:(ue,G,d)=>{d.d(G,{g:()=>O});var v=d(85930),h=d(37847);class O extends v.x{constructor(b,C){super(b,"mat4",h.P.Pass,(M,I,R)=>M.setUniformMatrix4fv(b,C(I,R)))}}},22355:(ue,G,d)=>{d.d(G,{kG:()=>C});var v=d(26584),h=d(63290),O=d(62208);const x=h.Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class b{constructor(){this._includedModules=new Map}include(B,H){if(this._includedModules.has(B)){const D=this._includedModules.get(B);if(D!==H){x.error("Trying to include shader module multiple times with different sets of options.");const L=new Set;for(const j of Object.keys(D))D[j]!==B[j]&&L.add(j);for(const j of Object.keys(B))D[j]!==B[j]&&L.add(j);L.forEach(j=>console.error(`  ${j}: current ${D[j]} new ${B[j]}`))}}else this._includedModules.set(B,H),B(this.builder,H)}}class C extends b{constructor(){super(...arguments),this.vertex=new R,this.fragment=new R,this.attributes=new F,this.varyings=new Z,this.extensions=new z,this.constants=new X}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(B){const H=this.extensions.generateSource(B),D=this.attributes.generateSource(B),L=this.varyings.generateSource(),j="vertex"===B?this.vertex:this.fragment,U=j.uniforms.generateSource(),y=j.code.generateSource(),K="vertex"===B?ae:Q,Y=this.constants.generateSource().concat(j.constants.generateSource());return`\n${H.join("\n")}\n\n${K}\n\n${Y.join("\n")}\n\n${U.join("\n")}\n\n${D.join("\n")}\n\n${L.join("\n")}\n\n${y.join("\n")}`}generateBind(B,H){const D=new Map;this.vertex.uniforms.entries.forEach(U=>{const y=U.bind[B];(0,O.pC)(y)&&D.set(U.name,y)}),this.fragment.uniforms.entries.forEach(U=>{const y=U.bind[B];(0,O.pC)(y)&&D.set(U.name,y)});const L=Array.from(D.values()),j=L.length;return(U,y,K)=>{for(let Y=0;Y<j;++Y)L[Y](H,U,y,K)}}}class M{constructor(){this._entries=new Map}add(B){if(!Array.isArray(B))return this._add(B);for(const H of B)this._add(H)}get(B){return this._entries.get(B)}_add(B){if((0,O.Wi)(B))x.error(`Trying to add null Uniform from ${(new Error).stack}.`);else{if(this._entries.has(B.name)&&!this._entries.get(B.name).equals(B))throw new v.Z(`Duplicate uniform name ${B.name} for different uniform type`);this._entries.set(B.name,B)}}generateSource(){return Array.from(this._entries.values()).map(B=>(0,O.pC)(B.arraySize)?`uniform ${B.type} ${B.name}[${B.arraySize}];`:`uniform ${B.type} ${B.name};`)}get entries(){return Array.from(this._entries.values())}}class I{constructor(){this._entries=new Array}add(B){this._entries.push(B)}generateSource(){return this._entries}}class R extends b{constructor(){super(...arguments),this.uniforms=new M,this.code=new I,this.constants=new X}get builder(){return this}}class F{constructor(){this._entries=new Array}add(B,H){this._entries.push([B,H])}generateSource(B){return"fragment"===B?[]:this._entries.map(H=>`attribute ${H[1]} ${H[0]};`)}}class Z{constructor(){this._entries=new Array}add(B,H){this._entries.push([B,H])}generateSource(){return this._entries.map(B=>`varying ${B[1]} ${B[0]};`)}}class z{constructor(){this._entries=new Set}add(B){this._entries.add(B)}generateSource(B){const H="vertex"===B?z.ALLOWLIST_VERTEX:z.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(D=>H.includes(D)).map(D=>`#extension ${D} : enable`)}}z.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],z.ALLOWLIST_VERTEX=[];class X{constructor(){this._entries=new Set}add(B,H,D){let L="ERROR_CONSTRUCTOR_STRING";switch(H){case"float":L=X._numberToFloatStr(D);break;case"int":L=X._numberToIntStr(D);break;case"bool":L=D.toString();break;case"vec2":L=`vec2(${X._numberToFloatStr(D[0])},                            ${X._numberToFloatStr(D[1])})`;break;case"vec3":L=`vec3(${X._numberToFloatStr(D[0])},                            ${X._numberToFloatStr(D[1])},                            ${X._numberToFloatStr(D[2])})`;break;case"vec4":L=`vec4(${X._numberToFloatStr(D[0])},                            ${X._numberToFloatStr(D[1])},                            ${X._numberToFloatStr(D[2])},                            ${X._numberToFloatStr(D[3])})`;break;case"ivec2":L=`ivec2(${X._numberToIntStr(D[0])},                             ${X._numberToIntStr(D[1])})`;break;case"ivec3":L=`ivec3(${X._numberToIntStr(D[0])},                             ${X._numberToIntStr(D[1])},                             ${X._numberToIntStr(D[2])})`;break;case"ivec4":L=`ivec4(${X._numberToIntStr(D[0])},                             ${X._numberToIntStr(D[1])},                             ${X._numberToIntStr(D[2])},                             ${X._numberToIntStr(D[3])})`;break;case"mat2":case"mat3":case"mat4":L=`${H}(${Array.prototype.map.call(D,j=>X._numberToFloatStr(j)).join(", ")})`}return this._entries.add(`const ${H} ${B} = ${L};`),this}static _numberToIntStr(B){return B.toFixed(0)}static _numberToFloatStr(B){return Number.isInteger(B)?B.toFixed(1):B.toString()}generateSource(){return Array.from(this._entries)}}const Q="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",ae="precision highp float;\nprecision highp sampler2D;"},5864:(ue,G,d)=>{d.d(G,{F:()=>F,R:()=>R});var v=d(62208),h=d(67831),O=d(99770),x=d(43177),b=d(32181),C=d(19755),M=d(85930),I=d(37847);class R extends M.x{constructor(X,Q){super(X,"sampler2D",I.P.Draw,(ae,ee,B)=>ae.bindTexture(X,Q(ee,B)))}}function F(z,X,Q=C.D.None){const ae=[new R(z,X)];return Q&C.D.Size&&ae.push(new b.q(z+x.o_,(B,H)=>{const D=X(B,H);return(0,v.pC)(D)?(0,h.s)(Z,D.descriptor.width,D.descriptor.height):O.Z})),Q&C.D.InvSize&&ae.push(new b.q(z+x.aU,(B,H)=>{const D=X(B,H);return(0,v.pC)(D)?(0,h.s)(Z,1/D.descriptor.width,1/D.descriptor.height):O.Z})),ae}const Z=(0,O.a)()},35387:(ue,G,d)=>{d.d(G,{A:()=>R,J:()=>F});var v=d(62208),h=d(67831),O=d(99770),x=d(43177),b=d(95285),C=d(19755),M=d(85930),I=d(37847);class R extends M.x{constructor(X,Q){super(X,"sampler2D",I.P.Pass,(ae,ee,B)=>ae.bindTexture(X,Q(ee,B)))}}function F(z,X,Q=C.D.None){const ae=[new R(z,X)];return Q&C.D.Size&&ae.push(new b.A(z+x.o_,(B,H)=>{const D=X(B,H);return(0,v.pC)(D)?(0,h.s)(Z,D.descriptor.width,D.descriptor.height):O.Z})),Q&C.D.InvSize&&ae.push(new b.A(z+x.aU,(B,H)=>{const D=X(B,H);return(0,v.pC)(D)?(0,h.s)(Z,1/D.descriptor.width,1/D.descriptor.height):O.Z})),ae}const Z=(0,O.a)()},19755:(ue,G,d)=>{var v,h;d.d(G,{D:()=>v}),(h=v||(v={}))[h.None=0]="None",h[h.Size=1]="Size",h[h.InvSize=2]="InvSize"},85930:(ue,G,d)=>{d.d(G,{x:()=>O});var v=d(62208),h=d(37847);class O{constructor(b,C,M,I,R=null){this.name=b,this.type=C,this.arraySize=R,this.bind={[h.P.Pass]:null,[h.P.Draw]:null},(0,v.pC)(M)&&(0,v.pC)(I)&&(this.bind[M]=I)}equals(b){return this.type===b.type&&this.name===b.name&&this.arraySize===b.arraySize}}},17625:(ue,G,d)=>{d.d(G,{H:()=>O,K:()=>h});const h=class v{};function O(x,...b){let C="";for(let M=0;M<b.length;M++)C+=x[M]+b[M];return C+=x[x.length-1],C}var x;(x=O||(O={})).int=function b(M){return Math.round(M).toString()},x.float=function C(M){return M.toPrecision(8)}},37847:(ue,G,d)=>{var v,h;d.d(G,{P:()=>v}),(h=v||(v={}))[h.Pass=0]="Pass",h[h.Draw=1]="Draw"},651:(ue,G,d)=>{d.d(G,{J:()=>h});var v=d(15861);class h{constructor(x,b){this._module=x,this._loadModule=b}get(){return this._module}reload(){var x=this;return(0,v.Z)(function*(){return x._module=yield x._loadModule(),x._module})()}}},91056:(ue,G,d)=>{d.d(G,{A:()=>O});var v=d(62208),h=d(67969);class O{constructor(b,C,M){this.release=M,this.initializeConfiguration(b,C),this._configuration=C.snapshot(),this._program=this.initializeProgram(b),this._pipeline=this.initializePipeline(b.rctx.capabilities)}destroy(){this._program=(0,v.M2)(this._program),this._pipeline=this._configuration=null}reload(b){(0,v.M2)(this._program),this._program=this.initializeProgram(b),this._pipeline=this.initializePipeline(b.rctx.capabilities)}get program(){return this._program}get compiled(){return this.program.compiled}get key(){return this._configuration.key}get configuration(){return this._configuration}bindPipelineState(b,C=null,M){b.setPipelineState(this.getPipelineState(C,M))}ensureAttributeLocations(b){this.program.assertCompatibleVertexAttributeLocations(b)}get primitiveType(){return h.MX.TRIANGLES}getPipelineState(b,C){return this._pipeline}initializeConfiguration(b,C){}}},87601:(ue,G,d)=>{d.d(G,{m:()=>h,o:()=>O});var v=d(17625);class h extends v.K{constructor(){super(),this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits?this._parameterBits.map(()=>0):[],this._parameterNames||(this._parameterNames=[])}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const b=this._parameterNames,C={key:this.key};for(const M of b)C[M]=this[M];return C}}function O(x={}){return(b,C)=>{if(b._parameterNames=b._parameterNames??[],b._parameterNames.push(C),null!=x.constValue)Object.defineProperty(b,C,{get:()=>x.constValue});else{const M=b._parameterNames.length-1,R=Math.ceil(Math.log2(x.count||2)),F=b._parameterBits??[0];let Z=0;for(;F[Z]+R>16;)Z++,Z>=F.length&&F.push(0);b._parameterBits=F;const z=F[Z],X=(1<<R)-1<<z;F[Z]+=R,Object.defineProperty(b,C,{get(){return this[M]},set(Q){if(this[M]!==Q&&(this[M]=Q,this._keyDirty=!0,this._parameterBits[Z]=this._parameterBits[Z]&~X|+Q<<z&X,"number"!=typeof Q&&"boolean"!=typeof Q))throw new Error("Configuration value for "+C+" must be boolean or number, got "+typeof Q)}})}}}},94255:(ue,G,d)=>{d.d(G,{a:()=>v});class v{constructor(O,x,b=!1,C=x){this.data=O,this.size=x,this.exclusive=b,this.stride=C}}},12699:(ue,G,d)=>{d.d(G,{c:()=>h});var v=d(86236);class h{constructor(){this.id=(0,v.D)()}unload(){}}},24425:(ue,G,d)=>{var v,h;d.d(G,{U:()=>v}),(h=v||(v={}))[h.Layer=0]="Layer",h[h.Object=1]="Object",h[h.Mesh=2]="Mesh",h[h.Line=3]="Line",h[h.Point=4]="Point",h[h.Material=5]="Material",h[h.Texture=6]="Texture",h[h.COUNT=7]="COUNT"},39114:(ue,G,d)=>{d.d(G,{i:()=>h});var v=d(16396);const h=new Map([[v.T.POSITION,0],[v.T.NORMAL,1],[v.T.UV0,2],[v.T.COLOR,3],[v.T.SIZE,4],[v.T.TANGENT,4],[v.T.AUXPOS1,5],[v.T.SYMBOLCOLOR,5],[v.T.AUXPOS2,6],[v.T.FEATUREATTRIBUTE,6],[v.T.INSTANCEFEATUREATTRIBUTE,6],[v.T.INSTANCECOLOR,7],[v.T.OBJECTANDLAYERIDCOLOR,7],[v.T.OBJECTANDLAYERIDCOLOR_INSTANCED,7],[v.T.MODEL,8],[v.T.MODELNORMAL,12],[v.T.MODELORIGINHI,11],[v.T.MODELORIGINLO,15]])},60881:(ue,G,d)=>{d.d(G,{Z:()=>h});var v=d(42743);class h{constructor(x){this._material=x.material,this._techniqueRepository=x.techniqueRep,this._output=x.output}dispose(){this._techniqueRepository.release(this._technique)}get technique(){return this._technique}get _stippleTextureRepository(){return this._techniqueRepository.constructionContext.stippleTextureRepository}ensureTechnique(x,b){return this._technique=this._techniqueRepository.releaseAndAcquire(x,this._material.getConfiguration(this._output,b),this._technique),this._technique}ensureResources(x){return v.Rw.LOADED}}},33470:(ue,G,d)=>{d.d(G,{E:()=>M,F:()=>C});var v=d(62208),h=d(10699),O=d(17625),x=d(42743),b=d(60881);class C extends b.Z{constructor(R){super(R),this._numLoading=0,this._disposed=!1,this._textureRepository=R.textureRep,this._textureId=R.textureId,this._acquire(R.textureId,F=>this._texture=F),this._acquire(R.normalTextureId,F=>this._textureNormal=F),this._acquire(R.emissiveTextureId,F=>this._textureEmissive=F),this._acquire(R.occlusionTextureId,F=>this._textureOcclusion=F),this._acquire(R.metallicRoughnessTextureId,F=>this._textureMetallicRoughness=F)}dispose(){this._texture=(0,v.RY)(this._texture),this._textureNormal=(0,v.RY)(this._textureNormal),this._textureEmissive=(0,v.RY)(this._textureEmissive),this._textureOcclusion=(0,v.RY)(this._textureOcclusion),this._textureMetallicRoughness=(0,v.RY)(this._textureMetallicRoughness),this._disposed=!0}ensureResources(R){return 0===this._numLoading?x.Rw.LOADED:x.Rw.LOADING}get textureBindParameters(){return new M((0,v.pC)(this._texture)?this._texture.glTexture:null,(0,v.pC)(this._textureNormal)?this._textureNormal.glTexture:null,(0,v.pC)(this._textureEmissive)?this._textureEmissive.glTexture:null,(0,v.pC)(this._textureOcclusion)?this._textureOcclusion.glTexture:null,(0,v.pC)(this._textureMetallicRoughness)?this._textureMetallicRoughness.glTexture:null)}updateTexture(R){((0,v.Wi)(this._texture)||R!==this._texture.id)&&(this._texture=(0,v.RY)(this._texture),this._textureId=R,this._acquire(this._textureId,F=>this._texture=F))}_acquire(R,F){if((0,v.Wi)(R))return void F(null);const Z=this._textureRepository.acquire(R);if((0,h.y8)(Z))return++this._numLoading,void Z.then(z=>{if(this._disposed)return(0,v.RY)(z),void F(null);F(z)}).finally(()=>--this._numLoading);F(Z)}}class M extends O.K{constructor(R=null,F=null,Z=null,z=null,X=null){super(),this.texture=R,this.textureNormal=F,this.textureEmissive=Z,this.textureOcclusion=z,this.textureMetallicRoughness=X}}},44968:(ue,G,d)=>{d.d(G,{Z:()=>re});var v=d(62208),h=d(43703),O=d(84161),x=d(55713);function b(A){if(A.length<x.DB)return Array.from(A);if(Array.isArray(A))return Float64Array.from(A);switch(A.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(A);case 2:return Uint16Array.from(A);case 4:return Float32Array.from(A);default:return Float64Array.from(A)}}var C=d(42743),M=d(77029),I=d(28093),R=d(2282);class F{constructor(S,w,W,N){this.primitiveIndices=S,this._numIndexPerPrimitive=w,this.indices=W,this.position=N,this._children=void 0,(0,R.hu)(S.length>=1),(0,R.hu)(W.length%this._numIndexPerPrimitive==0),(0,R.hu)(W.length>=S.length*this._numIndexPerPrimitive),(0,R.hu)(3===N.size||4===N.size);const{data:k,size:de}=N,he=S.length;let ne=de*W[this._numIndexPerPrimitive*S[0]];Z.clear(),Z.push(ne);const le=(0,I.f)(k[ne],k[ne+1],k[ne+2]),me=(0,I.a)(le);for(let ve=0;ve<he;++ve){const Te=this._numIndexPerPrimitive*S[ve];for(let Me=0;Me<this._numIndexPerPrimitive;++Me){ne=de*W[Te+Me],Z.push(ne);let Ee=k[ne];le[0]=Math.min(Ee,le[0]),me[0]=Math.max(Ee,me[0]),Ee=k[ne+1],le[1]=Math.min(Ee,le[1]),me[1]=Math.max(Ee,me[1]),Ee=k[ne+2],le[2]=Math.min(Ee,le[2]),me[2]=Math.max(Ee,me[2])}}this.bbMin=le,this.bbMax=me;const J=(0,O.h)((0,I.c)(),this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(me[0]-le[0],me[1]-le[1]),me[2]-le[2]);let oe=this.radius*this.radius;for(let ve=0;ve<Z.length;++ve){ne=Z.getItemAt(ve);const Te=k[ne]-J[0],Me=k[ne+1]-J[1],Ee=k[ne+2]-J[2],$=Te*Te+Me*Me+Ee*Ee;if($<=oe)continue;const te=Math.sqrt($),pe=.5*(te-this.radius);this.radius=this.radius+pe,oe=this.radius*this.radius;const fe=pe/te;J[0]+=Te*fe,J[1]+=Me*fe,J[2]+=Ee*fe}this.center=J,Z.clear()}getChildren(){if(this._children||(0,O.d)(this.bbMin,this.bbMax)<=1)return this._children;const S=(0,O.h)((0,I.c)(),this.bbMin,this.bbMax,.5),w=this.primitiveIndices.length,W=new Uint8Array(w),N=new Array(8);for(let le=0;le<8;++le)N[le]=0;const{data:k,size:de}=this.position;for(let le=0;le<w;++le){let me=0;const J=this._numIndexPerPrimitive*this.primitiveIndices[le];let oe=de*this.indices[J],ve=k[oe],Te=k[oe+1],Me=k[oe+2];for(let Ee=1;Ee<this._numIndexPerPrimitive;++Ee){oe=de*this.indices[J+Ee];const $=k[oe],te=k[oe+1],pe=k[oe+2];$<ve&&(ve=$),te<Te&&(Te=te),pe<Me&&(Me=pe)}ve<S[0]&&(me|=1),Te<S[1]&&(me|=2),Me<S[2]&&(me|=4),W[le]=me,++N[me]}let he=0;for(let le=0;le<8;++le)N[le]>0&&++he;if(he<2)return;const ne=new Array(8);for(let le=0;le<8;++le)ne[le]=N[le]>0?new Uint32Array(N[le]):void 0;for(let le=0;le<8;++le)N[le]=0;for(let le=0;le<w;++le){const me=W[le];ne[me][N[me]++]=this.primitiveIndices[le]}this._children=new Array;for(let le=0;le<8;++le)void 0!==ne[le]&&this._children.push(new F(ne[le],this._numIndexPerPrimitive,this.indices,this.position));return this._children}static prune(){Z.prune()}}const Z=new M.Z({deallocator:null});var z=d(12699),X=d(24425),Q=d(11544);const H=(0,I.c)(),D=(0,I.c)(),L=(0,I.c)(),j=(0,I.c)();var U=d(37187),y=d(7167),K=d(16396),Y=d(65073);class re extends z.c{constructor(S,w,W=[],N=null,k=X.U.Mesh,de=null,he=-1){super(),this.material=S,this.mapPositions=N,this.type=k,this.objectAndLayerIdColor=de,this.edgeIndicesLength=he,this.visible=!0,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[ne,le]of w)le&&this._vertexAttributes.set(ne,{...le});if(null==W||0===W.length){const ne=function ie(A){const S=A.values().next().value;return null==S?0:S.data.length/S.size}(this._vertexAttributes),le=(0,U.p)(ne);this.edgeIndicesLength=this.edgeIndicesLength<0?ne:this.edgeIndicesLength;for(const me of this._vertexAttributes.keys())this._indices.set(me,le)}else for(const[ne,le]of W)le&&(this._indices.set(ne,(0,U.mi)(le)),ne===K.T.POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(ne).length:this.edgeIndicesLength))}instantiate(S={}){const w=new re(S.material||this.material,[],void 0,this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);return this._vertexAttributes.forEach((W,N)=>{W.exclusive=!1,w._vertexAttributes.set(N,W)}),this._indices.forEach((W,N)=>w._indices.set(N,W)),w._boundingInfo=this._boundingInfo,w.transformation=S.transformation||this.transformation,w}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(S){let w=this._vertexAttributes.get(S);return w&&!w.exclusive&&(w={...w,exclusive:!0,data:b(w.data)},this._vertexAttributes.set(S,w)),w}get indices(){return this._indices}get indexCount(){const S=this._indices.values().next().value;return S?S.length:0}get faceCount(){return this.indexCount/3}get boundingInfo(){return(0,v.Wi)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(S){return!!(this.type===X.U.Mesh?this._computeAttachmentOriginTriangles(S):this.type===X.U.Line?this._computeAttachmentOriginLines(S):this._computeAttachmentOriginPoints(S))&&((0,v.pC)(this._transformation)&&(0,O.m)(S,S,this._transformation),!0)}_computeAttachmentOriginTriangles(S){const w=this.indices.get(K.T.POSITION);return function ae(A,S,w){if(!A||!S)return!1;const{size:W,data:N}=A;(0,O.s)(w,0,0,0),(0,O.s)(j,0,0,0);let k=0,de=0;for(let he=0;he<S.length-2;he+=3){const ne=S[he+0]*W,le=S[he+1]*W,me=S[he+2]*W;(0,O.s)(H,N[ne+0],N[ne+1],N[ne+2]),(0,O.s)(D,N[le+0],N[le+1],N[le+2]),(0,O.s)(L,N[me+0],N[me+1],N[me+2]);const J=(0,Q.bE)(H,D,L);J?((0,O.a)(H,H,D),(0,O.a)(H,H,L),(0,O.g)(H,H,1/3*J),(0,O.a)(w,w,H),k+=J):((0,O.a)(j,j,H),(0,O.a)(j,j,D),(0,O.a)(j,j,L),de+=3)}return!(0===de&&0===k||(0!==k?((0,O.g)(w,w,1/k),0):0===de||((0,O.g)(w,j,1/de),0)))}(this.vertexAttributes.get(K.T.POSITION),w,S)}_computeAttachmentOriginLines(S){const w=this.vertexAttributes.get(K.T.POSITION),W=this.indices.get(K.T.POSITION);return function B(A,S,w,W){if(!A)return!1;(0,O.s)(W,0,0,0),(0,O.s)(j,0,0,0);let N=0,k=0;const{size:de,data:he}=A,ne=S?S.length-1:he.length/de-1,le=ne+(w?2:0);for(let me=0;me<le;me+=2){const J=me<ne?me:ne,oe=me<ne?me+1:0,ve=(S?S[J]:J)*de,Te=(S?S[oe]:oe)*de;H[0]=he[ve],H[1]=he[ve+1],H[2]=he[ve+2],D[0]=he[Te],D[1]=he[Te+1],D[2]=he[Te+2],(0,O.g)(H,(0,O.a)(H,H,D),.5);const Me=(0,O.j)(H,D);Me>0?((0,O.a)(W,W,(0,O.g)(H,H,Me)),N+=Me):0===N&&((0,O.a)(j,j,H),k++)}return 0!==N?((0,O.g)(W,W,1/N),!0):0!==k&&((0,O.g)(W,j,1/k),!0)}(w,W,W&&function V(A,S,w){return!(!("isClosed"in A)||!A.isClosed)&&(w?w.length>2:S.data.length>6)}(this.material.parameters,w,W),S)}_computeAttachmentOriginPoints(S){const w=this.indices.get(K.T.POSITION);return function ee(A,S,w){if(!A||!S)return!1;const{size:W,data:N}=A;(0,O.s)(w,0,0,0);let k=-1,de=0;for(let he=0;he<S.length;he++){const ne=S[he]*W;k!==ne&&(w[0]+=N[ne+0],w[1]+=N[ne+1],w[2]+=N[ne+2],de++),k=ne}return de>1&&(0,O.g)(w,w,1/de),de>0}(this.vertexAttributes.get(K.T.POSITION),w,S)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const S=this.indices.get(K.T.POSITION),w=this.vertexAttributes.get(K.T.POSITION);if(!S||0===S.length||!w)return null;const W=this.type===X.U.Mesh?3:1;(0,R.hu)(S.length%W==0,"Indexing error: "+S.length+" not divisible by "+W);const N=(0,U.p)(S.length/W);return new F(N,W,S,w)}get transformation(){return(0,v.Pt)(this._transformation,h.I)}set transformation(S){this._transformation=S&&S!==h.I?(0,h.b)(S):null}get shaderTransformation(){return(0,v.pC)(this._shaderTransformer)?this._shaderTransformer(this.transformation):this.transformation}get shaderTransformer(){return this._shaderTransformer}set shaderTransformer(S){this._shaderTransformer=S}get hasVolatileTransformation(){return(0,v.pC)(this._shaderTransformer)}addHighlight(){const S=new y.O(C.V_.Highlight);return this.highlights=(0,Y.lr)(this.highlights,S),S}removeHighlight(S){this.highlights=(0,Y.U_)(this.highlights,S)}}},37187:(ue,G,d)=>{d.d(G,{$z:()=>O,DX:()=>I,mi:()=>h,p:()=>M});var v=d(55713);function h(R){if(Array.isArray(R)){if(R.length<v.DB)return R;for(const F of R)if(F>=65536)return new Uint32Array(R);return new Uint16Array(R)}if(R.length<v.DB)return Array.from(R);if(R.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return R;for(const F of R)if(F>=65536)return R;return new Uint16Array(R)}function O(R){const F=3*R;return F<=v.DB?new Array(F):F<=65536?new Uint16Array(F):new Uint32Array(F)}let x=(()=>{const R=new Uint32Array(131072);for(let F=0;F<R.length;++F)R[F]=F;return R})();const b=[0],C=(()=>{const R=new Uint16Array(65536);for(let F=0;F<R.length;++F)R[F]=F;return R})();function M(R){if(1===R)return b;if(R<v.DB)return Array.from(new Uint16Array(C.buffer,0,R));if(R<C.length)return new Uint16Array(C.buffer,0,R);if(R>x.length){const F=Math.max(2*x.length,R);x=new Uint32Array(F);for(let Z=0;Z<x.length;Z++)x[Z]=Z}return new Uint32Array(x.buffer,0,R)}function I(R){if(1===R)return b;if(R<v.DB)return Array.from(new Uint16Array(C.buffer,0,R));if(R<C.length)return new Uint16Array(C.slice(0,R));if(R>x.length){const F=new Uint32Array(R);for(let Z=0;Z<F.length;Z++)F[Z]=Z;return F}return new Uint32Array(x.slice(0,R))}},40723:(ue,G,d)=>{d.d(G,{F5:()=>I,Mt:()=>Z,yD:()=>F});var F,z,v=d(62208),h=d(28093),O=d(17625),x=d(12699),b=d(24425),C=d(39114),M=d(57623);class I extends x.c{constructor(X,Q){super(),this.type=b.U.Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=C.i,this._pp0=(0,h.f)(0,0,1),this._pp1=(0,h.f)(0,0,0),this._parameters=(0,M.Uf)(X,Q),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(X){return!1}setParameters(X,Q=!0){(0,M.LO)(this._parameters,X)&&(this.validateParameters(this._parameters),Q&&this.parametersChanged())}validateParameters(X){}get visible(){return this._visible}set visible(X){X!==this._visible&&(this._visible=X,this.parametersChanged())}shouldRender(X){return this.isVisible()&&this.isVisibleForOutput(X.output)&&0!=(this.renderOccluded&X.renderOccludedMask)}isVisibleForOutput(X){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(X){X!==this._renderPriority&&(this._renderPriority=X,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(X){X!==this._insertOrder&&(this._insertOrder=X,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){(0,v.pC)(this.repository)&&this.repository.materialChanged(this)}intersectDraped(X,Q,ae,ee,B,H){return this._pp0[0]=this._pp1[0]=ee[0],this._pp0[1]=this._pp1[1]=ee[1],this.intersect(X,Q,ae,this._pp0,this._pp1,B)}}(z=F||(F={}))[z.Occlude=1]="Occlude",z[z.Transparent=2]="Transparent",z[z.OccludeAndTransparent=4]="OccludeAndTransparent",z[z.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",z[z.Opaque=16]="Opaque";class Z extends O.K{constructor(){super(...arguments),this.renderOccluded=F.Occlude}}},7167:(ue,G,d)=>{d.d(G,{O:()=>h});var v=d(86236);class h{constructor(x){this.channel=x,this.id=(0,v.D)()}}},88569:(ue,G,d)=>{d.d(G,{Bh:()=>z,E0:()=>F,IB:()=>C,K5:()=>I,j7:()=>M,je:()=>Z,ve:()=>R,wu:()=>x});var v=d(44835),h=d(67969),O=d(2078);const x=(0,O.wK)(h.zi.SRC_ALPHA,h.zi.ONE,h.zi.ONE_MINUS_SRC_ALPHA,h.zi.ONE_MINUS_SRC_ALPHA),b=(0,O.if)(h.zi.ONE,h.zi.ONE),C=(0,O.if)(h.zi.ZERO,h.zi.ONE_MINUS_SRC_ALPHA);function M(X){return X===v.A.FrontFace?null:X===v.A.Alpha?C:b}function I(X){return X===v.A.FrontFace?O.LZ:null}const R=5e5,F={factor:-1,units:-2};function Z(X){return X?F:null}function z(X,Q=h.wb.LESS){return X===v.A.NONE||X===v.A.FrontFace?Q:h.wb.LEQUAL}},12407:(ue,G,d)=>{d.d(G,{$:()=>b});var v=d(62208),h=d(77029),O=d(37847),x=d(81653);class b{constructor(M,I,R){this._context=M,this._locations=R,this._textures=new Map,this._freeTextureUnits=new h.Z({deallocator:null}),this._glProgram=M.programCache.acquire(I.generate("vertex"),I.generate("fragment"),R),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bindPass=I.generateBind(O.P.Pass,this),this.bindDraw=I.generateBind(O.P.Draw,this),this._fragmentUniforms=(0,x.hZ)()?I.fragmentUniforms:null}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get compiled(){return this._glProgram.compiled}setUniform1b(M,I){this._glProgram.setUniform1i(M,I?1:0)}setUniform1i(M,I){this._glProgram.setUniform1i(M,I)}setUniform1f(M,I){this._glProgram.setUniform1f(M,I)}setUniform2fv(M,I){this._glProgram.setUniform2fv(M,I)}setUniform3fv(M,I){this._glProgram.setUniform3fv(M,I)}setUniform4fv(M,I){this._glProgram.setUniform4fv(M,I)}setUniformMatrix3fv(M,I){this._glProgram.setUniformMatrix3fv(M,I)}setUniformMatrix4fv(M,I){this._glProgram.setUniformMatrix4fv(M,I)}setUniform1fv(M,I){this._glProgram.setUniform1fv(M,I)}setUniform1iv(M,I){this._glProgram.setUniform1iv(M,I)}setUniform2iv(M,I){this._glProgram.setUniform3iv(M,I)}setUniform3iv(M,I){this._glProgram.setUniform3iv(M,I)}setUniform4iv(M,I){this._glProgram.setUniform4iv(M,I)}assertCompatibleVertexAttributeLocations(M){M.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(M,I){if((0,v.Wi)(I)||null==I.glName){const F=this._textures.get(M);return F&&(this._context.bindTexture(null,F.unit),this._freeTextureUnit(F),this._textures.delete(M)),null}let R=this._textures.get(M);return null==R?(R=this._allocTextureUnit(I),this._textures.set(M,R)):R.texture=I,this._context.useProgram(this),this.setUniform1i(M,R.unit),this._context.bindTexture(I,R.unit),R.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach((M,I)=>{this._context.bindTexture(M.texture,M.unit),this.setUniform1i(I,M.unit)}),(0,v.pC)(this._fragmentUniforms)&&this._fragmentUniforms.forEach(M=>{"sampler2D"!==M.type&&"samplerCube"!==M.type||this._textures.has(M.name)||console.error(`Texture sampler ${M.name} has no bound texture`)})}_allocTextureUnit(M){return{texture:M,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(M){this._freeTextureUnits.push(M.unit)}}},5894:(ue,G,d)=>{var v,h;d.d(G,{r:()=>v}),(h=v||(v={}))[h.INTEGRATED_MESH=0]="INTEGRATED_MESH",h[h.OPAQUE_TERRAIN=1]="OPAQUE_TERRAIN",h[h.OPAQUE_MATERIAL=2]="OPAQUE_MATERIAL",h[h.TRANSPARENT_MATERIAL=3]="TRANSPARENT_MATERIAL",h[h.TRANSPARENT_TERRAIN=4]="TRANSPARENT_TERRAIN",h[h.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL=5]="TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL",h[h.OCCLUDED_TERRAIN=6]="OCCLUDED_TERRAIN",h[h.OCCLUDER_MATERIAL=7]="OCCLUDER_MATERIAL",h[h.TRANSPARENT_OCCLUDER_MATERIAL=8]="TRANSPARENT_OCCLUDER_MATERIAL",h[h.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS",h[h.POSTPROCESSING_ENVIRONMENT_OPAQUE=10]="POSTPROCESSING_ENVIRONMENT_OPAQUE",h[h.POSTPROCESSING_ENVIRONMENT_TRANSPARENT=11]="POSTPROCESSING_ENVIRONMENT_TRANSPARENT",h[h.LASERLINES=12]="LASERLINES",h[h.LASERLINES_CONTRAST_CONTROL=13]="LASERLINES_CONTRAST_CONTROL",h[h.HUD_MATERIAL=14]="HUD_MATERIAL",h[h.LABEL_MATERIAL=15]="LABEL_MATERIAL",h[h.LINE_CALLOUTS=16]="LINE_CALLOUTS",h[h.LINE_CALLOUTS_HUD_DEPTH=17]="LINE_CALLOUTS_HUD_DEPTH",h[h.DRAPED_MATERIAL=18]="DRAPED_MATERIAL",h[h.DRAPED_WATER=19]="DRAPED_WATER",h[h.VOXEL=20]="VOXEL",h[h.MAX_SLOTS=21]="MAX_SLOTS"},35671:(ue,G,d)=>{d.d(G,{L:()=>re,s:()=>Y});var v=d(62208),h=d(27422),O=d(67831),x=d(77172),b=d(651),C=d(91056),M=d(39114),I=d(12407),R=d(86962),F=d(2078);class Z extends C.A{initializeProgram(A){return new I.$(A.rctx,Z.shader.get().build(),M.i)}initializePipeline(){return(0,F.sm)({colorWrite:F.BK})}}Z.shader=new b.J(R.S,()=>d.e(857).then(d.bind(d,90857)));var X=d(52376);class Q extends C.A{initializeProgram(A){return new I.$(A.rctx,Q.shader.get().build(),M.i)}initializePipeline(){return(0,F.sm)({colorWrite:F.BK})}}Q.shader=new b.J(X.S,()=>d.e(3999).then(d.bind(d,73999)));var ae=d(99770),ee=d(17625);class B extends ee.K{constructor(){super(...arguments),this.projScale=1}}class H extends B{constructor(){super(...arguments),this.intensity=1}}class D extends ee.K{}class L extends D{constructor(){super(...arguments),this.blurSize=(0,ae.a)()}}var j=d(67969),U=d(85775),y=d(55086),K=d(26906);const Y=2;class re{constructor(A,S,w,W){this._view=A,this._techniqueRepository=S,this._rctx=w,this._requestRender=W,this._quadVAO=null,this._passParameters=new H,this._drawParameters=new L}dispose(){this.enabled=!1,this._quadVAO=(0,v.M2)(this._quadVAO)}disposeOffscreenBuffers(){(0,v.yw)(this._ssaoFBO,A=>A.resize(0,0)),(0,v.yw)(this._blur0FBO,A=>A.resize(0,0)),(0,v.yw)(this._blur1FBO,A=>A.resize(0,0))}set enabled(A){A?this._enable():this._disable()}get enabled(){return(0,v.pC)(this._enableTime)}get active(){return this.enabled&&this._ssaoTechnique.compiled&&this._blurTechnique.compiled}get colorTexture(){return(0,v.pC)(this._blur1FBO)?this._blur1FBO.colorTexture:null}render(A,S,w,W){if((0,v.Wi)(this._enableTime)||(0,v.Wi)(w)||(0,v.Wi)(W)||(0,v.Wi)(this._ssaoFBO)||(0,v.Wi)(this._blur0FBO)||(0,v.Wi)(this._blur1FBO))return;if(!this.active)return this._enableTime=S,void this._requestRender();0===this._enableTime&&(this._enableTime=S);const N=this._rctx,k=A.camera,de=this._view.qualitySettings.fadeDuration,he=de>0?Math.min(de,S-this._enableTime)/de:1;this._passParameters.normalTexture=W,this._passParameters.depthTexture=w,this._passParameters.projScale=1/k.computeRenderPixelSizeAtDist(1),this._passParameters.intensity=4*ie/(0,X.g)(k)**6*he;const ne=k.fullViewport,le=ne[2],me=ne[3],J=le/Y,oe=me/Y;this._ssaoFBO.resize(le,me),this._blur0FBO.resize(J,oe),this._blur1FBO.resize(J,oe),(0,v.Wi)(this._quadVAO)&&(this._quadVAO=(0,x.ow)(this._rctx)),N.bindFramebuffer(this._ssaoFBO),N.setViewport(0,0,le,me),N.bindTechnique(this._ssaoTechnique,this._passParameters,A).bindDraw(this._drawParameters,A,this._passParameters),N.bindVAO(this._quadVAO);const ve=(0,K._V)(this._quadVAO,"geometry");N.drawArrays(j.MX.TRIANGLE_STRIP,0,ve);const Te=N.bindTechnique(this._blurTechnique,this._passParameters,A);N.setViewport(0,0,J,oe),N.bindFramebuffer(this._blur0FBO),this._drawParameters.colorTexture=this._ssaoFBO.colorTexture,(0,O.s)(this._drawParameters.blurSize,0,Y/me),Te.bindDraw(this._drawParameters,A,this._passParameters),N.setViewport(0,0,J,oe),N.drawArrays(j.MX.TRIANGLE_STRIP,0,ve),N.bindFramebuffer(this._blur1FBO),this._drawParameters.colorTexture=this._blur0FBO.colorTexture,(0,O.s)(this._drawParameters.blurSize,Y/le,0),Te.bindDraw(this._drawParameters,A,this._passParameters),N.drawArrays(j.MX.TRIANGLE_STRIP,0,ve),N.setViewport(ne[0],ne[1],ne[2],ne[3]),he<1&&this._requestRender()}_enable(){if((0,v.pC)(this._enableTime))return;const A={target:j.No.TEXTURE_2D,pixelFormat:j.VI.RGBA,dataType:j.Br.UNSIGNED_BYTE,samplingMode:j.cw.LINEAR,wrapMode:j.e8.CLAMP_TO_EDGE,width:0,height:0},S={colorTarget:j.Lm.TEXTURE,depthStencilTarget:j.OU.NONE};this._ssaoFBO=new U.X(this._rctx,S,A),this._blur0FBO=new U.X(this._rctx,S,A),this._blur1FBO=new U.X(this._rctx,S,A);const w=Uint8Array.from(atob("eXKEvZaUc66cjIKElE1jlJ6MjJ6Ufkl+jn2fcXp5jBx7c6KEflSGiXuXeW6OWs+tfqZ2Yot2Y7Zzfo2BhniEj3xoiXuXj4eGZpqEaHKDWjSMe7palFlzc3BziYOGlFVzg6Zzg7CUY5JrjFF7eYJ4jIKEcyyEonSXe7qUfqZ7j3xofqZ2c4R5lFZ5Y0WUbppoe1l2cIh2ezyUho+BcHN2cG6DbpqJhqp2e1GcezhrdldzjFGUcyxjc3aRjDyEc1h7Sl17c6aMjH92pb6Mjpd4dnqBjMOEhqZleIOBYzB7gYx+fnqGjJuEkWlwnCx7fGl+c4hjfGyRe5qMlNOMfnqGhIWHc6OMi4GDc6aMfqZuc6aMzqJzlKZ+lJ6Me3qRfoFue0WUhoR5UraEa6qMkXiPjMOMlJOGe7JrUqKMjK6MeYRzdod+Sl17boiPc6qEeYBlcIh2c1WEe7GDiWCDa0WMjEmMdod+Y0WcdntzhmN8WjyMjKJjiXtzgYxYaGd+a89zlEV7e2GJfnd+lF1rcK5zc4p5cHuBhL6EcXp5eYB7fnh8iX6HjIKEeaxuiYOGc66RfG2Ja5hzjlGMjEmMe9OEgXuPfHyGhPeEdl6JY02McGuMfnqGhFiMa3WJfnx2l4hwcG1uhmN8c0WMc39og1GBbrCEjE2EZY+JcIh2cIuGhIWHe0mEhIVrc09+gY5+eYBlnCyMhGCDl3drfmmMgX15aGd+gYx+fnuRfnhzY1SMsluJfnd+hm98WtNrcIuGh4SEj0qPdkqOjFF7jNNjdnqBgaqUjMt7boeBhnZ4jDR7c5pze4GGjEFrhLqMjHyMc0mUhKZze4WEa117kWlwbpqJjHZ2eX2Bc09zeId+e0V7WlF7jHJ2l72BfId8l3eBgXyBe897jGl7c66cgW+Xc76EjKNbgaSEjGx4fId8jFFjgZB8cG6DhlFziZhrcIh2fH6HgUqBgXiPY8dahGFzjEmMhEFre2dxhoBzc5SGfleGe6alc7aUeYBlhKqUdlp+cH5za4OEczxza0Gcc4J2jHZ5iXuXjH2Jh5yRjH2JcFx+hImBjH+MpddCl3dreZeJjIt8ZW18bm1zjoSEeIOBlF9oh3N7hlqBY4+UeYFwhLJjeYFwaGd+gUqBYxiEYot2fqZ2ondzhL6EYyiEY02Ea0VjgZB8doaGjHxoc66cjEGEiXuXiXWMiZhreHx8frGMe75rY02Ec5pzfnhzlEp4a3VzjM+EhFFza3mUY7Zza1V5e2iMfGyRcziEhDyEkXZ2Y4OBnCx7g5t2eyBjgV6EhEFrcIh2dod+c4Z+nJ5zjm15jEmUeYxijJp7nL6clIpjhoR5WrZraGd+fnuRa6pzlIiMg6ZzfHx5foh+eX1ufnB5eX1ufnB5aJt7UqKMjIh+e3aBfm5lbYSBhGFze6J4c39oc0mUc4Z+e0V7fKFVe0WEdoaGY02Ec4Z+Y02EZYWBfH6HgU1+gY5+hIWUgW+XjJ57ebWRhFVScHuBfJ6PhBx7WqJzlM+Ujpd4gHZziX6HjHmEgZN+lJt5boiPe2GJgX+GjIGJgHZzeaxufnB5hF2JtdN7jJ57hp57hK6ElFVzg6ZzbmiEbndzhIWHe3uJfoFue3qRhJd2j3xoc65zlE1jc3p8lE1jhniEgXJ7e657vZaUc3qBh52BhIF4aHKDa9drgY5+c52GWqZzbpqJe8tjnM+UhIeMfo2BfGl+hG1zSmmMjKJjZVaGgX15c1lze0mEp4OHa3mUhIWHhDyclJ6MeYOJkXiPc0VzhFiMlKaEboSJa5Jze41re3qRhn+HZYWBe0mEc4p5fnORbox5lEp4hGFjhGGEjJuEc1WEhLZjeHeGa7KlfHx2hLaMeX1ugY5+hIWHhKGPjMN7c1WEho1zhoBzZYx7fnhzlJt5exyUhFFziXtzfmmMa6qMYyiEiXxweV12kZSMeWqXSl17fnhzxmmMrVGEe1mcc4p5eHeGjK6MgY5+doaGa6pzlGV7g1qBh4KHkXiPeW6OaKqafqZ2eXZ5e1V7jGd7boSJc3BzhJd2e0mcYot2h1RoY8dahK6EQmWEWjx7e1l2lL6UgXyBdnR4eU9zc0VreX1umqaBhld7fo2Bc6KEc5Z+hDyEcIeBWtNrfHyGe5qMhMuMe5qMhEGEbVVupcNzg3aHhIF4boeBe0mEdlptc39ofFl5Y8uUlJOGiYt2UmGEcyxjjGx4jFF7a657ZYWBnElzhp57iXtrgZN+tfOEhIOBjE2HgU1+e8tjjKNbiWCDhE15gUqBgYN7fnqGc66ce9d7iYSBj0qPcG6DnGGcT3eGa6qMZY+JlIiMl4hwc3aRdnqBlGV7eHJ2hLZjfnuRhDyEeX6MSk17g6Z+c6aUjHmEhIF4gXyBc76EZW18fGl+fkl+jCxrhoVwhDyUhIqGlL2DlI6EhJd2tdN7eYORhEGMa2Faa6pzc3Bzc4R5lIRznM+UY9eMhDycc5Z+c4p5c4iGY117pb6MgXuPrbJafnx2eYOJeXZ5e657hDyEcziElKZjfoB5eHeGj4WRhGGEe6KGeX1utTStc76EhFGJnCyMa5hzfH6HnNeceYB7hmN8gYuMhIVrczSMgYF8h3N7c5pza5hzjJqEYIRdgYuMlL2DeYRzhGGEeX1uhLaEc4iGeZ1zdl6JhrVteX6Me2iMfm5lWqJzSpqEa6pzdnmchHx2c6OMhNdrhoR5g3aHczxzeW52gV6Ejm15frGMc0Vzc4Z+l3drfniJe+9rWq5rlF1rhGGEhoVwe9OEfoh+e7pac09+c3qBY0lrhDycdnp2lJ6MiYOGhGCDc3aRlL2DlJt5doaGdnp2gYF8gWeOjF2Uc4R5c5Z+jEmMe7KEc4mEeYJ4dmyBe0mcgXiPbqJ7eYB7fmGGiYSJjICGlF1reZ2PnElzbpqJfH6Hc39oe4WEc5eJhK6EhqyJc3qBgZB8c09+hEmEaHKDhFGJc5SGiXWMUpaEa89zc6OMnCyMiXtrho+Be5qMc7KEjJ57dmN+hKGPjICGbmiEe7prdod+hGCDdnmchBx7eX6MkXZ2hGGEa657hm98jFFjY5JreYOJgY2EjHZ2a295Y3FajJ6Mc1J+YzB7e4WBjF2Uc4R5eV12gYxzg1qBeId+c9OUc5pzjFFjgY5+hFiMlIaPhoR5lIpjjIKBlNdSe7KEeX2BfrGMhIqGc65zjE2UhK6EklZ+QmWEeziMWqZza3VzdnR4foh+gYF8n3iJiZhrnKp7gYF8eId+lJ6Me1lrcIuGjKJjhmN8c66MjFF7a6prjJ6UnJ5zezyUfruRWlF7nI5zfHyGe657h4SEe8tjhBx7jFFjc09+c39ojICMeZeJeXt+YzRzjHZ2c0WEcIeBeXZ5onSXkVR+gYJ+eYFwdldzgYF7eX2BjJ6UiXuXlE1jh4SEe1mchLJjc4Z+hqZ7eXZ5bm1zlL6Ue5p7iWeGhKqUY5pzjKJjcIeBe8t7gXyBYIRdlEp4a3mGnK6EfmmMZpqEfFl5gYxzjKZuhGFjhoKGhHx2fnx2eXuMe3aBiWeGvbKMe6KGa5hzYzB7gZOBlGV7hmN8hqZlYot2Y117a6pzc6KEfId8foB5rctrfneJfJ6PcHN2hFiMc5pzjH92c0VzgY2EcElzdmCBlFVzg1GBc65zY4OBboeBcHiBeYJ4ewxzfHx5lIRzlEmEnLKEbk1zfJ6PhmN8eYBljBiEnMOEiXxwezyUcIeBe76EdsKEeX2BdnR4jGWUrXWMjGd7fkl+j4WRlEGMa5Jzho+BhDyEfnqMeXt+g3aHlE1jczClhNN7ZW18eHx8hGFjZW18iXWMjKJjhH57gYuMcIuGWjyMe4ZtjJuExmmMj4WRdntzi4GDhFFzYIRdnGGcjJp7Y0F7e4WEkbCGiX57fnSHa657a6prhBCMe3Z+SmmMjH92eHJ2hK6EY1FzexhrvbKMnI5za4OEfnd+eXuMhImBe897hLaMjN+EfG+BeIOBhF1+eZeJi4GDkXZ2eXKEgZ6Ejpd4c2GHa1V5e5KUfqZuhCx7jKp7lLZrg11+hHx2hFWUoot2nI5zgbh5mo9zvZaUe3qRbqKMfqZ2kbCGhFiM"),W=>W.charCodeAt(0));this._passParameters.noiseTexture=new y.x(this._rctx,{target:j.No.TEXTURE_2D,pixelFormat:j.VI.RGB,dataType:j.Br.UNSIGNED_BYTE,hasMipmap:!0,width:32,height:32},w),(0,v.Wi)(this._ssaoTechnique)&&(this._ssaoTechnique=this._techniqueRepository.acquire(Q)),(0,v.Wi)(this._blurTechnique)&&(this._blurTechnique=this._techniqueRepository.acquire(Z)),this._enableTime=(0,h.HA)(0),this._requestRender()}_disable(){this._enableTime=null,this._passParameters.noiseTexture=(0,v.M2)(this._passParameters.noiseTexture),this._blur1FBO=(0,v.M2)(this._blur1FBO),this._blur0FBO=(0,v.M2)(this._blur0FBO),this._ssaoFBO=(0,v.M2)(this._ssaoFBO)}get gpuMemoryUsage(){return((0,v.pC)(this._blur0FBO)?this._blur0FBO.gpuMemoryUsage:0)+((0,v.pC)(this._blur1FBO)?this._blur1FBO.gpuMemoryUsage:0)+((0,v.pC)(this._ssaoFBO)?this._ssaoFBO.gpuMemoryUsage:0)}get test(){return{ssao:this._ssaoFBO,blur:this._blur1FBO}}}const ie=.5},64127:(ue,G,d)=>{d.d(G,{JN:()=>O,P7:()=>C,RY:()=>R,YD:()=>z,eD:()=>F,ii:()=>Z,s3:()=>b,zV:()=>x});var v=d(42743),h=d(67969);const O={func:h.wb.LESS},x={func:h.wb.ALWAYS},b={mask:255},C={mask:0},R={function:{func:h.wb.ALWAYS,ref:v.hU.OutlineVisualElementMask,mask:v.hU.OutlineVisualElementMask},operation:{fail:h.xS.KEEP,zFail:h.xS.KEEP,zPass:h.xS.ZERO}},F={function:{func:h.wb.ALWAYS,ref:v.hU.OutlineVisualElementMask,mask:v.hU.OutlineVisualElementMask},operation:{fail:h.xS.KEEP,zFail:h.xS.KEEP,zPass:h.xS.REPLACE}},Z={function:{func:h.wb.EQUAL,ref:v.hU.OutlineVisualElementMask,mask:v.hU.OutlineVisualElementMask},operation:{fail:h.xS.KEEP,zFail:h.xS.KEEP,zPass:h.xS.KEEP}},z={function:{func:h.wb.NOTEQUAL,ref:v.hU.OutlineVisualElementMask,mask:v.hU.OutlineVisualElementMask},operation:{fail:h.xS.KEEP,zFail:h.xS.KEEP,zPass:h.xS.KEEP}}},9983:(ue,G,d)=>{d.d(G,{x:()=>Be});var v=d(15861),h=d(94573),O=d(26584),x=d(61885),b=d(21286),C=d(62208),M=d(10699),I=d(55713),R=d(21726),F=d(70026),Z=d(33899),z=d(98361),X=d(42743),Q=d(54346);function ae(){if((0,C.Wi)(ee)){const ce=q=>(0,Q.V)(`esri/libs/basisu/${q}`);ee=d.e(2405).then(d.bind(d,14258)).then(q=>q.b).then(({default:q})=>q({locateFile:ce}).then(_e=>(_e.initializeBasis(),delete _e.then,_e)))}return ee}let ee;var B,ce;(ce=B||(B={}))[ce.ETC1_RGB=0]="ETC1_RGB",ce[ce.ETC2_RGBA=1]="ETC2_RGBA",ce[ce.BC1_RGB=2]="BC1_RGB",ce[ce.BC3_RGBA=3]="BC3_RGBA",ce[ce.BC4_R=4]="BC4_R",ce[ce.BC5_RG=5]="BC5_RG",ce[ce.BC7_M6_RGB=6]="BC7_M6_RGB",ce[ce.BC7_M5_RGBA=7]="BC7_M5_RGBA",ce[ce.PVRTC1_4_RGB=8]="PVRTC1_4_RGB",ce[ce.PVRTC1_4_RGBA=9]="PVRTC1_4_RGBA",ce[ce.ASTC_4x4_RGBA=10]="ASTC_4x4_RGBA",ce[ce.ATC_RGB=11]="ATC_RGB",ce[ce.ATC_RGBA=12]="ATC_RGBA",ce[ce.FXT1_RGB=17]="FXT1_RGB",ce[ce.PVRTC2_4_RGB=18]="PVRTC2_4_RGB",ce[ce.PVRTC2_4_RGBA=19]="PVRTC2_4_RGBA",ce[ce.ETC2_EAC_R11=20]="ETC2_EAC_R11",ce[ce.ETC2_EAC_RG11=21]="ETC2_EAC_RG11",ce[ce.RGBA32=13]="RGBA32",ce[ce.RGB565=14]="RGB565",ce[ce.BGR565=15]="BGR565",ce[ce.RGBA4444=16]="RGBA4444";var H=d(67969),D=d(55086),L=d(26906);let j=null,U=null;function y(){return K.apply(this,arguments)}function K(){return(K=(0,v.Z)(function*(){return(0,C.Wi)(U)&&(U=ae(),j=yield U),U})).apply(this,arguments)}function ie(ce,q,_e,se,Pe){const Ae=(0,L.RG)(q?H.q_.COMPRESSED_RGBA8_ETC2_EAC:H.q_.COMPRESSED_RGB8_ETC2);return Math.ceil(_e*se*Ae*(Pe&&ce>1?(4**ce-1)/(3*4**(ce-1)):1))}function V(ce){return ce.getNumImages()>=1&&!ce.isUASTC()}function A(ce){return ce.getFaces()>=1&&ce.isETC1S()}function w(){return w=(0,v.Z)(function*(ce,q,_e){(0,C.Wi)(j)&&(j=yield y());const se=new j.BasisFile(new Uint8Array(_e));if(!V(se))return null;se.startTranscoding();const Pe=k(ce,q,se.getNumLevels(0),se.getHasAlpha(),se.getImageWidth(0,0),se.getImageHeight(0,0),(Ae,De)=>se.getImageTranscodedSizeInBytes(0,Ae,De),(Ae,De,Ie)=>se.transcodeImage(Ie,0,Ae,De,0,0));return se.close(),se.delete(),Pe}),w.apply(this,arguments)}function N(){return N=(0,v.Z)(function*(ce,q,_e){(0,C.Wi)(j)&&(j=yield y());const se=new j.KTX2File(new Uint8Array(_e));if(!A(se))return null;se.startTranscoding();const Pe=k(ce,q,se.getLevels(),se.getHasAlpha(),se.getWidth(),se.getHeight(),(Ae,De)=>se.getImageTranscodedSizeInBytes(Ae,0,0,De),(Ae,De,Ie)=>se.transcodeImage(Ie,Ae,0,0,De,0,-1,-1));return se.close(),se.delete(),Pe}),N.apply(this,arguments)}function k(ce,q,_e,se,Pe,Ae,De,Ie){const{compressedTextureETC:Ce,compressedTextureS3TC:Ue}=ce.capabilities,[ye,Ge]=Ce?se?[B.ETC2_RGBA,H.q_.COMPRESSED_RGBA8_ETC2_EAC]:[B.ETC1_RGB,H.q_.COMPRESSED_RGB8_ETC2]:Ue?se?[B.BC3_RGBA,H.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT]:[B.BC1_RGB,H.q_.COMPRESSED_RGB_S3TC_DXT1_EXT]:[B.RGBA32,H.VI.RGBA],Ke=q.hasMipmap?_e:Math.min(1,_e),He=[];for(let Ye=0;Ye<Ke;Ye++)He.push(new Uint8Array(De(Ye,ye))),Ie(Ye,ye,He[Ye]);const Ve=He.length>1,Xe=Ve?H.cw.LINEAR_MIPMAP_LINEAR:H.cw.LINEAR,Ze={...q,samplingMode:Xe,hasMipmap:Ve,internalFormat:Ge,width:Pe,height:Ae};return new D.x(ce,Ze,{type:"compressed",levels:He})}var de=d(12699),he=d(24425);const le=d(63290).Z.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil");function ve(ce){return ce.charCodeAt(0)+(ce.charCodeAt(1)<<8)+(ce.charCodeAt(2)<<16)+(ce.charCodeAt(3)<<24)}const Me=ve("DXT1"),Ee=ve("DXT3"),$=ve("DXT5");var ze,we=d(77172),Ne=d(2282),We=d(57596),je=d(85775);class Be extends de.c{constructor(q,_e){super(),this._data=q,this.type=he.U.Texture,this._glTexture=null,this._powerOfTwoStretchInfo=null,this._loadingPromise=null,this._loadingController=null,this.events=new x.Z,this._passParameters=new z.T,this.params=_e||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:H.e8.REPEAT,t:H.e8.REPEAT},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||X.CE.STRETCH,this.estimatedTexMemRequired=Be._estimateTexMemRequired(this._data,this.params),this._startPreload()}_startPreload(){const q=this._data;(0,C.Wi)(q)||(q instanceof HTMLVideoElement?this._startPreloadVideoElement(q):q instanceof HTMLImageElement&&this._startPreloadImageElement(q))}_startPreloadVideoElement(q){if(!((0,R.jc)(q.src)||"auto"===q.preload&&q.crossOrigin)){q.preload="auto",q.crossOrigin="anonymous";const _e=!q.paused;if(q.src=q.src,_e&&q.autoplay){const se=()=>{q.removeEventListener("canplay",se),q.play()};q.addEventListener("canplay",se)}}}_startPreloadImageElement(q){(0,R.HK)(q.src)||(0,R.jc)(q.src)||q.crossOrigin||(q.crossOrigin="anonymous",q.src=q.src)}static _getDataDimensions(q){return q instanceof HTMLVideoElement?{width:q.videoWidth,height:q.videoHeight}:q}static _estimateTexMemRequired(q,_e){if((0,C.Wi)(q))return 0;if((0,I.eP)(q)||(0,I.lq)(q))return _e.encoding===X.Ti.KTX2_ENCODING?function re(ce,q){if((0,C.Wi)(j))return ce.byteLength;const _e=new j.KTX2File(new Uint8Array(ce)),se=A(_e)?ie(_e.getLevels(),_e.getHasAlpha(),_e.getWidth(),_e.getHeight(),q):0;return _e.close(),_e.delete(),se}(q,!!_e.mipmap):_e.encoding===X.Ti.BASIS_ENCODING?function Y(ce,q){if((0,C.Wi)(j))return ce.byteLength;const _e=new j.BasisFile(new Uint8Array(ce)),se=V(_e)?ie(_e.getNumLevels(0),_e.getHasAlpha(),_e.getImageWidth(0,0),_e.getImageHeight(0,0),q):0;return _e.close(),_e.delete(),se}(q,!!_e.mipmap):q.byteLength;const{width:se,height:Pe}=q instanceof Image||q instanceof ImageData||q instanceof HTMLCanvasElement||q instanceof HTMLVideoElement?Be._getDataDimensions(q):_e;return(_e.mipmap?4/3:1)*se*Pe*(_e.components||4)||0}dispose(){this._data=void 0}get width(){return this.params.width}get height(){return this.params.height}_createDescriptor(q){return{target:H.No.TEXTURE_2D,pixelFormat:H.VI.RGBA,dataType:H.Br.UNSIGNED_BYTE,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?H.cw.LINEAR_MIPMAP_LINEAR:H.cw.LINEAR,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.maxAnisotropy??(this.params.mipmap?q.parameters.maxMaxAnisotropy:1)}}get glTexture(){return this._glTexture}load(q,_e){if((0,C.pC)(this._glTexture))return this._glTexture;if((0,C.pC)(this._loadingPromise))return this._loadingPromise;const se=this._data;return(0,C.Wi)(se)?(this._glTexture=new D.x(q,this._createDescriptor(q),null),this._glTexture):"string"==typeof se?this._loadFromURL(q,_e,se):se instanceof Image?this._loadFromImageElement(q,_e,se):se instanceof HTMLVideoElement?this._loadFromVideoElement(q,_e,se):se instanceof ImageData||se instanceof HTMLCanvasElement?this._loadFromImage(q,se,_e):((0,I.eP)(se)||(0,I.lq)(se))&&this.params.encoding===X.Ti.DDS_ENCODING?(this._data=void 0,this._loadFromDDSData(q,se)):((0,I.eP)(se)||(0,I.lq)(se))&&this.params.encoding===X.Ti.KTX2_ENCODING?(this._data=void 0,this._loadFromKTX2(q,se)):((0,I.eP)(se)||(0,I.lq)(se))&&this.params.encoding===X.Ti.BASIS_ENCODING?(this._data=void 0,this._loadFromBasis(q,se)):(0,I.lq)(se)?this._loadFromPixelData(q,se):(0,I.eP)(se)?this._loadFromPixelData(q,new Uint8Array(se)):null}get requiresFrameUpdates(){return this._data instanceof HTMLVideoElement}frameUpdate(q,_e,se){if(!(this._data instanceof HTMLVideoElement)||(0,C.Wi)(this._glTexture)||this._data.readyState<ze.HAVE_CURRENT_DATA||se===this._data.currentTime)return se;if((0,C.pC)(this._powerOfTwoStretchInfo)){const{framebuffer:Pe,vao:Ae,sourceTexture:De}=this._powerOfTwoStretchInfo;De.setData(this._data),this._drawStretchedTexture(q,_e,Pe,Ae,De,this._glTexture)}else{const{videoWidth:Pe,videoHeight:Ae}=this._data,{width:De,height:Ie}=this._glTexture.descriptor;Pe!==De||Ae!==Ie?this._glTexture.updateData(0,0,0,Math.min(Pe,De),Math.min(Ae,Ie),this._data):this._glTexture.setData(this._data)}return this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this.params.updateCallback&&this.params.updateCallback(),this._data.currentTime}_loadFromDDSData(q,_e){return this._glTexture=function Le(ce,q,_e){const{textureData:se,internalFormat:Pe,width:Ae,height:De}=(0,C.s3)(function Fe(ce,q){const _e=new Int32Array(ce,0,31);if(542327876!==_e[0])return le.error("Invalid magic number in DDS header"),null;if(!(4&_e[20]))return le.error("Unsupported format, must contain a FourCC code"),null;const se=_e[21];let Pe,Ae;switch(se){case Me:Pe=8,Ae=H.q_.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case Ee:Pe=16,Ae=H.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case $:Pe=16,Ae=H.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return le.error("Unsupported FourCC code:",function Te(ce){return String.fromCharCode(255&ce,ce>>8&255,ce>>16&255,ce>>24&255)}(se)),null}let De=1,Ie=_e[4],Ce=_e[3];!(3&Ie)&&!(3&Ce)||(le.warn("Rounding up compressed texture size to nearest multiple of 4."),Ie=Ie+3&-4,Ce=Ce+3&-4);const Ue=Ie,ye=Ce;let Ge,Ke;131072&_e[2]&&!1!==q&&(De=Math.max(1,_e[7])),1===De||(0,b.wt)(Ie)&&(0,b.wt)(Ce)||(le.warn("Ignoring mipmaps of non power of two sized compressed texture."),De=1);let He=_e[1]+4;const Ve=[];for(let Xe=0;Xe<De;++Xe)Ke=(Ie+3>>2)*(Ce+3>>2)*Pe,Ge=new Uint8Array(ce,He,Ke),Ve.push(Ge),He+=Ke,Ie=Math.max(1,Ie>>1),Ce=Math.max(1,Ce>>1);return{textureData:{type:"compressed",levels:Ve},internalFormat:Ae,width:Ue,height:ye}}(_e,q.hasMipmap??!1));return q.samplingMode=se.levels.length>1?H.cw.LINEAR_MIPMAP_LINEAR:H.cw.LINEAR,q.hasMipmap=se.levels.length>1,q.internalFormat=Pe,q.width=Ae,q.height=De,new D.x(ce,q,se)}(q,this._createDescriptor(q),_e),this._glTexture}_loadFromKTX2(q,_e){return this._loadAsync(()=>function W(ce,q,_e){return N.apply(this,arguments)}(q,this._createDescriptor(q),_e).then(se=>(this._glTexture=se,se)))}_loadFromBasis(q,_e){return this._loadAsync(()=>function S(ce,q,_e){return w.apply(this,arguments)}(q,this._createDescriptor(q),_e).then(se=>(this._glTexture=se,se)))}_loadFromPixelData(q,_e){(0,Ne.hu)(this.params.width>0&&this.params.height>0);const se=this._createDescriptor(q);return se.pixelFormat=1===this.params.components?H.VI.LUMINANCE:3===this.params.components?H.VI.RGB:H.VI.RGBA,se.width=this.params.width,se.height=this.params.height,this._glTexture=new D.x(q,se,_e),this._glTexture}_loadFromURL(q,_e,se){var Pe=this;return this._loadAsync(function(){var Ae=(0,v.Z)(function*(De){const Ie=yield(0,F.t)(se,{signal:De});return(0,M.k_)(De),Pe._loadFromImage(q,Ie,_e)});return function(De){return Ae.apply(this,arguments)}}())}_loadFromImageElement(q,_e,se){var Pe=this;return se.complete?this._loadFromImage(q,se,_e):this._loadAsync(function(){var Ae=(0,v.Z)(function*(De){const Ie=yield(0,Z.fY)(se,se.src,!1,De);return(0,M.k_)(De),Pe._loadFromImage(q,Ie,_e)});return function(De){return Ae.apply(this,arguments)}}())}_loadFromVideoElement(q,_e,se){return se.readyState>=ze.HAVE_CURRENT_DATA?this._loadFromImage(q,se,_e):this._loadFromVideoElementAsync(q,_e,se)}_loadFromVideoElementAsync(q,_e,se){return this._loadAsync(Pe=>new Promise((Ae,De)=>{const Ie=()=>{se.removeEventListener("loadeddata",Ce),se.removeEventListener("error",Ue),(0,C.hw)(ye)},Ce=()=>{se.readyState>=ze.HAVE_CURRENT_DATA&&(Ie(),Ae(this._loadFromImage(q,se,_e)))},Ue=Ge=>{Ie(),De(Ge||new O.Z("Failed to load video"))};se.addEventListener("loadeddata",Ce),se.addEventListener("error",Ue);const ye=(0,M.fu)(Pe,()=>Ue((0,M.zE)()))}))}_loadFromImage(q,_e,se){const Pe=Be._getDataDimensions(_e);this.params.width=Pe.width,this.params.height=Pe.height;const Ae=this._createDescriptor(q);return Ae.pixelFormat=3===this.params.components?H.VI.RGB:H.VI.RGBA,!this._requiresPowerOfTwo(q,Ae)||(0,b.wt)(Pe.width)&&(0,b.wt)(Pe.height)?(Ae.width=Pe.width,Ae.height=Pe.height,this._glTexture=new D.x(q,Ae,_e),this._glTexture):(this._glTexture=this._makePowerOfTwoTexture(q,_e,Pe,Ae,se),this._glTexture)}_loadAsync(q){const _e=new AbortController;this._loadingController=_e;const se=q(_e.signal);this._loadingPromise=se;const Pe=()=>{this._loadingController===_e&&(this._loadingController=null),this._loadingPromise===se&&(this._loadingPromise=null)};return se.then(Pe,Pe),se}_requiresPowerOfTwo(q,_e){const se=H.e8.CLAMP_TO_EDGE;return q.type===We.zO.WEBGL1&&(_e.hasMipmap||!("number"==typeof _e.wrapMode?_e.wrapMode===se:_e.wrapMode.s===se&&_e.wrapMode.t===se))}_makePowerOfTwoTexture(q,_e,se,Pe,Ae){const{width:De,height:Ie}=se,Ce=(0,b.Sf)(De),Ue=(0,b.Sf)(Ie);let ye;switch(Pe.width=Ce,Pe.height=Ue,this.params.powerOfTwoResizeMode){case X.CE.PAD:Pe.textureCoordinateScaleFactor=[De/Ce,Ie/Ue],ye=new D.x(q,Pe),ye.updateData(0,0,0,De,Ie,_e);break;case X.CE.STRETCH:case null:case void 0:ye=this._stretchToPowerOfTwo(q,_e,Pe,Ae());break;default:(0,h.Bg)(this.params.powerOfTwoResizeMode)}return Pe.hasMipmap&&ye.generateMipmap(),ye}_stretchToPowerOfTwo(q,_e,se,Pe){const Ae=new D.x(q,se),De=new je.X(q,{colorTarget:H.Lm.TEXTURE,depthStencilTarget:H.OU.NONE},Ae),Ie=new D.x(q,{target:H.No.TEXTURE_2D,pixelFormat:se.pixelFormat,dataType:H.Br.UNSIGNED_BYTE,wrapMode:H.e8.CLAMP_TO_EDGE,samplingMode:H.cw.LINEAR,flipped:!!se.flipped,maxAnisotropy:8,preMultiplyAlpha:se.preMultiplyAlpha},_e),Ce=(0,we.ow)(q),Ue=q.getBoundFramebufferObject();return this._drawStretchedTexture(q,Pe,De,Ce,Ie,Ae),this.requiresFrameUpdates?this._powerOfTwoStretchInfo={vao:Ce,sourceTexture:Ie,framebuffer:De}:(Ce.dispose(!0),Ie.dispose(),De.detachColorTexture(),De.dispose()),q.bindFramebuffer(Ue),Ae}_drawStretchedTexture(q,_e,se,Pe,Ae,De){this._passParameters.texture=Ae,q.bindFramebuffer(se);const Ie=q.getViewport();q.setViewport(0,0,De.descriptor.width,De.descriptor.height),q.bindTechnique(_e,this._passParameters,null),q.bindVAO(Pe),q.drawArrays(H.MX.TRIANGLE_STRIP,0,(0,L._V)(Pe,"geometry")),q.bindFramebuffer(null),q.setViewport(Ie.x,Ie.y,Ie.width,Ie.height),this._passParameters.texture=null}unload(){if((0,C.pC)(this._powerOfTwoStretchInfo)){const{framebuffer:q,vao:_e,sourceTexture:se}=this._powerOfTwoStretchInfo;_e.dispose(!0),se.dispose(),q.dispose(),this._glTexture=null,this._powerOfTwoStretchInfo=null}if((0,C.pC)(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),(0,C.pC)(this._loadingController)){const q=this._loadingController;this._loadingController=null,this._loadingPromise=null,q.abort()}this.events.emit("unloaded")}}!function(ce){ce[ce.HAVE_NOTHING=0]="HAVE_NOTHING",ce[ce.HAVE_METADATA=1]="HAVE_METADATA",ce[ce.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",ce[ce.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",ce[ce.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(ze||(ze={}))},44835:(ue,G,d)=>{var v,h;d.d(G,{A:()=>v}),(h=v||(v={}))[h.Color=0]="Color",h[h.Alpha=1]="Alpha",h[h.FrontFace=2]="FrontFace",h[h.NONE=3]="NONE",h[h.COUNT=4]="COUNT"},2282:(ue,G,d)=>{d.d(G,{E6:()=>Z,T:()=>M,ep:()=>R,hu:()=>C,kG:()=>X,u_:()=>z,yK:()=>I});var v=d(99770);d(993),(0,d(4794).c)();class b{constructor(ae){this.message=ae}toString(){return`AssertException: ${this.message}`}}function C(Q,ae){if(!Q){ae=ae||"Assertion";const ee=new Error(ae).stack;throw new b(`${ae} at ${ee}`)}}function M(Q,ae){Q||(ae=ae||"",console.warn("Verify failed: "+ae+"\n"+new Error("verify").stack))}function I(Q,ae,ee,B){let H,D=(ee[0]-Q[0])/ae[0],L=(B[0]-Q[0])/ae[0];D>L&&(H=D,D=L,L=H);let j=(ee[1]-Q[1])/ae[1],U=(B[1]-Q[1])/ae[1];if(j>U&&(H=j,j=U,U=H),D>U||j>L)return!1;j>D&&(D=j),U<L&&(L=U);let y=(ee[2]-Q[2])/ae[2],K=(B[2]-Q[2])/ae[2];return y>K&&(H=y,y=K,K=H),!(D>K||y>L||(K<L&&(L=K),L<0))}function R(Q,ae,ee,B,H,D=(0,v.a)()){const L=(B[H]-ee[H])*(ae[0]-Q[0])-(B[0]-ee[0])*(ae[H]-Q[H]);if(0===L)return!1;const U=((B[0]-ee[0])*(Q[H]-ee[H])-(B[H]-ee[H])*(Q[0]-ee[0]))/L;return D[0]=Q[0]+U*(ae[0]-Q[0]),D[1]=Q[H]+U*(ae[H]-Q[H]),!0}function Z(Q,ae){return Math.log(Q)/Math.log(ae)}function z(Q,ae,ee,B){Q[12]=ae,Q[13]=ee,Q[14]=B}function X(Q){return 1===Q[0]&&0===Q[1]&&0===Q[2]&&0===Q[3]&&0===Q[4]&&1===Q[5]&&0===Q[6]&&0===Q[7]&&0===Q[8]&&0===Q[9]&&1===Q[10]&&0===Q[11]&&1===Q[15]}},76438:(ue,G,d)=>{d.d(G,{U:()=>h});var v=d(49353);class h extends v.U{}},16396:(ue,G,d)=>{var v,h;d.d(G,{T:()=>v}),(h=v||(v={})).POSITION="position",h.NORMAL="normal",h.UV0="uv0",h.AUXPOS1="auxpos1",h.AUXPOS2="auxpos2",h.COLOR="color",h.SYMBOLCOLOR="symbolColor",h.SIZE="size",h.TANGENT="tangent",h.OFFSET="offset",h.SUBDIVISIONFACTOR="subdivisionFactor",h.COLORFEATUREATTRIBUTE="colorFeatureAttribute",h.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",h.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",h.DISTANCETOSTART="distanceToStart",h.UVMAPSPACE="uvMapSpace",h.BOUNDINGRECT="boundingRect",h.UVREGION="uvRegion",h.NORMALCOMPRESSED="normalCompressed",h.PROFILERIGHT="profileRight",h.PROFILEUP="profileUp",h.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",h.FEATUREVALUE="featureValue",h.MODELORIGINHI="modelOriginHi",h.MODELORIGINLO="modelOriginLo",h.MODEL="model",h.MODELNORMAL="modelNormal",h.INSTANCECOLOR="instanceColor",h.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",h.LOCALTRANSFORM="localTransform",h.GLOBALTRANSFORM="globalTransform",h.BOUNDINGSPHERE="boundingSphere",h.MODELORIGIN="modelOrigin",h.MODELSCALEFACTORS="modelScaleFactors",h.FEATUREATTRIBUTE="featureAttribute",h.STATE="state",h.LODLEVEL="lodLevel",h.POSITION0="position0",h.POSITION1="position1",h.NORMALA="normalA",h.NORMALB="normalB",h.COMPONENTINDEX="componentIndex",h.VARIANTOFFSET="variantOffset",h.VARIANTSTROKE="variantStroke",h.VARIANTEXTENSION="variantExtension",h.U8PADDING="u8padding",h.U16PADDING="u16padding",h.SIDENESS="sideness",h.START="start",h.END="end",h.UP="up",h.EXTRUDE="extrude",h.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",h.OBJECTANDLAYERIDCOLOR_INSTANCED="objectAndLayerIdColor_instanced"},42743:(ue,G,d)=>{var v,h,O,x,b,C,M,I,R,F,Z,z;d.d(G,{CE:()=>M,Gv:()=>h,JJ:()=>R,Rw:()=>x,Ti:()=>Z,V_:()=>C,Vr:()=>v,Yg:()=>I,hU:()=>b}),(z=v||(v={}))[z.None=0]="None",z[z.Front=1]="Front",z[z.Back=2]="Back",z[z.COUNT=3]="COUNT",function(z){z[z.Less=0]="Less",z[z.Lequal=1]="Lequal",z[z.COUNT=2]="COUNT"}(h||(h={})),function(z){z[z.BACKGROUND=0]="BACKGROUND",z[z.UPDATE=1]="UPDATE"}(O||(O={})),function(z){z[z.NOT_LOADED=0]="NOT_LOADED",z[z.LOADING=1]="LOADING",z[z.LOADED=2]="LOADED"}(x||(x={})),function(z){z[z.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",z[z.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(b||(b={})),function(z){z[z.Highlight=0]="Highlight",z[z.MaskOccludee=1]="MaskOccludee",z[z.COUNT=2]="COUNT"}(C||(C={})),function(z){z[z.STRETCH=1]="STRETCH",z[z.PAD=2]="PAD"}(M||(M={})),function(z){z[z.CHANGED=0]="CHANGED",z[z.UNCHANGED=1]="UNCHANGED"}(I||(I={})),function(z){z[z.Blend=0]="Blend",z[z.Opaque=1]="Opaque",z[z.Mask=2]="Mask",z[z.MaskBlend=3]="MaskBlend",z[z.COUNT=4]="COUNT"}(R||(R={})),function(z){z[z.OFF=0]="OFF",z[z.ON=1]="ON"}(F||(F={})),function(z){z.DDS_ENCODING="image/vnd-ms.dds",z.KTX2_ENCODING="image/ktx2",z.BASIS_ENCODING="image/x.basis"}(Z||(Z={}))},77172:(ue,G,d)=>{d.d(G,{hf:()=>D,ow:()=>Q});var v=d(39114),h=d(16396),O=d(67969),x=d(40852);new x.G(h.T.POSITION,3,O.g.FLOAT,0,12),new x.G(h.T.POSITION,3,O.g.FLOAT,0,20),new x.G(h.T.UV0,2,O.g.FLOAT,12,20),new x.G(h.T.POSITION,3,O.g.FLOAT,0,32),new x.G(h.T.NORMAL,3,O.g.FLOAT,12,32),new x.G(h.T.UV0,2,O.g.FLOAT,24,32),new x.G(h.T.POSITION,3,O.g.FLOAT,0,16),new x.G(h.T.COLOR,4,O.g.UNSIGNED_BYTE,12,16);const R=[new x.G(h.T.POSITION,2,O.g.FLOAT,0,8)],F=[new x.G(h.T.POSITION,2,O.g.FLOAT,0,16),new x.G(h.T.UV0,2,O.g.FLOAT,8,16)];var Z=d(76438),z=d(83994),X=d(55086);function Q(L,j=R,U=v.i,y=-1,K=1){let Y=null;return Y=j===F?new Float32Array([y,y,0,0,K,y,1,0,y,K,0,1,K,K,1,1]):new Float32Array([y,y,K,y,y,K,K,K]),new Z.U(L,U,{geometry:j},{geometry:z.f.createVertex(L,O.l1.STATIC_DRAW,Y)})}function D(L){return new X.x(L,{target:O.No.TEXTURE_2D,pixelFormat:O.VI.RGBA,dataType:O.Br.UNSIGNED_BYTE,samplingMode:O.cw.NEAREST,width:1,height:1},new Uint8Array([255,255,255,255]))}},17962:(ue,G,d)=>{d.d(G,{PV:()=>F,TU:()=>Z,bA:()=>z,sX:()=>I});var v=d(21286);function C(D,L,j){const U=j.parameters,y=j.paddingPixelsOverride;return B.scale=Math.min(U.divisor/(L-U.offset),1),B.factor=function b(D){return Math.abs(D*D*D)}(D),B.minPixelSize=U.minPixelSize,B.paddingPixels=y,B}function M(D,L){return 0===D?L.minPixelSize:L.minPixelSize*(1+2*L.paddingPixels/D)}function I(D,L){return Math.max((0,v.t7)(D*L.scale,D,L.factor),M(D,L))}function F(D,L,j,U){U.scale=function R(D,L,j){const U=C(D,L,j);return U.minPixelSize=0,U.paddingPixels=0,I(1,U)}(D,L,j),U.factor=0,U.minPixelSize=j.parameters.minPixelSize,U.paddingPixels=j.paddingPixelsOverride}function Z(D,L,j=[0,0]){const U=Math.min(Math.max(L.scale,M(D[1],L)/Math.max(1e-5,D[1])),1);return j[0]=D[0]*U,j[1]=D[1]*U,j}function z(D,L,j,U){return I(D,C(L,j,U))}d(59617),(0,v.Vl)(10),(0,v.Vl)(12),(0,v.Vl)(70),(0,v.Vl)(40);const B={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},40841:(ue,G,d)=>{d.d(G,{W9:()=>j,yn:()=>z});var v=d(62208),h=d(30217),O=d(550),x=d(28347),b=d(43703),C=d(48977),M=d(78451),I=d(84161),R=d(14658),F=d(28093),Z=d(97126);class z{constructor(){this._transform=(0,b.c)(),this._transformInverse=new X({value:this._transform},x.a,b.c),this._transformInverseTranspose=new X(this._transformInverse,x.t,b.c),this._transformTranspose=new X({value:this._transform},x.t,b.c),this._transformInverseRotation=new X({value:this._transform},h.n,O.c)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(A){(0,x.c)(this._transform,A)}multiplyTransform(A){(0,x.m)(this._transform,this._transform,A)}set(A){(0,x.c)(this._transform,A),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(A,S){this.setTransformMatrix(A),this.multiplyTransform(S),this._invalidateLazyTransforms()}}class X{constructor(A,S,w){this._original=A,this._update=S,this._dirty=!0,this._transform=w()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}}const ae=(0,F.c)(),ee=(0,F.c)(),B=(0,F.c)(),L=new class D{constructor(A=0){this.offset=A,this.sphere=(0,Z.c)(),this.tmpVertex=(0,F.c)()}applyToVertex(A,S,w){const W=this.objectTransform.transform;let N=W[0]*A+W[4]*S+W[8]*w+W[12],k=W[1]*A+W[5]*S+W[9]*w+W[13],de=W[2]*A+W[6]*S+W[10]*w+W[14];const he=this.offset/Math.sqrt(N*N+k*k+de*de);N+=N*he,k+=k*he,de+=de*he;const ne=this.objectTransform.inverse;return this.tmpVertex[0]=ne[0]*N+ne[4]*k+ne[8]*de+ne[12],this.tmpVertex[1]=ne[1]*N+ne[5]*k+ne[9]*de+ne[13],this.tmpVertex[2]=ne[2]*N+ne[6]*k+ne[10]*de+ne[14],this.tmpVertex}applyToMinMax(A,S){const w=this.offset/Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);A[0]+=A[0]*w,A[1]+=A[1]*w,A[2]+=A[2]*w;const W=this.offset/Math.sqrt(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]);S[0]+=S[0]*W,S[1]+=S[1]*W,S[2]+=S[2]*W}applyToAabb(A){const S=this.offset/Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);A[0]+=A[0]*S,A[1]+=A[1]*S,A[2]+=A[2]*S;const w=this.offset/Math.sqrt(A[3]*A[3]+A[4]*A[4]+A[5]*A[5]);return A[3]+=A[3]*w,A[4]+=A[4]*w,A[5]+=A[5]*w,A}applyToBoundingSphere(A){const S=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),w=this.offset/S;return this.sphere[0]=A[0]+A[0]*w,this.sphere[1]=A[1]+A[1]*w,this.sphere[2]=A[2]+A[2]*w,this.sphere[3]=A[3]+A[3]*this.offset/S,this.sphere}};function j(V){return(0,v.pC)(V)?(L.offset=V,L):null}new class H{constructor(A=0){this.componentLocalOriginLength=0,this._tmpVertex=(0,F.c)(),this._mbs=(0,Z.c)(),this._obb={center:(0,F.c)(),halfSize:(0,R.c)(),quaternion:null},this._totalOffset=0,this._offset=0,this._resetOffset(A)}_resetOffset(A){this._offset=A,this._totalOffset=A}set offset(A){this._resetOffset(A)}get offset(){return this._offset}set componentOffset(A){this._totalOffset=this._offset+A}set localOrigin(A){this.componentLocalOriginLength=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2])}applyToVertex(A,S,w){const W=A,N=S,k=w+this.componentLocalOriginLength,de=this._totalOffset/Math.sqrt(W*W+N*N+k*k);return this._tmpVertex[0]=A+W*de,this._tmpVertex[1]=S+N*de,this._tmpVertex[2]=w+k*de,this._tmpVertex}applyToAabb(A){const S=A[0],w=A[1],W=A[2]+this.componentLocalOriginLength,N=A[3],k=A[4],de=A[5]+this.componentLocalOriginLength,he=S*N<0?0:Math.min(Math.abs(S),Math.abs(N)),ne=w*k<0?0:Math.min(Math.abs(w),Math.abs(k)),le=W*de<0?0:Math.min(Math.abs(W),Math.abs(de)),me=Math.sqrt(he*he+ne*ne+le*le);if(me<this._totalOffset)return A[0]-=S<0?this._totalOffset:0,A[1]-=w<0?this._totalOffset:0,A[2]-=W<0?this._totalOffset:0,A[3]+=N>0?this._totalOffset:0,A[4]+=k>0?this._totalOffset:0,A[5]+=de>0?this._totalOffset:0,A;const J=Math.max(Math.abs(S),Math.abs(N)),oe=Math.max(Math.abs(w),Math.abs(k)),ve=Math.max(Math.abs(W),Math.abs(de)),Te=Math.sqrt(J*J+oe*oe+ve*ve),Me=this._totalOffset/Te,Ee=this._totalOffset/me;return A[0]+=S*(S>0?Me:Ee),A[1]+=w*(w>0?Me:Ee),A[2]+=W*(W>0?Me:Ee),A[3]+=N*(N<0?Me:Ee),A[4]+=k*(k<0?Me:Ee),A[5]+=de*(de<0?Me:Ee),A}applyToMbs(A){const S=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),w=this._totalOffset/S;return this._mbs[0]=A[0]+A[0]*w,this._mbs[1]=A[1]+A[1]*w,this._mbs[2]=A[2]+A[2]*w,this._mbs[3]=A[3]+A[3]*this._totalOffset/S,this._mbs}applyToObb(A){const S=A.center,w=this._totalOffset/Math.sqrt(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]);this._obb.center[0]=S[0]+S[0]*w,this._obb.center[1]=S[1]+S[1]*w,this._obb.center[2]=S[2]+S[2]*w,(0,I.q)(this._obb.halfSize,A.halfSize,A.quaternion),(0,I.a)(this._obb.halfSize,this._obb.halfSize,A.center);const W=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);return this._obb.halfSize[0]+=this._obb.halfSize[0]*W,this._obb.halfSize[1]+=this._obb.halfSize[1]*W,this._obb.halfSize[2]+=this._obb.halfSize[2]*W,(0,I.b)(this._obb.halfSize,this._obb.halfSize,A.center),(0,C.c)(ie,A.quaternion),(0,I.q)(this._obb.halfSize,this._obb.halfSize,ie),this._obb.halfSize[0]*=this._obb.halfSize[0]<0?-1:1,this._obb.halfSize[1]*=this._obb.halfSize[1]<0?-1:1,this._obb.halfSize[2]*=this._obb.halfSize[2]<0?-1:1,this._obb.quaternion=A.quaternion,this._obb}},new class Q{constructor(A=0){this.offset=A,this.tmpVertex=(0,F.c)()}applyToVertex(A,S,w){const W=A+this.localOrigin[0],N=S+this.localOrigin[1],k=w+this.localOrigin[2],de=this.offset/Math.sqrt(W*W+N*N+k*k);return this.tmpVertex[0]=A+W*de,this.tmpVertex[1]=S+N*de,this.tmpVertex[2]=w+k*de,this.tmpVertex}applyToAabb(A){for(let N=0;N<3;++N)ae[N]=A[0+N]+this.localOrigin[N],ee[N]=A[3+N]+this.localOrigin[N],B[N]=ae[N];const S=this.applyToVertex(ae[0],ae[1],ae[2]);for(let N=0;N<3;++N)A[N]=S[N],A[N+3]=S[N];const w=N=>{const k=this.applyToVertex(N[0],N[1],N[2]);for(let de=0;de<3;++de)A[de+0]=Math.min(A[de+0],k[de]),A[de+3]=Math.max(A[de+3],k[de])};for(let N=1;N<8;++N){for(let k=0;k<3;++k)B[k]=N&1<<k?ee[k]:ae[k];w(B)}let W=0;for(let N=0;N<3;++N)ae[N]*ee[N]<0&&(W|=1<<N);if(0!==W&&7!==W)for(let N=0;N<8;++N)if(!(W&N)){for(let k=0;k<3;++k)B[k]=W[k]?0:N&1<<k?ae[k]:ee[k];w(B)}for(let N=0;N<3;++N)A[N+0]-=this.localOrigin[N],A[N+3]-=this.localOrigin[N];return A}};const ie=(0,M.a)()},82244:(ue,G,d)=>{d.d(G,{AM:()=>O,Eg:()=>x,Mi:()=>h,Ur:()=>b});var v=d(28093);class h{constructor(M=(0,v.c)()){this.intensity=M}}class O{constructor(M=(0,v.c)(),I=(0,v.f)(.57735,.57735,.57735)){this.intensity=M,this.direction=I}}class x{constructor(M=(0,v.c)(),I=(0,v.f)(.57735,.57735,.57735),R=!0,F=1,Z=1){this.intensity=M,this.direction=I,this.castShadows=R,this.specularStrength=F,this.environmentStrength=Z}}class b{constructor(){this.r=[0],this.g=[0],this.b=[0]}}},95279:(ue,G,d)=>{d.d(G,{c:()=>re,V:()=>Y});var v=d(21286),h=d(84161),O=d(28093),x=d(82244);function C(V,A,S){(S=S||V).length=V.length;for(let w=0;w<V.length;w++)S[w]=V[w]*A[w];return S}function M(V,A,S){(S=S||V).length=V.length;for(let w=0;w<V.length;w++)S[w]=V[w]*A;return S}function I(V,A,S){(S=S||V).length=V.length;for(let w=0;w<V.length;w++)S[w]=V[w]+A[w];return S}function R(V){return(V+1)*(V+1)}function Z(V,A,S){const w=V[0],W=V[1],N=V[2],k=S||[];return k.length=R(A),A>=0&&(k[0]=.28209479177),A>=1&&(k[1]=.4886025119*w,k[2]=.4886025119*N,k[3]=.4886025119*W),A>=2&&(k[4]=1.09254843059*w*W,k[5]=1.09254843059*W*N,k[6]=.31539156525*(3*N*N-1),k[7]=1.09254843059*w*N,k[8]=.54627421529*(w*w-W*W)),k}function ae(V,A,S,w){(function z(V,A){const S=R(V),w=A||{r:[],g:[],b:[]};w.r.length=w.g.length=w.b.length=S;for(let W=0;W<S;W++)w.r[W]=w.g[W]=w.b[W]=0})(A,w),(0,h.s)(S.intensity,0,0,0);let W=!1;const N=ee,k=B,de=H;N.length=0,k.length=0,de.length=0;for(const he of V)he instanceof x.Eg&&!W?((0,h.c)(S.direction,he.direction),(0,h.c)(S.intensity,he.intensity),S.specularStrength=he.specularStrength,S.environmentStrength=he.environmentStrength,S.castShadows=he.castShadows,W=!0):he instanceof x.Eg||he instanceof x.AM?N.push(he):he instanceof x.Mi?k.push(he):he instanceof x.Ur&&de.push(he);(function X(V,A){const S=function F(V){return(0,v.uZ)(Math.floor(Math.sqrt(V)-1),0,2)}(A.r.length);for(const w of V)(0,h.o)(j,w.direction),Z(j,S,D),C(D,U),M(D,w.intensity[0],L),I(A.r,L),M(D,w.intensity[1],L),I(A.g,L),M(D,w.intensity[2],L),I(A.b,L);return A})(N,w),function Q(V,A){Z(j,0,D);for(const S of V)A.r[0]+=D[0]*U[0]*S.intensity[0]*4*Math.PI,A.g[0]+=D[0]*U[0]*S.intensity[1]*4*Math.PI,A.b[0]+=D[0]*U[0]*S.intensity[2]*4*Math.PI}(k,w);for(const he of de)I(w.r,he.r),I(w.g,he.g),I(w.b,he.b)}const ee=[],B=[],H=[],D=[0],L=[0],j=(0,O.c)(),U=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class y{constructor(){this.color=(0,O.c)(),this.intensity=1}}class K{constructor(){this.direction=(0,O.c)(),this.ambient=new y,this.diffuse=new y}}const Y=.4;class re{constructor(){this._shOrder=2,this._legacy=new K,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new x.Ur,this._mainLight=new x.Eg((0,O.c)(),(0,O.f)(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(A){ae(A,this._shOrder,this._mainLight,this._sphericalHarmonics),(0,h.c)(this._legacy.direction,this._mainLight.direction);const S=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*S,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*S,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*S,(0,h.g)(this._legacy.diffuse.color,this._mainLight.intensity,S),(0,h.c)(ie,this._legacy.diffuse.color),(0,h.g)(ie,ie,Y*this.globalFactor),(0,h.a)(this._legacy.ambient.color,this._legacy.ambient.color,ie)}copyFrom(A){this._sphericalHarmonics.r=Array.from(A.sh.r),this._sphericalHarmonics.g=Array.from(A.sh.g),this._sphericalHarmonics.b=Array.from(A.sh.b),this._mainLight.direction=(0,O.a)(A.mainLight.direction),this._mainLight.intensity=(0,O.a)(A.mainLight.intensity),this._mainLight.castShadows=A.mainLight.castShadows,this._mainLight.specularStrength=A.mainLight.specularStrength,this._mainLight.environmentStrength=A.mainLight.environmentStrength,this.globalFactor=A.globalFactor,this.noonFactor=A.noonFactor}lerpLighting(A,S,w){if((0,h.h)(this._mainLight.intensity,A.mainLight.intensity,S.mainLight.intensity,w),this._mainLight.environmentStrength=(0,v.t7)(A.mainLight.environmentStrength,S.mainLight.environmentStrength,w),this._mainLight.specularStrength=(0,v.t7)(A.mainLight.specularStrength,S.mainLight.specularStrength,w),(0,h.c)(this._mainLight.direction,S.mainLight.direction),this._mainLight.castShadows=S.mainLight.castShadows,this.globalFactor=(0,v.t7)(A.globalFactor,S.globalFactor,w),this.noonFactor=(0,v.t7)(A.noonFactor,S.noonFactor,w),A.sh.r.length===S.sh.r.length)for(let W=0;W<S.sh.r.length;W++)this._sphericalHarmonics.r[W]=(0,v.t7)(A.sh.r[W],S.sh.r[W],w),this._sphericalHarmonics.g[W]=(0,v.t7)(A.sh.g[W],S.sh.g[W],w),this._sphericalHarmonics.b[W]=(0,v.t7)(A.sh.b[W],S.sh.b[W],w);else for(let W=0;W<S.sh.r.length;W++)this._sphericalHarmonics.r[W]=S.sh.r[W],this._sphericalHarmonics.g[W]=S.sh.g[W],this._sphericalHarmonics.b[W]=S.sh.b[W]}}const ie=(0,O.c)()},2770:(ue,G,d)=>{d.d(G,{G:()=>O});var v=d(16396),h=d(42037);class O{constructor(b){this.vertexBufferLayout=b}allocate(b){return this.vertexBufferLayout.createBuffer(b)}elementCount(b){return b.indices.get(v.T.POSITION).length}write(b,C,M,I,R){(0,h.NK)(M,this.vertexBufferLayout,b,C,I,R)}}},41528:(ue,G,d)=>{d.d(G,{W:()=>x});var v=d(17626),h=d(37847),O=d(87601);class x extends O.m{constructor(){super(...arguments),this.hasWebGL2Context=!1}}(0,v._)([(0,O.o)({constValue:!0})],x.prototype,"hasSliceHighlight",void 0),(0,v._)([(0,O.o)({constValue:!1})],x.prototype,"hasSliceInVertexProgram",void 0),(0,v._)([(0,O.o)({constValue:!1})],x.prototype,"instancedDoublePrecision",void 0),(0,v._)([(0,O.o)({constValue:!1})],x.prototype,"useLegacyTerrainShading",void 0),(0,v._)([(0,O.o)({constValue:!1})],x.prototype,"hasModelTransformation",void 0),(0,v._)([(0,O.o)({constValue:h.P.Pass})],x.prototype,"pbrTextureBindType",void 0),(0,v._)([(0,O.o)()],x.prototype,"hasWebGL2Context",void 0)},41857:(ue,G,d)=>{d.d(G,{n:()=>x,x:()=>b});var v=d(550),h=d(28093),O=d(40723);class x extends O.Mt{constructor(){super(...arguments),this.vvSizeEnabled=!1,this.vvSizeMinSize=(0,h.f)(1,1,1),this.vvSizeMaxSize=(0,h.f)(100,100,100),this.vvSizeOffset=(0,h.f)(0,0,0),this.vvSizeFactor=(0,h.f)(1,1,1),this.vvSizeValue=(0,h.f)(1,1,1),this.vvColorEnabled=!1,this.vvColorValues=[0,0,0,0,0,0,0,0],this.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],this.vvOpacityEnabled=!1,this.vvOpacityValues=[0,0,0,0,0,0,0,0],this.vvOpacityOpacities=[1,1,1,1,1,1,1,1],this.vvSymbolAnchor=[0,0,0],this.vvSymbolRotationMatrix=(0,v.c)()}}const b=8},57623:(ue,G,d)=>{d.d(G,{Bw:()=>z,CN:()=>ee,FZ:()=>V,Hx:()=>K,LO:()=>re,Tw:()=>U,Uf:()=>Y});var v=d(85931),h=d(21286),O=d(62208),x=d(84161),b=d(28093),C=d(5548),M=d(24425),I=d(17962),R=d(2282),F=d(16396);const Z=(0,C.Ue)();function z(S,w,W,N,k,de){if(S.visible)if(S.boundingInfo)(0,R.hu)(S.type===M.U.Mesh),Q(S.boundingInfo,W,N,w.tolerance,k,de);else{const he=S.indices.get(F.T.POSITION),ne=S.vertexAttributes.get(F.T.POSITION);ee(W,N,0,he.length/3,he,ne,void 0,k,de)}}const X=(0,b.c)();function Q(S,w,W,N,k,de){if((0,O.Wi)(S))return;const he=function j(S,w,W){return(0,x.s)(W,1/(w[0]-S[0]),1/(w[1]-S[1]),1/(w[2]-S[2]))}(w,W,X);if((0,C.op)(Z,S.bbMin),(0,C.Tn)(Z,S.bbMax),(0,O.pC)(k)&&k.applyToAabb(Z),U(Z,w,he,N)){const{primitiveIndices:ne,indices:le,position:me}=S,J=ne?ne.length:le.length/3;if(J>A){const oe=S.getChildren();if(void 0!==oe){for(const ve of oe)Q(ve,w,W,N,k,de);return}}ee(w,W,0,J,le,me,ne,k,de)}}const ae=(0,b.c)();function ee(S,w,W,N,k,de,he,ne,le){if(he)return function B(S,w,W,N,k,de,he,ne,le){const{data:me,stride:J}=de,oe=S[0],ve=S[1],Te=S[2],Me=w[0]-oe,Ee=w[1]-ve,$=w[2]-Te;for(let te=W;te<N;++te){const pe=he[te];let fe=3*pe,ge=J*k[fe++],Oe=me[ge++],xe=me[ge++],Re=me[ge];ge=J*k[fe++];let Se=me[ge++],be=me[ge++],Le=me[ge];ge=J*k[fe];let Fe=me[ge++],we=me[ge++],Ne=me[ge];(0,O.pC)(ne)&&([Oe,xe,Re]=ne.applyToVertex(Oe,xe,Re,te),[Se,be,Le]=ne.applyToVertex(Se,be,Le,te),[Fe,we,Ne]=ne.applyToVertex(Fe,we,Ne,te));const We=Se-Oe,je=be-xe,Be=Le-Re,ze=Fe-Oe,ce=we-xe,q=Ne-Re,_e=Ee*q-ce*$,se=$*ze-q*Me,Pe=Me*ce-ze*Ee,Ae=We*_e+je*se+Be*Pe;if(Math.abs(Ae)<=Number.EPSILON)continue;const De=oe-Oe,Ie=ve-xe,Ce=Te-Re,Ue=De*_e+Ie*se+Ce*Pe;if(Ae>0){if(Ue<0||Ue>Ae)continue}else if(Ue>0||Ue<Ae)continue;const ye=Ie*Be-je*Ce,Ge=Ce*We-Be*De,Ke=De*je-We*Ie,He=Me*ye+Ee*Ge+$*Ke;if(Ae>0){if(He<0||Ue+He>Ae)continue}else if(He>0||Ue+He<Ae)continue;const Ve=(ze*ye+ce*Ge+q*Ke)/Ae;Ve>=0&&le(Ve,L(We,je,Be,ze,ce,q,ae),pe,!1)}}(S,w,W,N,k,de,he,ne,le);const{data:me,stride:J}=de,oe=S[0],ve=S[1],Te=S[2],Me=w[0]-oe,Ee=w[1]-ve,$=w[2]-Te;for(let te=W,pe=3*W;te<N;++te){let fe=J*k[pe++],ge=me[fe++],Oe=me[fe++],xe=me[fe];fe=J*k[pe++];let Re=me[fe++],Se=me[fe++],be=me[fe];fe=J*k[pe++];let Le=me[fe++],Fe=me[fe++],we=me[fe];(0,O.pC)(ne)&&([ge,Oe,xe]=ne.applyToVertex(ge,Oe,xe,te),[Re,Se,be]=ne.applyToVertex(Re,Se,be,te),[Le,Fe,we]=ne.applyToVertex(Le,Fe,we,te));const Ne=Re-ge,We=Se-Oe,je=be-xe,Be=Le-ge,ze=Fe-Oe,ce=we-xe,q=Ee*ce-ze*$,_e=$*Be-ce*Me,se=Me*ze-Be*Ee,Pe=Ne*q+We*_e+je*se;if(Math.abs(Pe)<=Number.EPSILON)continue;const Ae=oe-ge,De=ve-Oe,Ie=Te-xe,Ce=Ae*q+De*_e+Ie*se;if(Pe>0){if(Ce<0||Ce>Pe)continue}else if(Ce>0||Ce<Pe)continue;const Ue=De*je-We*Ie,ye=Ie*Ne-je*Ae,Ge=Ae*We-Ne*De,Ke=Me*Ue+Ee*ye+$*Ge;if(Pe>0){if(Ke<0||Ce+Ke>Pe)continue}else if(Ke>0||Ce+Ke<Pe)continue;const He=(Be*Ue+ze*ye+ce*Ge)/Pe;He>=0&&le(He,L(Ne,We,je,Be,ze,ce,ae),te,!1)}}const H=(0,b.c)(),D=(0,b.c)();function L(S,w,W,N,k,de,he){return(0,x.s)(H,S,w,W),(0,x.s)(D,N,k,de),(0,x.f)(he,H,D),(0,x.n)(he,he),he}function U(S,w,W,N){return function y(S,w,W,N,k){const de=(S[0]-N-w[0])*W[0],he=(S[3]+N-w[0])*W[0];let ne=Math.min(de,he),le=Math.max(de,he);const me=(S[1]-N-w[1])*W[1],J=(S[4]+N-w[1])*W[1];if(le=Math.min(le,Math.max(me,J)),le<0||(ne=Math.max(ne,Math.min(me,J)),ne>le))return!1;const oe=(S[2]-N-w[2])*W[2],ve=(S[5]+N-w[2])*W[2];return le=Math.min(le,Math.max(oe,ve)),!(le<0)&&(ne=Math.max(ne,Math.min(oe,ve)),!(ne>le)&&ne<k)}(S,w,W,N,1/0)}function K(S,w,W,N,k){let de=(W.screenLength||0)*S.pixelRatio;(0,O.pC)(k)&&(de=(0,I.bA)(de,N,w,k));const he=de*Math.tan(.5*S.fovY)/(.5*S.fullHeight);return(0,h.uZ)(he*w,W.minWorldLength||0,null!=W.maxWorldLength?W.maxWorldLength:1/0)}function Y(S,w){const W=w?Y(w):{};for(const N in S){let k=S[N];k&&k.forEach&&(k=ie(k)),null==k&&N in W||(W[N]=k)}return W}function re(S,w){let W=!1;for(const N in w){const k=w[N];void 0!==k&&(Array.isArray(k)?null===S[N]?(S[N]=k.slice(),W=!0):(0,v.Vx)(S[N],k)&&(W=!0):S[N]!==k&&(W=!0,S[N]=k))}return W}function ie(S){const w=[];return S.forEach(W=>w.push(W)),w}const V={multiply:1,ignore:2,replace:3,tint:4},A=1e3},42037:(ue,G,d)=>{d.d(G,{NK:()=>H,SW:()=>R,Vs:()=>ee,h:()=>F,ho:()=>X,s5:()=>Q,xP:()=>B});var v=d(62208),h=d(28347),O=d(60479),x=d(2282),b=d(16396);function M(D,L,j,U){const y=j.typedBuffer,K=j.typedBufferStride,Y=D.length;U*=K;for(let re=0;re<Y;++re){const ie=2*D[re];y[U]=L[ie],y[U+1]=L[ie+1],U+=K}}function I(D,L,j,U,y){const K=j.typedBuffer,Y=j.typedBufferStride,re=D.length;if(U*=Y,null==y||1===y)for(let ie=0;ie<re;++ie){const V=3*D[ie];K[U]=L[V],K[U+1]=L[V+1],K[U+2]=L[V+2],U+=Y}else for(let ie=0;ie<re;++ie){const V=3*D[ie];for(let A=0;A<y;++A)K[U]=L[V],K[U+1]=L[V+1],K[U+2]=L[V+2],U+=Y}}function R(D,L,j,U,y=1){const K=j.typedBuffer,Y=j.typedBufferStride,re=D.length;if(U*=Y,1===y)for(let ie=0;ie<re;++ie){const V=4*D[ie];K[U]=L[V],K[U+1]=L[V+1],K[U+2]=L[V+2],K[U+3]=L[V+3],U+=Y}else for(let ie=0;ie<re;++ie){const V=4*D[ie];for(let A=0;A<y;++A)K[U]=L[V],K[U+1]=L[V+1],K[U+2]=L[V+2],K[U+3]=L[V+3],U+=Y}}function F(D,L,j){const U=D.typedBuffer,y=D.typedBufferStride;L*=y;for(let K=0;K<j;++K)U[L]=0,U[L+1]=0,U[L+2]=0,U[L+3]=0,L+=y}function X(D,L,j,U,y,K=1){if(!j)return void I(D,L,U,y,K);const Y=U.typedBuffer,re=U.typedBufferStride,ie=D.length,V=j[0],A=j[1],S=j[2],w=j[4],W=j[5],N=j[6],k=j[8],de=j[9],he=j[10],ne=j[12],le=j[13],me=j[14];y*=re;let J=0,oe=0,ve=0;const Te=(0,h.y)(j)?Me=>{J=L[Me]+ne,oe=L[Me+1]+le,ve=L[Me+2]+me}:Me=>{const Ee=L[Me],$=L[Me+1],te=L[Me+2];J=V*Ee+w*$+k*te+ne,oe=A*Ee+W*$+de*te+le,ve=S*Ee+N*$+he*te+me};if(1===K)for(let Me=0;Me<ie;++Me)Te(3*D[Me]),Y[y]=J,Y[y+1]=oe,Y[y+2]=ve,y+=re;else for(let Me=0;Me<ie;++Me){Te(3*D[Me]);for(let Ee=0;Ee<K;++Ee)Y[y]=J,Y[y+1]=oe,Y[y+2]=ve,y+=re}}function Q(D,L,j,U,y,K=1){if(!j)return void I(D,L,U,y,K);const Y=j,re=U.typedBuffer,ie=U.typedBufferStride,V=D.length,A=Y[0],S=Y[1],w=Y[2],W=Y[4],N=Y[5],k=Y[6],de=Y[8],he=Y[9],ne=Y[10],le=!(0,h.z)(Y),me=1e-6,J=1-me;y*=ie;let oe=0,ve=0,Te=0;const Me=(0,h.y)(Y)?Ee=>{oe=L[Ee],ve=L[Ee+1],Te=L[Ee+2]}:Ee=>{const $=L[Ee],te=L[Ee+1],pe=L[Ee+2];oe=A*$+W*te+de*pe,ve=S*$+N*te+he*pe,Te=w*$+k*te+ne*pe};if(1===K)if(le)for(let Ee=0;Ee<V;++Ee){Me(3*D[Ee]);const $=oe*oe+ve*ve+Te*Te;if($<J&&$>me){const te=1/Math.sqrt($);re[y]=oe*te,re[y+1]=ve*te,re[y+2]=Te*te}else re[y]=oe,re[y+1]=ve,re[y+2]=Te;y+=ie}else for(let Ee=0;Ee<V;++Ee)Me(3*D[Ee]),re[y]=oe,re[y+1]=ve,re[y+2]=Te,y+=ie;else for(let Ee=0;Ee<V;++Ee){if(Me(3*D[Ee]),le){const $=oe*oe+ve*ve+Te*Te;if($<J&&$>me){const te=1/Math.sqrt($);oe*=te,ve*=te,Te*=te}}for(let $=0;$<K;++$)re[y]=oe,re[y+1]=ve,re[y+2]=Te,y+=ie}}function ae(D,L,j,U,y,K=1){if(!j)return void R(D,L,U,y,K);const re=U.typedBuffer,ie=U.typedBufferStride,V=D.length,A=j[0],S=j[1],w=j[2],W=j[4],N=j[5],k=j[6],de=j[8],he=j[9],ne=j[10],le=!(0,h.z)(j),me=1e-6,J=1-me;if(y*=ie,1===K)for(let oe=0;oe<V;++oe){const ve=4*D[oe],Te=L[ve],Me=L[ve+1],Ee=L[ve+2],$=L[ve+3];let te=A*Te+W*Me+de*Ee,pe=S*Te+N*Me+he*Ee,fe=w*Te+k*Me+ne*Ee;if(le){const ge=te*te+pe*pe+fe*fe;if(ge<J&&ge>me){const Oe=1/Math.sqrt(ge);te*=Oe,pe*=Oe,fe*=Oe}}re[y]=te,re[y+1]=pe,re[y+2]=fe,re[y+3]=$,y+=ie}else for(let oe=0;oe<V;++oe){const ve=4*D[oe],Te=L[ve],Me=L[ve+1],Ee=L[ve+2],$=L[ve+3];let te=A*Te+W*Me+de*Ee,pe=S*Te+N*Me+he*Ee,fe=w*Te+k*Me+ne*Ee;if(le){const ge=te*te+pe*pe+fe*fe;if(ge<J&&ge>me){const Oe=1/Math.sqrt(ge);te*=Oe,pe*=Oe,fe*=Oe}}for(let ge=0;ge<K;++ge)re[y]=te,re[y+1]=pe,re[y+2]=fe,re[y+3]=$,y+=ie}}function ee(D,L,j,U,y,K=1){const Y=U.typedBuffer,re=U.typedBufferStride,ie=D.length;if(y*=re,j!==L.length||4!==j)if(1!==K)if(4!==j)for(let V=0;V<ie;++V){const A=3*D[V];for(let S=0;S<K;++S)Y[y]=L[A],Y[y+1]=L[A+1],Y[y+2]=L[A+2],Y[y+3]=255,y+=re}else for(let V=0;V<ie;++V){const A=4*D[V];for(let S=0;S<K;++S)Y[y]=L[A],Y[y+1]=L[A+1],Y[y+2]=L[A+2],Y[y+3]=L[A+3],y+=re}else{if(4===j){for(let V=0;V<ie;++V){const A=4*D[V];Y[y]=L[A],Y[y+1]=L[A+1],Y[y+2]=L[A+2],Y[y+3]=L[A+3],y+=re}return}for(let V=0;V<ie;++V){const A=3*D[V];Y[y]=L[A],Y[y+1]=L[A+1],Y[y+2]=L[A+2],Y[y+3]=255,y+=re}}else{Y[y]=L[0],Y[y+1]=L[1],Y[y+2]=L[2],Y[y+3]=L[3];const V=new Uint32Array(U.typedBuffer.buffer,U.start),A=re/4,S=V[y/=4];y+=A;const w=ie*K;for(let W=1;W<w;++W)V[y]=S,y+=A}}function B(D,L,j,U,y=1){const K=L.typedBuffer,Y=L.typedBufferStride;if(U*=Y,1===y)for(let re=0;re<j;++re)K[U]=D[0],K[U+1]=D[1],K[U+2]=D[2],K[U+3]=D[3],U+=Y;else for(let re=0;re<j;++re)for(let ie=0;ie<y;++ie)K[U]=D[0],K[U+1]=D[1],K[U+2]=D[2],K[U+3]=D[3],U+=Y}function H(D,L,j,U,y,K){for(const Y of L.fieldNames){const re=D.vertexAttributes.get(Y),ie=D.indices.get(Y);if(re&&ie)switch(Y){case b.T.POSITION:{(0,x.hu)(3===re.size);const V=y.getField(Y,O.ct);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&X(ie,re.data,j,V,K);break}case b.T.NORMAL:{(0,x.hu)(3===re.size);const V=y.getField(Y,O.ct);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&Q(ie,re.data,U,V,K);break}case b.T.UV0:{(0,x.hu)(2===re.size);const V=y.getField(Y,O.Eu);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&M(ie,re.data,V,K);break}case b.T.COLOR:case b.T.SYMBOLCOLOR:{(0,x.hu)(3===re.size||4===re.size);const V=y.getField(Y,O.mc);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&ee(ie,re.data,re.size,V,K);break}case b.T.TANGENT:{(0,x.hu)(4===re.size);const V=y.getField(Y,O.ek);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&ae(ie,re.data,U,V,K);break}case b.T.PROFILERIGHT:case b.T.PROFILEUP:case b.T.PROFILEVERTEXANDNORMAL:case b.T.FEATUREVALUE:{(0,x.hu)(4===re.size);const V=y.getField(Y,O.ek);(0,x.hu)(!!V,`No buffer view for ${Y}`),V&&R(ie,re.data,V,K)}}else if(Y===b.T.OBJECTANDLAYERIDCOLOR&&(0,v.pC)(D.objectAndLayerIdColor)){const V=D.indices.get(b.T.POSITION);if((0,x.hu)(!!V,`No buffer view for ${Y}`),V){const A=V.length,S=y.getField(Y,O.mc);B(D.objectAndLayerIdColor,S,A,K)}}}}},65073:(ue,G,d)=>{d.d(G,{EE:()=>C,U_:()=>b,lr:()=>x});var v=d(62208),h=d(28093),O=d(2757);function x(R,F){return(0,v.Wi)(R)&&(R=[]),R.push(F),R}function b(R,F){if((0,v.Wi)(R))return null;const Z=R.filter(z=>z!==F);return 0===Z.length?null:Z}function C(R,F,Z,z,X){M[0]=R.get(F,0),M[1]=R.get(F,1),M[2]=R.get(F,2),(0,O.LF)(M,I,3),Z.set(X,0,I[0]),z.set(X,0,I[1]),Z.set(X,1,I[2]),z.set(X,1,I[3]),Z.set(X,2,I[4]),z.set(X,2,I[5])}const M=(0,h.c)(),I=new Float32Array(6)},40852:(ue,G,d)=>{d.d(G,{G:()=>v});class v{constructor(O,x,b,C,M,I=!1,R=0){this.name=O,this.count=x,this.type=b,this.offset=C,this.stride=M,this.normalized=I,this.divisor=R}}},2757:(ue,G,d)=>{function v(C,M,I){for(let R=0;R<I;++R)M[2*R]=C[R],M[2*R+1]=C[R]-M[2*R]}function O(C,M){const I=C.length;for(let R=0;R<I;++R)b[0]=C[R],M[R]=b[0];return M}function x(C,M){const I=C.length;for(let R=0;R<I;++R)b[0]=C[R],b[1]=C[R]-b[0],M[R]=b[1];return M}d.d(G,{GB:()=>x,LF:()=>v,U8:()=>O});const b=new Float32Array(2)},2078:(ue,G,d)=>{d.d(G,{BK:()=>R,LZ:()=>I,if:()=>O,jp:()=>me,sg:()=>C,sm:()=>H,wK:()=>x,zp:()=>M});var v=d(42743),h=d(67969);function O(J,oe,ve=h.db.ADD,Te=[0,0,0,0]){return{srcRgb:J,srcAlpha:J,dstRgb:oe,dstAlpha:oe,opRgb:ve,opAlpha:ve,color:{r:Te[0],g:Te[1],b:Te[2],a:Te[3]}}}function x(J,oe,ve,Te,Me=h.db.ADD,Ee=h.db.ADD,$=[0,0,0,0]){return{srcRgb:J,srcAlpha:oe,dstRgb:ve,dstAlpha:Te,opRgb:Me,opAlpha:Ee,color:{r:$[0],g:$[1],b:$[2],a:$[3]}}}const b={face:h.LR.BACK,mode:h.Wf.CCW},C={face:h.LR.FRONT,mode:h.Wf.CCW},M=J=>J===v.Vr.Back?b:J===v.Vr.Front?C:null,I={zNear:0,zFar:1},R={r:!0,g:!0,b:!0,a:!0};function F(J){return j.intern(J)}function Z(J){return y.intern(J)}function z(J){return Y.intern(J)}function X(J){return ie.intern(J)}function Q(J){return A.intern(J)}function ae(J){return w.intern(J)}function ee(J){return N.intern(J)}function B(J){return de.intern(J)}function H(J){return ne.intern(J)}class D{constructor(oe,ve){this._makeKey=oe,this._makeRef=ve,this._interns=new Map}intern(oe){if(!oe)return null;const ve=this._makeKey(oe),Te=this._interns;return Te.has(ve)||Te.set(ve,this._makeRef(oe)),Te.get(ve)??null}}function L(J){return"["+J.join(",")+"]"}const j=new D(U,J=>({__tag:"Blending",...J}));function U(J){return J?L([J.srcRgb,J.srcAlpha,J.dstRgb,J.dstAlpha,J.opRgb,J.opAlpha,J.color.r,J.color.g,J.color.b,J.color.a]):null}const y=new D(K,J=>({__tag:"Culling",...J}));function K(J){return J?L([J.face,J.mode]):null}const Y=new D(re,J=>({__tag:"PolygonOffset",...J}));function re(J){return J?L([J.factor,J.units]):null}const ie=new D(V,J=>({__tag:"DepthTest",...J}));function V(J){return J?L([J.func]):null}const A=new D(S,J=>({__tag:"StencilTest",...J}));function S(J){return J?L([J.function.func,J.function.ref,J.function.mask,J.operation.fail,J.operation.zFail,J.operation.zPass]):null}const w=new D(W,J=>({__tag:"DepthWrite",...J}));function W(J){return J?L([J.zNear,J.zFar]):null}const N=new D(k,J=>({__tag:"ColorWrite",...J}));function k(J){return J?L([J.r,J.g,J.b,J.a]):null}const de=new D(he,J=>({__tag:"StencilWrite",...J}));function he(J){return J?L([J.mask]):null}const ne=new D(function le(J){return J?L([U(J.blending),K(J.culling),re(J.polygonOffset),V(J.depthTest),S(J.stencilTest),W(J.depthWrite),k(J.colorWrite),he(J.stencilWrite)]):null},J=>({blending:F(J.blending),culling:Z(J.culling),polygonOffset:z(J.polygonOffset),depthTest:X(J.depthTest),stencilTest:Q(J.stencilTest),depthWrite:ae(J.depthWrite),colorWrite:ee(J.colorWrite),stencilWrite:B(J.stencilWrite)}));class me{constructor(oe){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=oe}setPipeline(oe){(this._pipelineInvalid||oe!==this._pipeline)&&(this._setBlending(oe.blending),this._setCulling(oe.culling),this._setPolygonOffset(oe.polygonOffset),this._setDepthTest(oe.depthTest),this._setStencilTest(oe.stencilTest),this._setDepthWrite(oe.depthWrite),this._setColorWrite(oe.colorWrite),this._setStencilWrite(oe.stencilWrite),this._pipeline=oe),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}_setBlending(oe){this._blending=this._setSubState(oe,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(oe){this._culling=this._setSubState(oe,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(oe){this._polygonOffset=this._setSubState(oe,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(oe){this._depthTest=this._setSubState(oe,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(oe){this._stencilTest=this._setSubState(oe,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(oe){this._depthWrite=this._setSubState(oe,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(oe){this._colorWrite=this._setSubState(oe,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(oe){this._stencilWrite=this._setSubState(oe,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setSubState(oe,ve,Te,Me){return(Te||oe!==ve)&&(Me(oe),this._pipelineInvalid=!0),oe}}}}]);
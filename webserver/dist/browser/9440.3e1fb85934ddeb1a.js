"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[9440],{36592:(F,K,m)=>{m.d(K,{Q:()=>S});var L=m(85931),D=m(62208),b=m(77029),Y=m(14259);class S{constructor(e=9,i){this._compareMinX=j,this._compareMinY=a,this._toBBox=n=>n,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),I.prune(),W.prune(),T.prune(),c.prune()}all(e){this._all(this._data,e)}search(e,i){let n=this._data;const d=this._toBBox;if(E(e,n))for(I.clear();n;){for(let t=0,s=n.children.length;t<s;t++){const r=n.children[t],u=n.leaf?d(r):r;E(e,u)&&(n.leaf?i(r):g(e,u)?this._all(r,i):I.push(r))}n=I.pop()}}collides(e){let i=this._data;const n=this._toBBox;if(!E(e,i))return!1;for(I.clear();i;){for(let d=0,t=i.children.length;d<t;d++){const s=i.children[d],r=i.leaf?n(s):s;if(E(e,r)){if(i.leaf||g(e,r))return!0;I.push(s)}}i=I.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let n=0,d=e.length;n<d;n++)this.insert(e[n]);return this}let i=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const n=this._data;this._data=i,i=n}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new h([]),this}remove(e){if(!e)return this;let i,n=this._data,d=null,t=0,s=!1;const r=this._toBBox(e);for(T.clear(),c.clear();n||T.length>0;){if(n||(n=(0,D.j0)(T.pop()),d=T.data[T.length-1],t=c.pop()??0,s=!0),n.leaf&&(i=(0,L.cq)(n.children,e,n.children.length,n.indexHint),-1!==i))return n.children.splice(i,1),T.push(n),this._condense(T),this;s||n.leaf||!g(n,r)?d?(t++,n=d.children[t],s=!1):n=null:(T.push(n),c.push(t),t=0,d=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,i){let n=e;for(W.clear();n;){if(!0===n.leaf)for(const d of n.children)i(d);else W.pushArray(n.children);n=W.pop()??null}}_build(e,i,n,d){const t=n-i+1;let s=this._maxEntries;if(t<=s){const x=new h(e.slice(i,n+1));return v(x,this._toBBox),x}d||(d=Math.ceil(Math.log(t)/Math.log(s)),s=Math.ceil(t/s**(d-1)));const r=new p([]);r.height=d;const u=Math.ceil(t/s),B=u*Math.ceil(Math.sqrt(s));O(e,i,n,B,this._compareMinX);for(let x=i;x<=n;x+=B){const C=Math.min(x+B-1,n);O(e,x,C,u,this._compareMinY);for(let R=x;R<=C;R+=u){const X=Math.min(R+u-1,C);r.children.push(this._build(e,R,X,d-1))}}return v(r,this._toBBox),r}_chooseSubtree(e,i,n,d){for(;d.push(i),!0!==i.leaf&&d.length-1!==n;){let t,s=1/0,r=1/0;for(let u=0,B=i.children.length;u<B;u++){const x=i.children[u],C=y(x),R=A(e,x)-C;R<r?(r=R,s=C<s?C:s,t=x):R===r&&C<s&&(s=C,t=x)}i=t||i.children[0]}return i}_insert(e,i,n){const t=n?e:(0,this._toBBox)(e);T.clear();const s=this._chooseSubtree(t,this._data,i,T);for(s.children.push(e),U(s,t);i>=0&&T.data[i].children.length>this._maxEntries;)this._split(T,i),i--;this._adjustParentBBoxes(t,T,i)}_split(e,i){const n=e.data[i],d=n.children.length,t=this._minEntries;this._chooseSplitAxis(n,t,d);const s=this._chooseSplitIndex(n,t,d);if(!s)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const r=n.children.splice(s,n.children.length-s),u=n.leaf?new h(r):new p(r);u.height=n.height,v(n,this._toBBox),v(u,this._toBBox),i?e.data[i-1].children.push(u):this._splitRoot(n,u)}_splitRoot(e,i){this._data=new p([e,i]),this._data.height=e.height+1,v(this._data,this._toBBox)}_chooseSplitIndex(e,i,n){let d,t,s;d=t=1/0;for(let r=i;r<=n-i;r++){const u=P(e,0,r,this._toBBox),B=P(e,r,n,this._toBBox),x=f(u,B),C=y(u)+y(B);x<d?(d=x,s=r,t=C<t?C:t):x===d&&C<t&&(t=C,s=r)}return s}_chooseSplitAxis(e,i,n){const d=e.leaf?this._compareMinX:j,t=e.leaf?this._compareMinY:a;this._allDistMargin(e,i,n,d)<this._allDistMargin(e,i,n,t)&&e.children.sort(d)}_allDistMargin(e,i,n,d){e.children.sort(d);const t=this._toBBox,s=P(e,0,i,t),r=P(e,n-i,n,t);let u=M(s)+M(r);for(let B=i;B<n-i;B++){const x=e.children[B];U(s,e.leaf?t(x):x),u+=M(s)}for(let B=n-i-1;B>=i;B--){const x=e.children[B];U(r,e.leaf?t(x):x),u+=M(r)}return u}_adjustParentBBoxes(e,i,n){for(let d=n;d>=0;d--)U(i.data[d],e)}_condense(e){for(let i=e.length-1;i>=0;i--){const n=e.data[i];if(0===n.children.length)if(i>0){const d=e.data[i-1],t=d.children;t.splice((0,L.cq)(t,n,t.length,d.indexHint),1)}else this.clear();else v(n,this._toBBox)}}_initFormat(e){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(e[0])),this._compareMinY=new Function("a","b",i.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function v(l,e){P(l,0,l.children.length,e,l)}function P(l,e,i,n,d){d||(d=new h([])),d.minX=1/0,d.minY=1/0,d.maxX=-1/0,d.maxY=-1/0;for(let t,s=e;s<i;s++)t=l.children[s],U(d,l.leaf?n(t):t);return d}function U(l,e){l.minX=Math.min(l.minX,e.minX),l.minY=Math.min(l.minY,e.minY),l.maxX=Math.max(l.maxX,e.maxX),l.maxY=Math.max(l.maxY,e.maxY)}function j(l,e){return l.minX-e.minX}function a(l,e){return l.minY-e.minY}function y(l){return(l.maxX-l.minX)*(l.maxY-l.minY)}function M(l){return l.maxX-l.minX+(l.maxY-l.minY)}function A(l,e){return(Math.max(e.maxX,l.maxX)-Math.min(e.minX,l.minX))*(Math.max(e.maxY,l.maxY)-Math.min(e.minY,l.minY))}function f(l,e){const i=Math.max(l.minX,e.minX),n=Math.max(l.minY,e.minY),d=Math.min(l.maxX,e.maxX),t=Math.min(l.maxY,e.maxY);return Math.max(0,d-i)*Math.max(0,t-n)}function g(l,e){return l.minX<=e.minX&&l.minY<=e.minY&&e.maxX<=l.maxX&&e.maxY<=l.maxY}function E(l,e){return e.minX<=l.maxX&&e.minY<=l.maxY&&e.maxX>=l.minX&&e.maxY>=l.minY}function O(l,e,i,n,d){const t=[e,i];for(;t.length;){const s=(0,D.j0)(t.pop()),r=(0,D.j0)(t.pop());if(s-r<=n)continue;const u=r+Math.ceil((s-r)/n/2)*n;(0,Y.q)(l,u,r,s,d),t.push(r,u,u,s)}}const I=new b.Z,W=new b.Z,T=new b.Z,c=new b.Z({deallocator:void 0});class o{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class _ extends o{constructor(){super(...arguments),this.height=1,this.indexHint=new L.SO}}class h extends _{constructor(e){super(),this.children=e,this.leaf=!0}}class p extends _{constructor(e){super(),this.children=e,this.leaf=!1}}},65629:(F,K,m)=>{m.d(K,{SR:()=>j,Ui:()=>U});var L=m(62208),D=m(65401),b=m(32442),Y=m(25748),S=m(91179),v=m(74618),P=m(37053);function U(c){return a(c,!0)}function j(c){return a(c,!1)}function a(c,o){if((0,L.Wi)(c))return null;const _=c.spatialReference,h=(0,P.C5)(_),p="toJSON"in c?c.toJSON():c;if(!h)return p;const l=(0,P.sS)(_)?102100:4326,e=v.UZ[l].maxX,i=v.UZ[l].minX;if((0,S.wp)(p))return M(p,e,i);if((0,S.aW)(p))return p.points=p.points.map(n=>M(n,e,i)),p;if((0,S.YX)(p))return function y(c,o){if(!o)return c;const _=function A(c,o){const _=[],{ymin:h,ymax:p,xmin:l,xmax:e}=c,i=c.xmax-c.xmin,[n,d]=o.valid,{x:t,frameId:s}=f(c.xmin,o),{x:r,frameId:u}=f(c.xmax,o),B=t===r&&i>0;if(i>2*d){const x={xmin:l<e?t:r,ymin:h,xmax:d,ymax:p},C={xmin:n,ymin:h,xmax:l<e?r:t,ymax:p},R={xmin:0,ymin:h,xmax:d,ymax:p},X={xmin:n,ymin:h,xmax:0,ymax:p},Z=[],N=[];g(x,R)&&Z.push(s),g(x,X)&&N.push(s),g(C,R)&&Z.push(u),g(C,X)&&N.push(u);for(let w=s+1;w<u;w++)Z.push(w),N.push(w);_.push(new I(x,[s]),new I(C,[u]),new I(R,Z),new I(X,N))}else t>r||B?_.push(new I({xmin:t,ymin:h,xmax:d,ymax:p},[s]),new I({xmin:n,ymin:h,xmax:r,ymax:p},[u])):_.push(new I({xmin:t,ymin:h,xmax:r,ymax:p},[s]));return _}(c,o).map(h=>h.extent);return _.length<2?_[0]||c:_.length>2?(c.xmin=o.valid[0],c.xmax=o.valid[1],c):{rings:_.map(h=>[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]])}}(p,h);if((0,S.oU)(p)||(0,S.l9)(p)){const n=(0,b.$P)(W,p),d={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},t=(0,v.XZ)(d.xmin,i)*(2*e),s=0===t?p:(0,v.Sy)(p,t);return d.xmin+=t,d.xmax+=t,d.xmax>e?O(s,e,o):d.xmin<i?O(s,i,o):s}return p}function M(c,o,_){if(Array.isArray(c)){const h=c[0];if(h>o){const p=(0,v.XZ)(h,o);c[0]=h+p*(-2*o)}else if(h<_){const p=(0,v.XZ)(h,_);c[0]=h+p*(-2*_)}}else{const h=c.x;if(h>o){const p=(0,v.XZ)(h,o);c.x+=p*(-2*o)}else if(h<_){const p=(0,v.XZ)(h,_);c.x+=p*(-2*_)}}return c}function f(c,o){const[_,h]=o.valid,p=2*h;let l,e=0;return c>h?(l=Math.ceil(Math.abs(c-h)/p),c-=l*p,e=l):c<_&&(l=Math.ceil(Math.abs(c-_)/p),c+=l*p,e=-l),{x:c,frameId:e}}function g(c,o){const{xmin:_,ymin:h,xmax:p,ymax:l}=o;return E(c,_,h)&&E(c,_,l)&&E(c,p,l)&&E(c,p,h)}function E(c,o,_){return o>=c.xmin&&o<=c.xmax&&_>=c.ymin&&_<=c.ymax}function O(c,o,_=!0){const h=!(0,S.l9)(c);if(h&&(0,Y.Zy)(c),_)return(new T).cut(c,o);const p=h?c.rings:c.paths,l=h?4:2,e=p.length,i=-2*o;for(let n=0;n<e;n++){const d=p[n];if(d&&d.length>=l){const t=[];for(const s of d)t.push([s[0]+i,s[1]]);p.push(t)}}return h?c.rings=p:c.paths=p,c}class I{constructor(o,_){this.extent=o,this.frameIds=_}}const W=(0,D.Ue)();class T{constructor(){this._linesIn=[],this._linesOut=[]}cut(o,_){let h;if(this._xCut=_,o.rings)this._closed=!0,h=o.rings,this._minPts=4;else{if(!o.paths)return null;this._closed=!1,h=o.paths,this._minPts=2}for(const l of h){if(!l||l.length<this._minPts)continue;let e=!0;for(const i of l)e?(this.moveTo(i),e=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),h=[];for(const l of this._linesIn)l&&l.length>=this._minPts&&h.push(l);const p=-2*this._xCut;for(const l of this._linesOut)if(l&&l.length>=this._minPts){for(const e of l)e[0]+=p;h.push(l)}return this._closed?o.rings=h:o.paths=h,o}moveTo(o){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(o[0]),this._moveTo(o[0],o[1],this._prevSide),this._prevPt=o,this._firstPt=o}lineTo(o){const _=this._side(o[0]);if(_*this._prevSide==-1){const h=this._intersect(this._prevPt,o);this._lineTo(this._xCut,h,0),this._prevSide=0,this._lineTo(o[0],o[1],_)}else this._lineTo(o[0],o[1],_);this._prevSide=_,this._prevPt=o}close(){const o=this._firstPt,_=this._prevPt;o[0]===_[0]&&o[1]===_[1]||this.lineTo(o),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(o,_,h){this._closed?(this._lineIn.push([h<=0?o:this._xCut,_]),this._lineOut.push([h>=0?o:this._xCut,_])):(h<=0&&this._lineIn.push([o,_]),h>=0&&this._lineOut.push([o,_]))}_lineTo(o,_,h){this._closed?(this._addPolyVertex(this._lineIn,h<=0?o:this._xCut,_),this._addPolyVertex(this._lineOut,h>=0?o:this._xCut,_)):h<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([o,_])):h>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([o,_])):this._prevSide<0?(this._lineIn.push([o,_]),this._lineOut.push([o,_])):this._prevSide>0&&(this._lineOut.push([o,_]),this._lineIn.push([o,_]))}_addPolyVertex(o,_,h){const p=o.length;p>1&&o[p-1][0]===_&&o[p-2][0]===_?o[p-1][1]=h:o.push([_,h])}_checkClosingPt(o){const _=o.length;_>3&&o[0][0]===this._xCut&&o[_-2][0]===this._xCut&&o[1][0]===this._xCut&&(o[0][1]=o[_-2][1],o.pop())}_side(o){return o<this._xCut?-1:o>this._xCut?1:0}_intersect(o,_){return o[1]+(this._xCut-o[0])/(_[0]-o[0])*(_[1]-o[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}},77044:(F,K,m)=>{m.d(K,{Y:()=>b});var L=m(62208);function D(a,y){return a?y?4:3:y?3:2}function b(a,y,M,A,f){if((0,L.Wi)(y)||!y.lengths.length)return null;const g="upperLeft"===f?.originPosition?-1:1;a.lengths.length&&(a.lengths.length=0),a.coords.length&&(a.coords.length=0);const E=a.coords,O=[],I=M?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:W,coords:T}=y,c=D(M,A);let o=0;for(const _ of W){const h=Y(I,T,o,_,M,A,g);h&&O.push(h),o+=_*c}if(O.sort((_,h)=>{let p=g*_[2]-g*h[2];return 0===p&&M&&(p=_[4]-h[4]),p}),O.length){let _=6*O[0][2];E[0]=O[0][0]/_,E[1]=O[0][1]/_,M&&(_=6*O[0][4],E[2]=0!==_?O[0][3]/_:0),(E[0]<I[0]||E[0]>I[1]||E[1]<I[2]||E[1]>I[3]||M&&(E[2]<I[4]||E[2]>I[5]))&&(E.length=0)}if(!E.length){const _=y.lengths[0]?function S(a,y,M,A,f){const g=D(A,f);let E=y,O=y+g,I=0,W=0,T=0,c=0;for(let o=0,_=M-1;o<_;o++,E+=g,O+=g){const h=a[E],p=a[E+1],l=a[E+2],e=a[O],i=a[O+1],n=a[O+2],d=A?P(h,p,l,e,i,n):v(h,p,e,i);if(d)if(I+=d,A){const t=j(h,p,l,e,i,n);W+=d*t[0],T+=d*t[1],c+=d*t[2]}else{const t=U(h,p,e,i);W+=d*t[0],T+=d*t[1]}}return I>0?A?[W/I,T/I,c/I]:[W/I,T/I]:M>0?A?[a[y],a[y+1],a[y+2]]:[a[y],a[y+1]]:null}(T,0,W[0],M,A):null;if(!_)return null;E[0]=_[0],E[1]=_[1],M&&_.length>2&&(E[2]=_[2])}return a}function Y(a,y,M,A,f,g,E=1){const O=D(f,g);let I=M,W=M+O,T=0,c=0,o=0,_=0,h=0;for(let l=0,e=A-1;l<e;l++,I+=O,W+=O){const i=y[I],n=y[I+1],d=y[I+2],t=y[W],s=y[W+1],r=y[W+2];let u=i*s-t*n;_+=u,T+=(i+t)*u,c+=(n+s)*u,f&&(u=i*r-t*d,o+=(d+r)*u,h+=u),i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i),n<a[2]&&(a[2]=n),n>a[3]&&(a[3]=n),f&&(d<a[4]&&(a[4]=d),d>a[5]&&(a[5]=d))}if(_*E>0&&(_*=-1),h*E>0&&(h*=-1),!_)return null;const p=[T,c,.5*_];return f&&(p[3]=o,p[4]=.5*h),p}function v(a,y,M,A){const f=M-a,g=A-y;return Math.sqrt(f*f+g*g)}function P(a,y,M,A,f,g){const E=A-a,O=f-y,I=g-M;return Math.sqrt(E*E+O*O+I*I)}function U(a,y,M,A){return[a+.5*(M-a),y+.5*(A-y)]}function j(a,y,M,A,f,g){return[a+.5*(A-a),y+.5*(f-y),M+.5*(g-M)]}},61256:(F,K,m)=>{m.d(K,{H:()=>U});var L=m(8314),D=m(36592),b=m(65401);const S={minX:0,minY:0,maxX:0,maxY:0};class U{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new D.Q(9,(0,L.Z)("esri-csp-restrictions")?a=>({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const a=new Array(this._idByBounds.size);let y=0;this._idByBounds.forEach((M,A)=>{a[y++]=A}),this._indexInvalid=!1,this._index.clear(),this._index.load(a)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(a=>this._idByBounds.has(a))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const a=(0,b.cS)();for(const y of this._boundsById.values())y&&(a[0]=Math.min(y[0],a[0]),a[1]=Math.min(y[1],a[1]),a[2]=Math.max(y[2],a[2]),a[3]=Math.max(y[3],a[3]));return a}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(a){const y=this._boundsById.get(a);this._boundsById.delete(a),y&&(this._idByBounds.delete(y),this._indexInvalid||this._index.remove(y))}forEachInBounds(a,y){this._loadIndex(),function P(j,a,y){(function v(j){S.minX=j[0],S.minY=j[1],S.maxX=j[2],S.maxY=j[3]})(a),j.search(S,y)}(this._index,a,M=>y(this._idByBounds.get(M)))}get(a){return this._boundsById.get(a)}has(a){return this._boundsById.has(a)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(a,y){if(!this._indexInvalid){const M=this._boundsById.get(a);M&&(this._index.remove(M),this._idByBounds.delete(M))}this._boundsById.set(a,y),y&&(this._idByBounds.set(y,a),this._indexInvalid||(this._boundsToLoad.push(y),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(F,K,m)=>{m.d(K,{Z:()=>M});var L=m(26584),D=m(61885),b=m(63290),Y=m(62208),S=m(5548),v=m(65401),P=m(82054),U=m(61256),j=m(92794),a=m(6185);const y=(0,S.Ue)();class M{constructor(f){this.geometryInfo=f,this._boundsStore=new U.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new D.Z,this.featureAdapter=j.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let f=0;return this._featuresById.forEach(g=>{(0,Y.pC)(g.geometry)&&g.geometry.coords&&(f+=g.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:f/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(f){if((0,Y.Wi)(this.fullBounds))return null;const[g,E,O,I]=this.fullBounds;return{xmin:g,ymin:E,xmax:O,ymax:I,spatialReference:(0,a.S2)(f)}}add(f){this._add(f),this._emitChanged()}addMany(f){for(const g of f)this._add(g);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(f){const g=this._featuresById.get(f);return g?(this._remove(g),this._emitChanged(),g):null}removeManyById(f){this._boundsStore.invalidateIndex();for(const g of f){const E=this._featuresById.get(g);E&&this._remove(E)}this._emitChanged()}forEachBounds(f,g){for(const E of f){const O=this._boundsStore.get(E.objectId);O&&g((0,S.JR)(y,O))}}getFeature(f){return this._featuresById.get(f)}has(f){return this._featuresById.has(f)}forEach(f){this._featuresById.forEach(g=>f(g))}forEachInBounds(f,g){this._boundsStore.forEachInBounds(f,E=>{g(this._featuresById.get(E))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let f=!1;this._featuresById.forEach((g,E)=>{this._markedIds.has(E)||(f=!0,this._remove(g))}),this._markedIds.clear(),f&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(f){if(!f)return;const g=f.objectId;if(null==g)return void b.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new L.Z("featurestore:invalid-feature","feature id is missing",{feature:f}));const E=this._featuresById.get(g);let O;if(this._markedIds.add(g),E?(f.displayId=E.displayId,O=this._boundsStore.get(g),this._boundsStore.delete(g)):(0,Y.pC)(this.onFeatureAdd)&&this.onFeatureAdd(f),(0,Y.Wi)(f.geometry)||!f.geometry.coords||!f.geometry.coords.length)return this._boundsStore.set(g,null),void this._featuresById.set(g,f);O=(0,P.$)((0,Y.pC)(O)?O:(0,v.Ue)(),f.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,Y.pC)(O)&&this._boundsStore.set(g,O),this._featuresById.set(g,f)}_remove(f){(0,Y.pC)(this.onFeatureRemove)&&this.onFeatureRemove(f);const g=f.objectId;return this._markedIds.delete(g),this._boundsStore.delete(g),this._featuresById.delete(g),f}}},92794:(F,K,m)=>{m.d(K,{n:()=>S});var L=m(62208),D=m(77044),b=m(66385),Y=m(88071);const S={getObjectId:v=>v.objectId,getAttributes:v=>v.attributes,getAttribute:(v,P)=>v.attributes[P],cloneWithGeometry:(v,P)=>new b.u_(P,v.attributes,null,v.objectId),getGeometry:v=>v.geometry,getCentroid:(v,P)=>((0,L.Wi)(v.centroid)&&(v.centroid=(0,D.Y)(new Y.Z,v.geometry,P.hasZ,P.hasM)),v.centroid)}},66269:(F,K,m)=>{m.r(K),m.d(K,{GraphicsSnappingSource:()=>n});var L=m(15861),D=m(17626),b=m(14517),Y=m(85931),S=m(59213),v=m(80542),P=m(62208),U=m(10699),j=m(32917),a=m(77712),M=(m(90912),m(76898)),A=m(37118),f=m(55915),g=m(65629),E=m(71774),O=m(82054),I=m(66385),W=m(3579),T=m(58175),c=m(60507),o=m(86606),_=m(44725),h=m(9218),p=m(17936),l=m(1520),e=m(83010);const i="graphics-collections";let n=class extends((0,v.p)(b.Z)){get updating(){return this.updatingHandles.updating}get _hasZ(){const t=this.view;return(0,P.pC)(t)&&"3d"===t.type&&"map-notes"!==this.layerSource.layer.type}get _snappingElevationAligner(){const{view:t}=this,{layer:s}=this.layerSource,r=(0,P.pC)(t)&&"3d"===t.type;if(!r||"map-notes"===s.type)return(0,p.p)();const u=function(){var B=(0,L.Z)(function*(x,C){return(yield(0,U.Hl)(t.whenLayerView(s),C)).elevationAlignPointsInFeatures(x,C)});return function(C,R){return B.apply(this,arguments)}}();return(0,p.p)(r,{elevationInfo:s.elevationInfo,alignPointsInFeatures:u,spatialReference:t.spatialReference})}get _snappingElevationFilter(){const{view:t}=this,s=(0,P.pC)(t)&&"3d"===t.type&&"map-notes"!==this.layerSource.layer.type;return(0,l.c)(s)}get _symbologySnappingFetcher(){const{view:t}=this,{layer:s}=this.layerSource,r=(0,P.pC)(t)&&"3d"===t.type,u=this._extrudedPolygonSymbolsCount>0;return r&&"map-notes"!==s.type&&u?(0,e.k)(u,function(){var B=(0,L.Z)(function*(x,C){const R=yield t.whenLayerView(s);return(0,U.k_)(C),R.queryForSymbologySnapping({candidates:x,spatialReference:t.spatialReference},C)});return function(x,C){return B.apply(this,arguments)}}()):(0,e.k)()}constructor(t){super(t),this.availability=1,this._sources={multipoint:null,point:null,polygon:null,polyline:null},this._loadedWkids=new Set,this._loadedWkts=new Set,this._pendingAdds=[],this._extrudedPolygonSymbolsCount=0}destroy(){for(const t of this._pendingAdds)t.task.abort();this._pendingAdds.length=0,this._mapSources(t=>this._destroySource(t))}initialize(){this.updatingHandles.add(()=>this.getGraphicsLayers(),r=>{this.updatingHandles.removeHandles(i);for(const u of r)this._addMany(u.graphics.toArray()),this.handles.add([u.on("graphic-update",B=>this._onGraphicUpdate(B)),this.updatingHandles.addOnCollectionChange(()=>u.graphics,B=>this._onGraphicsChanged(B))],i)},j.nn);const{view:t}=this,{layer:s}=this.layerSource;(0,P.pC)(t)&&"3d"===t.type&&"map-notes"!==s.type&&this.addHandles([t.elevationProvider.on("elevation-change",({context:r})=>{(0,c.W_)(r,s.elevationInfo)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,j.YP)(()=>s.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),j.nn),(0,j.on)(()=>s,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}fetchCandidates(t,s){var r=this;return(0,L.Z)(function*(){const{point:u}=t,B=yield(0,U.WW)(r._mapSources(R=>r._fetchCandidatesForSource(R,t,s)));(0,U.k_)(s);const x=r._getGroundElevation,C=B.flat().map(R=>(0,h.X)(R,x));return(0,_.lQ)(u,C),C})()}get _getGroundElevation(){return(0,h.g)(this.view)}_fetchCandidatesForSource(t,s,r){var u=this;return(0,L.Z)(function*(){const B=(0,_.rh)(s,(0,P.Wg)(u.view)?.type??"2d"),x=yield t.queryEngine.executeQueryForSnapping(B,r);(0,U.k_)(r);const C=yield u._snappingElevationAligner.alignCandidates(x.candidates,r);(0,U.k_)(r);const R=yield u._symbologySnappingFetcher.fetch(C,r);(0,U.k_)(r);const X=0===R.length?C:[...C,...R];return u._snappingElevationFilter.filter(B,X)})()}refresh(){}_onGraphicUpdate(t){if(this.getGraphicsLayers().some(s=>s.graphics.includes(t.graphic)))switch(t.property){case"geometry":case"visible":this._remove(t.graphic),this._addMany([t.graphic])}}_onGraphicsChanged(t){for(const s of t.removed)this._remove(s);this._addMany(t.added)}_addMany(t){const s=[],r=new Map;for(const u of t)(0,P.Wi)(u.geometry)||(this._needsInitializeProjection(u.geometry.spatialReference)?(s.push(u.geometry.spatialReference),r.set(u.uid,u)):this._add(u));this._createPendingAdd(s,r)}_createPendingAdd(t,s){var r=this;if(!t.length)return;const u=(0,S.vr)(function(){var C=(0,L.Z)(function*(R){yield(0,f.iQ)(t.map(X=>({source:X,dest:r.spatialReference})),{signal:R}),r._markLoadedSpatialReferences(t);for(const[,X]of s)r._add(X)});return function(R){return C.apply(this,arguments)}}());this.updatingHandles.addPromise(u.promise);const B={task:u,graphics:s},x=()=>(0,Y.e$)(this._pendingAdds,B);u.promise.then(x,x),this._pendingAdds.push(B)}_markLoadedSpatialReferences(t){for(const s of t)null!=s.wkid&&this._loadedWkids.add(s.wkid),null!=s.wkt&&this._loadedWkts.add(s.wkt)}_add(t){if((0,P.Wi)(t.geometry)||!t.visible)return;let s=t.geometry;if("mesh"===s.type)return;"extent"===s.type&&(s=A.Z.fromExtent(s));const r=this._ensureSource(s.type);if((0,P.Wi)(r))return;const u=this._createOptimizedFeature(t.uid,s);(0,P.Wi)(u)||(r.featureStore.add(u),(0,o.QL)(t.symbol)&&this._extrudedPolygonSymbolsCount++)}_needsInitializeProjection(t){return!(null!=t.wkid&&this._loadedWkids.has(t.wkid)||null!=t.wkt&&this._loadedWkts.has(t.wkt)||(0,f.Up)(t,this.spatialReference))}_createOptimizedFeature(t,s){const r=(0,f.iV)((0,g.SR)(s),this.spatialReference);if(!r)return null;const u=this._ensureGeometryHasZ(r),B=(0,O.GH)(u,this._hasZ,!1);return new I.u_(B,{[d]:t},null,t)}_ensureGeometryHasZ(t){if(!this._hasZ)return t;const s=u=>{for(;u.length<3;)u.push(0)},r=t.clone();switch(r.hasZ=!0,r.type){case"point":r.z=r.z??0;break;case"multipoint":r.points.forEach(s);break;case"polyline":r.paths.forEach(u=>u.forEach(s));break;case"polygon":r.rings.forEach(u=>u.forEach(s))}return r}_ensureSource(t){const s=this._sources[t];if((0,P.pC)(s))return s;const r=this._createSource(t);return this._sources[t]=r,r}_createSource(t){const s=E.M.toJSON(t),r=this._hasZ,u=new W.Z({geometryType:s,hasZ:r,hasM:!1});return{featureStore:u,queryEngine:new T.q({featureStore:u,fields:[{name:d,type:"esriFieldTypeOID",alias:d}],geometryType:s,hasM:!1,hasZ:r,objectIdField:d,spatialReference:this.spatialReference,scheduler:(0,P.pC)(this.view)&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:t}}_remove(t){this._mapSources(s=>this._removeFromSource(s,t));for(const s of this._pendingAdds)s.graphics.delete(t.uid),0===s.graphics.size&&s.task.abort()}_removeFromSource(t,s){t.featureStore.has(s.uid)&&(t.featureStore.removeById(s.uid),(0,o.QL)(s.symbol)&&this._extrudedPolygonSymbolsCount--)}_destroySource(t){t.queryEngine.destroy(),this._sources[t.type]=null}_mapSources(t){const{point:s,polygon:r,polyline:u,multipoint:B}=this._sources,x=[];return(0,P.pC)(s)&&x.push(t(s)),(0,P.pC)(r)&&x.push(t(r)),(0,P.pC)(u)&&x.push(t(u)),(0,P.pC)(B)&&x.push(t(B)),x}};(0,D._)([(0,a.Cb)()],n.prototype,"getGraphicsLayers",void 0),(0,D._)([(0,a.Cb)({constructOnly:!0})],n.prototype,"layerSource",void 0),(0,D._)([(0,a.Cb)({constructOnly:!0})],n.prototype,"spatialReference",void 0),(0,D._)([(0,a.Cb)({constructOnly:!0})],n.prototype,"view",void 0),(0,D._)([(0,a.Cb)({readOnly:!0})],n.prototype,"updating",null),(0,D._)([(0,a.Cb)({readOnly:!0})],n.prototype,"availability",void 0),(0,D._)([(0,a.Cb)()],n.prototype,"_hasZ",null),(0,D._)([(0,a.Cb)()],n.prototype,"_snappingElevationAligner",null),(0,D._)([(0,a.Cb)()],n.prototype,"_snappingElevationFilter",null),(0,D._)([(0,a.Cb)()],n.prototype,"_symbologySnappingFetcher",null),(0,D._)([(0,a.Cb)()],n.prototype,"_extrudedPolygonSymbolsCount",void 0),(0,D._)([(0,a.Cb)()],n.prototype,"_getGroundElevation",null),n=(0,D._)([(0,M.j)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],n);const d="OBJECTID"},19038:(F,K,m)=>{m.d(K,{n:()=>b});var L=m(84161),D=m(5286);class b extends D.r{constructor(S,v,P){super(v,P),this.point=S}equals(S){return S instanceof b&&(0,L.k)(this.point,S.point)}}}}]);
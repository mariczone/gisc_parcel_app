"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[6894,7351],{83137:(pe,j,p)=>{p.d(j,{dp:()=>L,yZ:()=>G});var N=p(16730);function G(w,O){const F=O||w.extent,v=w.width,W=(0,N.c9)(F&&F.spatialReference);return F&&v?F.width/v*W*N.hd*96:0}function L(w,O){return w/((0,N.c9)(O)*N.hd*96)}},46894:(pe,j,p)=>{p.r(j),p.d(j,{default:()=>ot});var Y,N=p(15861),l=p(17626),G=p(59318),L=p(88879),X=p(73281),P=p(84792),Z=p(74333),w=p(46882),O=p(2076),F=p(58817),v=p(62208),W=p(99959),je=p(10699),I=p(32917),z=p(21726),c=p(77712),de=p(90912),U=p(68653),ce=p(76898),te=p(99433),Ze=p(36054),B=p(2004),A=p(65234),me=p(83137),We=p(37053),Be=p(44917),Ve=p(552),De=p(49286),$e=p(6647),Ge=p(30346),Xe=p(99555),He=p(97941),re=p(22825),Je=p(38305),fe=p(13812),ye=p(51920),Qe=p(12585),Ke=p(61996),ze=p(66656);p(85931);let Ye=0,b=Y=class extends((0,Ke.IG)(W.w)){constructor(e){super(e),this.dimensions=null,this.fullExtents=null,this.legendUrl=null,this.legendEnabled=!0,this.layer=null,this.maxScale=0,this.minScale=0,this.parent=null,this.popupEnabled=!1,this.queryable=!1,this.sublayers=null,this.spatialReferences=null,this.addHandles([(0,I.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=this,r.layer=this.layer},I.Z_),(0,I.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},I.Z_),(0,I.YP)(()=>this.sublayers,(r,i)=>{if(i)for(const s of i)s.layer=s.parent=null;if(r)for(const s of r)s.parent=this,s.layer=this.layer},I.Z_)])}get description(){return this._get("description")}set description(e){this._set("description",e)}get fullExtent(){return this._get("fullExtent")}set fullExtent(e){this._set("fullExtent",e)}readExtent(e,r){return(e=r.extent)?B.Z.fromJSON(e):null}get id(){return this._get("id")??Ye++}set id(e){this._set("id",e)}readLegendUrl(e,r){return r?.legendUrl??r?.legendURL??null}get effectiveScaleRange(){const{minScale:e,maxScale:r}=this;return{minScale:e,maxScale:r}}get name(){return this._get("name")}set name(e){this._set("name",e)}castSublayers(e){return(0,de.se)(Z.Z.ofType(Y),e)}get title(){return this._get("title")}set title(e){this._set("title",e)}get visible(){return this._get("visible")}set visible(e){this._setAndNotifyLayer("visible",e)}clone(){const e=new Y;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("fullExtent")&&(e.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(e.fullExtents=this.fullExtents?.map(r=>r.clone())??null),this.hasOwnProperty("legendUrl")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(e.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("name")&&(e.name=this.name),this.hasOwnProperty("parent")&&(e.parent=this.parent),this.hasOwnProperty("queryable")&&(e.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(e.sublayers=this.sublayers&&this.sublayers.map(r=>r.clone())),this.hasOwnProperty("spatialReferences")&&(e.spatialReferences=this.spatialReferences?.map(r=>r)),this.hasOwnProperty("visible")&&(e.visible=this.visible),this.hasOwnProperty("title")&&(e.title=this.title),e}_setAndNotifyLayer(e,r){const i=this.layer;this._get(e)!==r&&(this._set(e,r),i&&i.emit("wms-sublayer-update",{propertyName:e,id:this.id}))}};(0,l._)([(0,c.Cb)()],b.prototype,"description",null),(0,l._)([(0,c.Cb)({readOnly:!0})],b.prototype,"dimensions",void 0),(0,l._)([(0,c.Cb)({value:null})],b.prototype,"fullExtent",null),(0,l._)([(0,U.r)("fullExtent",["extent"])],b.prototype,"readExtent",null),(0,l._)([(0,c.Cb)()],b.prototype,"fullExtents",void 0),(0,l._)([(0,c.Cb)({type:Number,json:{write:{enabled:!1,overridePolicy:()=>({ignoreOrigin:!0,enabled:!0})}}})],b.prototype,"id",null),(0,l._)([(0,c.Cb)({type:String,json:{origins:{"web-document":{read:{source:["legendUrl","legendURL"]},write:{target:"legendUrl",ignoreOrigin:!0}}},read:{source:"legendURL"},write:{ignoreOrigin:!0}}})],b.prototype,"legendUrl",void 0),(0,l._)([(0,U.r)(["web-document"],"legendUrl")],b.prototype,"readLegendUrl",null),(0,l._)([(0,c.Cb)({value:!0,type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"},origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],b.prototype,"legendEnabled",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"layer",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"maxScale",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"minScale",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],b.prototype,"effectiveScaleRange",null),(0,l._)([(0,c.Cb)({type:String,value:null,json:{read:{source:"name"},write:{ignoreOrigin:!0}}})],b.prototype,"name",null),(0,l._)([(0,c.Cb)()],b.prototype,"parent",void 0),(0,l._)([(0,c.Cb)({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],b.prototype,"popupEnabled",void 0),(0,l._)([(0,c.Cb)({type:Boolean,json:{write:{ignoreOrigin:!0}}})],b.prototype,"queryable",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"sublayers",void 0),(0,l._)([(0,ze.p)("sublayers")],b.prototype,"castSublayers",null),(0,l._)([(0,c.Cb)({type:[Number],json:{read:{source:"spatialReferences"}}})],b.prototype,"spatialReferences",void 0),(0,l._)([(0,c.Cb)({type:String,value:null,json:{write:{ignoreOrigin:!0}}})],b.prototype,"title",null),(0,l._)([(0,c.Cb)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],b.prototype,"visible",null),b=Y=(0,l._)([(0,ce.j)("esri.layers.support.WMSSublayer")],b);const ne=b;var qe=p(26584);const q={84:4326,83:4269,27:4267};function ke(e){if(!e)return null;const r={idCounter:-1};"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));const i=e.documentElement;if("ServiceExceptionReport"===i.nodeName){const S=Array.prototype.slice.call(i.childNodes).map(K=>K.textContent).join("\r\n");throw new qe.Z("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",S)}const s=C("Capability",i),a=C("Service",i),d=s&&C("Request",s);if(!s||!a||!d)return null;const o=C("Layer",s);if(!o)return null;const m="WMS_Capabilities"===i.nodeName||"WMT_MS_Capabilities"===i.nodeName?i.getAttribute("version"):"1.3.0",u=R("Title",a,"")||R("Name",a,""),f=R("AccessConstraints",a,""),g=/^none$/i.test(f)?"":f,h=R("Abstract",a,""),E=parseInt(R("MaxWidth",a,"5000"),10),M=parseInt(R("MaxHeight",a,"5000"),10),T=ve(d,"GetMap"),Q=be(d,"GetMap"),x=J(o,m,r);if(!x)return null;let Le,ae=0;const lt=Array.prototype.slice.call(s.childNodes),ut=x.sublayers??[],oe=S=>{null!=S&&ut.push(S)};lt.forEach(S=>{"Layer"===S.nodeName&&(0===ae?Le=S:(1===ae&&x.name&&(x.name="",oe(J(Le,m,r))),oe(J(S,m,r))),ae++)});let $=x.sublayers,le=x.extent;const pt=x.fullExtents??[];if($||($=[]),0===$.length&&$.push(x),!le){const S=new B.Z($[0].extent);x.extent=S.toJSON(),le=x.extent}const dt=x.spatialReferences.length>0?x.spatialReferences:he(x),Pe=be(d,"GetFeatureInfo"),ct=Pe?ve(d,"GetFeatureInfo"):null,Ue=ge($),mt=x.minScale||0,ft=x.maxScale||0,Ae=x.dimensions??[],yt=Ue.reduce((S,K)=>S.concat(K.dimensions??[]),[]),Me=Ae.concat(yt).filter(ie);let Te=null;if(Me.length){const S=Me.map(K=>{const{extent:ue}=K;return function tt(e){return Array.isArray(e)&&e.length>0&&e[0]instanceof Date}(ue)?ue.map(ee=>ee.getTime()):ue?.map(ee=>[ee.min.getTime(),ee.max.getTime()])}).flat(2).filter(v.pC);Te={startTimeField:null,endTimeField:null,trackIdField:void 0,timeExtent:[Math.min(...S),Math.max(...S)]}}return{copyright:g,description:h,dimensions:Ae,extent:le,fullExtents:pt,featureInfoFormats:ct,featureInfoUrl:Pe,mapUrl:Q,maxWidth:E,maxHeight:M,maxScale:ft,minScale:mt,layers:Ue,spatialReferences:dt,supportedImageFormatTypes:T,timeInfo:Te,title:u,version:m}}function he(e){if(e.spatialReferences.length>0)return e.spatialReferences;if(e.sublayers)for(const r of e.sublayers){const i=he(r);if(i.length>0)return i}return[]}function ge(e){let r=[];for(const i of e)r.push(i),i.sublayers?.length&&(r=r.concat(ge(i.sublayers)),delete i.sublayers);return r}function k(e,r,i){return r.getAttribute(e)??i}function C(e,r){for(let i=0;i<r.childNodes.length;i++){const s=r.childNodes[i];if(we(s)&&s.nodeName===e)return s}return null}function _(e,r){if(null==r)return[];const i=[];for(let s=0;s<r.childNodes.length;s++){const a=r.childNodes[s];we(a)&&a.nodeName===e&&i.push(a)}return i}function R(e,r,i){return C(e,r)?.textContent??i}function H(e,r,i){if(!e)return null;const s=parseFloat(e.getAttribute("minx")),a=parseFloat(e.getAttribute("miny")),d=parseFloat(e.getAttribute("maxx")),o=parseFloat(e.getAttribute("maxy"));let m,u,f,g;i?(m=isNaN(a)?-Number.MAX_VALUE:a,u=isNaN(s)?-Number.MAX_VALUE:s,f=isNaN(o)?Number.MAX_VALUE:o,g=isNaN(d)?Number.MAX_VALUE:d):(m=isNaN(s)?-Number.MAX_VALUE:s,u=isNaN(a)?-Number.MAX_VALUE:a,f=isNaN(d)?Number.MAX_VALUE:d,g=isNaN(o)?Number.MAX_VALUE:o);const h=new A.Z({wkid:r});return new B.Z({xmin:m,ymin:u,xmax:f,ymax:g,spatialReference:h})}function be(e,r){const i=C(r,e);if(i){const s=C("DCPType",i);if(s){const a=C("HTTP",s);if(a){const d=C("Get",a);if(d){let o=function et(e,r,i,s){const a=C(e,i);return a?k(r,a,s):s}("OnlineResource","xlink:href",d,null);if(o)return o.indexOf("&")===o.length-1&&(o=o.substring(0,o.length-1)),function rt(e,r){const i=[],s=(0,z.mN)(e);for(const a in s.query)s.query.hasOwnProperty(a)&&(r.includes(a.toLowerCase())||i.push(a+"="+s.query[a]));return s.path+(i.length?"?"+i.join("&"):"")}(o,["service","request"])}}}}return null}function ve(e,r){const i=_("Operation",e);if(!i.length)return _("Format",C(r,e)).map(({textContent:a})=>a).filter(v.pC);const s=[];for(const a of i)if(a.getAttribute("name")===r){const d=_("Format",a);for(const{textContent:o}of d)null!=o&&s.push(o)}return s}function xe(e,r,i){const s=C(r,e);if(!s)return i;const{textContent:a}=s;if(null==a||""===a)return i;const d=Number(a);return isNaN(d)?i:d}function J(e,r,i){if(!e)return null;const s={id:i.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===e.getAttribute("queryable"),spatialReferences:[],sublayers:null},a=C("LatLonBoundingBox",e),d=C("EX_GeographicBoundingBox",e);let o=null;a&&(o=H(a,4326)),d&&(o=new B.Z(0,0,0,0,new A.Z({wkid:4326})),o.xmin=parseFloat(R("westBoundLongitude",d,"0")),o.ymin=parseFloat(R("southBoundLatitude",d,"0")),o.xmax=parseFloat(R("eastBoundLongitude",d,"0")),o.ymax=parseFloat(R("northBoundLatitude",d,"0"))),a||d||(o=new B.Z(-180,-90,180,90,new A.Z({wkid:4326}))),s.minScale=xe(e,"MaxScaleDenominator",0),s.maxScale=xe(e,"MinScaleDenominator",0);const m=["1.0.0","1.1.0","1.1.1"].includes(r)?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach(u=>{if("Name"===u.nodeName)s.name=u.textContent||"";else if("Title"===u.nodeName)s.title=u.textContent||"";else if("Abstract"===u.nodeName)s.description=u.textContent||"";else if("BoundingBox"===u.nodeName){const f=u.getAttribute(m);if(f&&0===f.indexOf("EPSG:")){const h=parseInt(f.substring(5),10);0===h||isNaN(h)||o||(o="1.3.0"===r?H(u,h,(0,re.A)(h)):H(u,h))}const g=f&&f.indexOf(":");if(g&&g>-1){let h=parseInt(f.substring(g+1,f.length),10);0===h||isNaN(h)||(h=q[h]?q[h]:h);const E="1.3.0"===r?H(u,h,(0,re.A)(h)):H(u,h);E&&s.fullExtents&&s.fullExtents.push(E)}}else if(u.nodeName===m)(u.textContent?.split(" ")??[]).forEach(f=>{const g=f.includes(":")?parseInt(f.split(":")[1],10):parseInt(f,10);if(0!==g&&!isNaN(g)){const h=q[g]?q[g]:g;s.spatialReferences.includes(h)||s.spatialReferences.push(h)}});else if("Style"!==u.nodeName||s.legendURL){if("Layer"===u.nodeName){const f=J(u,r,i);f&&(f.parentLayerId=s.id,s.sublayers||(s.sublayers=[]),s.sublayers.push(f))}}else{const f=C("LegendURL",u);if(f){const g=C("OnlineResource",f);g&&(s.legendURL=g.getAttribute("xlink:href"))}}}),s.extent=o?.toJSON(),s.dimensions=_("Dimension",e).filter(u=>u.getAttribute("name")&&u.getAttribute("units")&&u.textContent).map(u=>{const f=u.getAttribute("name"),g=u.getAttribute("units"),h=u.textContent,E=u.getAttribute("unitSymbol")??void 0,M=u.getAttribute("default")??void 0,T="0"!==k("default",u,"0"),Q="0"!==k("nearestValue",u,"0"),x="0"!==k("current",u,"0");return ie({name:f,units:g})?{name:"time",units:"ISO8601",extent:Ie(h),default:Ie(M),multipleValues:T,nearestValue:Q,current:x}:function Ce(e){return/^elevation$/i.test(e.name)&&/^(epsg|crs):\d+$/i.test(e.units)}({name:f,units:g})?{name:"elevation",units:g,extent:Ee(h),unitSymbol:E,default:Ee(M),multipleValues:T,nearestValue:Q}:{name:f,units:g,extent:Se(h),unitSymbol:E,default:Se(M),multipleValues:T,nearestValue:Q}}),s}function we(e){return e.nodeType===Node.ELEMENT_NODE}function ie(e){return/^time$/i.test(e.name)&&/^iso8601$/i.test(e.units)}function Ee(e){if(!e)return;const r=e.includes("/"),i=e.split(",");return r?i.map(s=>{const a=s.split("/");return a.length<2?null:{min:parseFloat(a[0]),max:parseFloat(a[1]),resolution:a.length>=3&&"0"!==a[2]?parseFloat(a[2]):void 0}}).filter(v.pC):i.map(s=>parseFloat(s))}function Se(e){if(!e)return;const r=e.includes("/"),i=e.split(",");return r?i.map(s=>{const a=s.split("/");return a.length<2?null:{min:a[0],max:a[1],resolution:a.length>=3&&"0"!==a[2]?a[2]:void 0}}).filter(v.pC):i}function Ie(e){if(!e)return;const r=e.includes("/"),i=e.split(",");return r?i.map(s=>{const a=s.split("/");return a.length<2?null:{min:new Date(a[0]),max:new Date(a[1]),resolution:a.length>=3&&"0"!==a[2]?nt(a[2]):void 0}}).filter(v.pC):i.map(s=>new Date(s))}function nt(e){const i=e.match(/(?:p(\d+y|\d+(?:.|,)\d+y)?(\d+m|\d+(?:.|,)\d+m)?(\d+d|\d+(?:.|,)\d+d)?)?(?:t(\d+h|\d+(?:.|,)\d+h)?(\d+m|\d+(?:.|,)\d+m)?(\d+s|\d+(?:.|,)\d+s)?)?/i);return i?{years:V(i[1]),months:V(i[2]),days:V(i[3]),hours:V(i[4]),minutes:V(i[5]),seconds:V(i[6])}:null}function V(e){if(!e)return 0;const i=e.match(/(?:\d+(?:.|,)\d+|\d+)/);if(!i)return 0;const s=i[0].replace(",",".");return Number(s)}function D(e){return e.toISOString().replace(/\.[0-9]{3}/,"")}const Ne=new Set([102100,3857,102113,900913]),it=new Set([3395,54004]),se=new O.X({bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},{ignoreUnknown:!1});function Fe(e){return"text/html"===e}function Re(e){return"text/plain"===e}let y=class extends((0,Ve.h)((0,He.n)((0,Ge.Q)((0,Xe.M)((0,De.q)((0,$e.I)((0,W.R)(Be.Z)))))))){constructor(...e){super(...e),this.allSublayers=new w.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType="WMS",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type="wms",this.url=null,this.version=null,this.addHandles([(0,I.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=r.layer=this},I.Z_),(0,I.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},I.Z_),(0,I.YP)(()=>this.sublayers,(r,i)=>{if(i)for(const s of i)s.layer=s.parent=null;if(r)for(const s of r)s.parent=s.layer=this},I.Z_)])}normalizeCtorArgs(e,r){return"string"==typeof e?{url:e,...r}:e}load(e){const r=(0,v.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMS"]},e).catch(je.r9).then(()=>this._fetchService(r))),Promise.resolve(this)}readFullExtentFromItemOrMap(e,r){const i=r.extent;return i?new B.Z({xmin:i[0][0],ymin:i[0][1],xmax:i[1][0],ymax:i[1][1]}):null}writeFullExtent(e,r){r.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}get featureInfoFormat(){return(0,v.Wi)(this.featureInfoFormats)?null:this.featureInfoFormats.find(Fe)??this.featureInfoFormats.find(Re)??null}set featureInfoFormat(e){(0,v.pC)(e)?(Fe(e)||Re(e))&&this._override("featureInfoFormat",e):(this.revert("featureInfoFormat","service"),this._clearOverride("featureInfoFormat"))}readImageFormat(e,r){const i=r.supportedImageFormatTypes;return i&&i.includes("image/png")?"image/png":i&&i[0]}readSpatialReferenceFromItemOrDocument(e,r){return new A.Z(r.spatialReferences[0])}writeSpatialReferences(e,r){const i=this.spatialReference?.wkid;e&&i?(r.spatialReferences=e.filter(s=>s!==i),r.spatialReferences.unshift(i)):r.spatialReferences=e}readSublayersFromItemOrMap(e,r,i){return Oe(r.layers,i,r.visibleLayers)}readSublayers(e,r,i){return Oe(r.layers,i)}writeSublayers(e,r,i,s){r.layers=[];const a=new Map,d=e.flatten(({sublayers:o})=>o??[]);for(const o of d)if("number"==typeof o.parent?.id){const m=a.get(o.parent.id);null!=m?m.push(o.id):a.set(o.parent.id,[o.id])}for(const o of d){const m={sublayer:o,...s},u=o.write({parentLayerId:"number"==typeof o.parent?.id?o.parent.id:-1},m);if(a.has(o.id)&&(u.sublayerIds=a.get(o.id)),!o.sublayers&&o.name){const f=o.write({},m);delete f.id,r.layers.push(f)}}r.visibleLayers=d.filter(({visible:o,sublayers:m})=>o&&!m).map(({name:o})=>o).toArray()}createExportImageParameters(e,r,i,s){const a=s?.pixelRatio??1,d=(0,me.yZ)({extent:e,width:r})*a,o=new ye.j({layer:this,scale:d}),{xmin:m,ymin:u,xmax:f,ymax:g,spatialReference:h}=e,E=function st(e,r){let i=e.wkid;return(0,v.Wi)(r)?i:(null!=i&&r.includes(i)||!e.latestWkid||(i=e.latestWkid),null!=i&&Ne.has(i)?r.find(s=>Ne.has(s))||r.find(s=>it.has(s))||102100:i)}(h,this.spatialReferences),M="1.3.0"===this.version&&(0,re.A)(E)?`${u},${m},${g},${f}`:`${m},${u},${f},${g}`,T=o.toJSON();return{bbox:M,["1.3.0"===this.version?"crs":"srs"]:null==E||isNaN(E)?void 0:"EPSG:"+E,...T}}fetchImage(e,r,i,s){var a=this;return(0,N.Z)(function*(){const d=a.mapUrl,o=a.createExportImageParameters(e,r,i,s);if(!o.layers){const h=document.createElement("canvas");return h.width=r,h.height=i,h}const m=s?.timeExtent?.start,u=s?.timeExtent?.end,f=(0,v.pC)(m)&&(0,v.pC)(u)?m.getTime()===u.getTime()?D(m):`${D(m)}/${D(u)}`:void 0,g={responseType:"image",query:a._mixCustomParameters({width:r,height:i,...o,time:f,...a.refreshParameters}),signal:s?.signal};return(0,P.default)(d??"",g).then(h=>h.data)})()}fetchImageBitmap(e,r,i,s){var a=this;return(0,N.Z)(function*(){const d=a.mapUrl??"",o=a.createExportImageParameters(e,r,i,s);if(!o.layers){const E=document.createElement("canvas");return E.width=r,E.height=i,E}const m=s?.timeExtent?.start,u=s?.timeExtent?.end,f=(0,v.pC)(m)&&(0,v.pC)(u)?m.getTime()===u.getTime()?D(m):`${D(m)}/${D(u)}`:void 0,g={responseType:"blob",query:a._mixCustomParameters({width:r,height:i,...o,time:f,...a.refreshParameters}),signal:s?.signal},{data:h}=yield(0,P.default)(d,g);return(0,Qe.g)(h,d)})()}fetchFeatureInfo(e,r,i,s,a){const d=(0,me.yZ)({extent:e,width:r}),m=function _e(e){const r=e.filter(i=>i.popupEnabled&&i.name&&i.queryable);return r.length?r.map(({name:i})=>i).join():null}(new ye.j({layer:this,scale:d}).visibleSublayers);if((0,v.Wi)(this.featureInfoUrl)||(0,v.Wi)(m))return Promise.resolve([]);if((0,v.Wi)(this.fetchFeatureInfoFunction)&&(0,v.Wi)(this.featureInfoFormat))return Promise.resolve([]);const f={query_layers:m,request:"GetFeatureInfo",info_format:this.featureInfoFormat,feature_count:25,width:r,height:i,..."1.3.0"===this.version?{I:s,J:a}:{x:s,y:a}},g={...this.createExportImageParameters(e,r,i),...f},h=this._mixCustomParameters(g);return(0,v.pC)(this.fetchFeatureInfoFunction)?this.fetchFeatureInfoFunction(h):this._defaultFetchFeatureInfoFunction((0,z.fl)(this.featureInfoUrl,h))}findSublayerById(e){return this.allSublayers.find(r=>r.id===e)}findSublayerByName(e){return this.allSublayers.find(r=>r.name===e)}serviceSupportsSpatialReference(e){return(0,Je.G)(this.url)||null!=this.spatialReferences&&this.spatialReferences.some(r=>{const i=900913===r?A.Z.WebMercator:new A.Z({wkid:r});return(0,We.fS)(i,e)})}_defaultFetchFeatureInfoFunction(e){const r=document.createElement("iframe");r.src=(0,z.qg)(e),r.style.border="none",r.style.margin="0",r.style.width="100%",r.setAttribute("sandbox","");const i=new X.Z({title:this.title,content:r}),s=new L.Z({sourceLayer:this,popupTemplate:i});return Promise.resolve([s])}_fetchService(e){var r=this;return(0,N.Z)(function*(){if(!r.resourceInfo){const{path:i,query:s}=r.parsedUrl??{};s?.service&&(s.SERVICE=s.service,delete s.service),s?.request&&(s.REQUEST=s.request,delete s.request);const{data:a}=yield(0,P.default)(i??"",{query:{SERVICE:"WMS",REQUEST:"GetCapabilities",...s,...r.customParameters},responseType:"xml",signal:e});r.resourceInfo=ke(a)}if(r.parsedUrl){const i=new z.R9(r.parsedUrl.path),{httpsDomains:s}=G.Z.request;"https"!==i.scheme||i.port&&"443"!==i.port||!i.host||s.includes(i.host)||s.push(i.host)}r.read(r.resourceInfo,{origin:"service"})})()}_mixCustomParameters(e){if(!this.customLayerParameters&&!this.customParameters)return e;const r={...this.customParameters,...this.customLayerParameters};for(const i in r)e[i.toLowerCase()]=r[i];return e}};function Oe(e,r,i){e=e??[];const s=new Map;e.every(d=>null==d.id)&&(e=(0,F.d9)(e)).forEach((d,o)=>d.id=o);for(const d of e){const o=new ne;o.read(d,r),i&&!i.includes(o.name)&&(o.visible=!1),s.set(o.id,o)}const a=[];for(const d of e){const o=null!=d.id?s.get(d.id):null;if(o)if(null!=d.parentLayerId&&d.parentLayerId>=0){const m=s.get(d.parentLayerId);if(!m)continue;m.sublayers||(m.sublayers=new Z.Z),m.sublayers.push(o)}else a.push(o)}return a}(0,l._)([(0,c.Cb)({readOnly:!0})],y.prototype,"allSublayers",void 0),(0,l._)([(0,c.Cb)({json:{type:Object,write:!0}})],y.prototype,"customParameters",void 0),(0,l._)([(0,c.Cb)({json:{type:Object,write:!0}})],y.prototype,"customLayerParameters",void 0),(0,l._)([(0,c.Cb)({type:String,json:{write:!0}})],y.prototype,"copyright",void 0),(0,l._)([(0,c.Cb)()],y.prototype,"description",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],y.prototype,"dimensions",void 0),(0,l._)([(0,c.Cb)({json:{type:[[Number]],read:{source:"extent"},write:{target:"extent"},origins:{"web-document":{write:{ignoreOrigin:!0}},"portal-item":{write:{ignoreOrigin:!0}}}}})],y.prototype,"fullExtent",void 0),(0,l._)([(0,U.r)(["web-document","portal-item"],"fullExtent",["extent"])],y.prototype,"readFullExtentFromItemOrMap",null),(0,l._)([(0,te.c)(["web-document","portal-item"],"fullExtent",{extent:{type:[[Number]]}})],y.prototype,"writeFullExtent",null),(0,l._)([(0,c.Cb)()],y.prototype,"fullExtents",void 0),(0,l._)([(0,c.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"featureInfoFormat",null),(0,l._)([(0,c.Cb)({type:[String],readOnly:!0})],y.prototype,"featureInfoFormats",void 0),(0,l._)([(0,c.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"featureInfoUrl",void 0),(0,l._)([(0,c.Cb)()],y.prototype,"fetchFeatureInfoFunction",void 0),(0,l._)([(0,c.Cb)({type:String,json:{origins:{"web-document":{default:"image/png",type:se.jsonValues,read:{reader:se.read,source:"format"},write:{writer:se.write,target:"format"}}}}})],y.prototype,"imageFormat",void 0),(0,l._)([(0,U.r)("imageFormat",["supportedImageFormatTypes"])],y.prototype,"readImageFormat",null),(0,l._)([(0,c.Cb)({type:Number,json:{read:{source:"maxHeight"},write:{target:"maxHeight"}}})],y.prototype,"imageMaxHeight",void 0),(0,l._)([(0,c.Cb)({type:Number,json:{read:{source:"maxWidth"},write:{target:"maxWidth"}}})],y.prototype,"imageMaxWidth",void 0),(0,l._)([(0,c.Cb)()],y.prototype,"imageTransparency",void 0),(0,l._)([(0,c.Cb)(fe.rn)],y.prototype,"legendEnabled",void 0),(0,l._)([(0,c.Cb)({type:["show","hide","hide-children"]})],y.prototype,"listMode",void 0),(0,l._)([(0,c.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"mapUrl",void 0),(0,l._)([(0,c.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],y.prototype,"isReference",void 0),(0,l._)([(0,c.Cb)({type:["WMS"]})],y.prototype,"operationalLayerType",void 0),(0,l._)([(0,c.Cb)()],y.prototype,"resourceInfo",void 0),(0,l._)([(0,c.Cb)({type:A.Z,json:{origins:{service:{read:{source:"extent.spatialReference"}}},write:!1}})],y.prototype,"spatialReference",void 0),(0,l._)([(0,U.r)(["web-document","portal-item"],"spatialReference",["spatialReferences"])],y.prototype,"readSpatialReferenceFromItemOrDocument",null),(0,l._)([(0,c.Cb)({type:[de.z8],json:{read:!1,origins:{service:{read:!0},"web-document":{read:!1,write:{ignoreOrigin:!0}},"portal-item":{read:!1,write:{ignoreOrigin:!0}}}}})],y.prototype,"spatialReferences",void 0),(0,l._)([(0,te.c)(["web-document","portal-item"],"spatialReferences")],y.prototype,"writeSpatialReferences",null),(0,l._)([(0,c.Cb)({type:Z.Z.ofType(ne),json:{write:{target:"layers",overridePolicy(e,r,i){if(function at(e,r){return e.some(i=>{for(const s in i)if((0,Ze.d)(i,s,null,r))return!0;return!1})}(this.allSublayers,i))return{ignoreOrigin:!0}}}}})],y.prototype,"sublayers",void 0),(0,l._)([(0,U.r)(["web-document","portal-item"],"sublayers",["layers","visibleLayers"])],y.prototype,"readSublayersFromItemOrMap",null),(0,l._)([(0,U.r)("service","sublayers",["layers"])],y.prototype,"readSublayers",null),(0,l._)([(0,te.c)("sublayers",{layers:{type:[ne]},visibleLayers:{type:[String]}})],y.prototype,"writeSublayers",null),(0,l._)([(0,c.Cb)({json:{read:!1},readOnly:!0,value:"wms"})],y.prototype,"type",void 0),(0,l._)([(0,c.Cb)(fe.HQ)],y.prototype,"url",void 0),(0,l._)([(0,c.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"version",void 0),y=(0,l._)([(0,ce.j)("esri.layers.WMSLayer")],y);const ot=y},12585:(pe,j,p)=>{p.d(j,{g:()=>G});var N=p(15861),l=p(26584);function G(X,P){return L.apply(this,arguments)}function L(){return(L=(0,N.Z)(function*(X,P){try{return yield createImageBitmap(X)}catch(Z){throw new l.Z("request:server",`Unable to load ${P}`,{url:P,error:Z})}})).apply(this,arguments)}}}]);
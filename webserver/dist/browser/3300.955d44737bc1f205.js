"use strict";(self.webpackChunkparcel_app=self.webpackChunkparcel_app||[]).push([[3300,3250],{36161:(ae,H,y)=>{y.d(H,{I:()=>B,v:()=>R});var V=y(21286);function B(W,M,z=0){const d=(0,V.uZ)(W,0,_);for(let g=0;g<4;g++)M[z+g]=Math.floor(256*$(d*O[g]))}function R(W,M=0){let z=0;for(let d=0;d<4;d++)z+=W[M+d]*G[d];return z}const O=[1,256,65536,16777216],G=[1/256,1/65536,1/16777216,1/4294967296],_=R(new Uint8ClampedArray([255,255,255,255]));function $(W){return W-Math.floor(W)}},39236:(ae,H,y)=>{y.d(H,{Z:()=>G});var V=y(26584),B=y(63290),R=y(62208),O=y(7848);function G(M,z,d,g,T){if((0,R.Wi)(M))return null;const E=M.referencesGeometry()&&T?function $(M,z,d){const{transform:g,hasZ:T,hasM:E}=d;_.has(z)||_.set(z,function W(M){const z={};switch(M){case"esriGeometryPoint":return(d,g,T,E)=>(0,O.U1)(g,z,d,T,E);case"esriGeometryPolygon":return(d,g,T,E)=>(0,O.Ie)(g,z,d,T,E);case"esriGeometryPolyline":return(d,g,T,E)=>(0,O.G6)(g,z,d,T,E);case"esriGeometryMultipoint":return(d,g,T,E)=>(0,O.J9)(g,z,d,T,E);default:return B.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new V.Z("mapview-arcade",`Unable to handle geometryType: ${M}`)),d=>d}}(z));const C=_.get(z)(M.geometry,g,T,E);return{...M,geometry:C}}(z,g,T):z,C=M.repurposeFeature(E);try{return M.evaluate({...d,$feature:C})}catch(j){return B.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",j),null}}const _=new Map},25310:(ae,H,y)=>{y.d(H,{a:()=>G});var V=y(26584),B=y(63290),R=y(39406),O=y(87526);function G(_){return(0,O.hj)(_.minDataValue)&&(0,O.hj)(_.maxDataValue)&&null!=_.minSize&&null!=_.maxSize?R.X.SIZE_MINMAX_VALUE:(_.expression&&"view.scale"===_.expression||_.valueExpression&&"$view.scale"===_.valueExpression)&&Array.isArray(_.stops)?R.X.SIZE_SCALE_STOPS:(null!=_.field||_.expression&&"view.scale"!==_.expression||_.valueExpression&&"$view.scale"!==_.valueExpression)&&(Array.isArray(_.stops)||"levels"in _&&_.levels)?R.X.SIZE_FIELD_STOPS:(null!=_.field||_.expression&&"view.scale"!==_.expression||_.valueExpression&&"$view.scale"!==_.valueExpression)&&null!=_.valueUnit?R.X.SIZE_UNIT_VALUE:(B.Z.getLogger("esri.views.2d.engine.webgl").error(new V.Z("mapview-bad-type","Found invalid size VisualVariable",_)),R.X.NONE)}},3250:(ae,H,y)=>{y.r(H),y.d(H,{createSymbolSchema:()=>G});var V=y(39406),B=y(18716);function R(d){return"line-marker"===d.type?{type:"line-marker",color:d.color?.toJSON(),placement:d.placement,style:d.style}:d.constructor.fromJSON(d.toJSON()).toJSON()}function O(d){return(0,B.hF)(d)}function G(d,g,T=!1){if(!d)return null;switch(d.type){case"simple-fill":case"picture-fill":return function $(d,g,T){const E=(0,B.jj)(V.LW.FILL,g),C=T?O(E):E,j=d.clone(),h=j.outline,w=(0,B.jy)(g.symbologyType);w||(j.outline=null);const x={materialKey:C,hash:j.hash(),...R(j)};if(w)return x;const b=[];if(b.push(x),h){const I=(0,B.jj)(V.LW.LINE,{...g,isOutline:!0}),U={materialKey:T?O(I):I,hash:h.hash(),...R(h)};b.push(U)}return{type:"composite-symbol",layers:b,hash:b.reduce((I,U)=>U.hash+I,"")}}(d,g,T);case"simple-marker":case"picture-marker":return function M(d,g,T){const E=(0,B.jj)(V.LW.MARKER,g),C=T?O(E):E,j=R(d);return{materialKey:C,hash:d.hash(),...j,angle:d.angle,maxVVSize:g.maxVVSize}}(d,g,T);case"simple-line":return function W(d,g,T){const E=(0,B.jy)(g.symbologyType)?V.mD.DEFAULT:g.symbologyType,C=(0,B.jj)(V.LW.LINE,{...g,symbologyType:E}),j=T?O(C):C,h=d.clone(),w=h.marker;h.marker=null;const x=[];if(x.push({materialKey:j,hash:h.hash(),...R(h)}),w){const b=(0,B.jj)(V.LW.MARKER,g),I=T?O(b):b;w.color=w.color??h.color,x.push({materialKey:I,hash:w.hash(),lineWidth:h.width,...R(w)})}return{type:"composite-symbol",layers:x,hash:x.reduce((b,I)=>I.hash+b,"")}}(d,g,T);case"text":return function z(d,g,T){const E=(0,B.jj)(V.LW.TEXT,g),C=T?O(E):E,j=R(d);return{materialKey:C,hash:d.hash(),...j,angle:d.angle,maxVVSize:g.maxVVSize}}(d,g,T);case"label":return function _(d,g,T){const E=d.toJSON(),C=(0,B.jj)(V.LW.LABEL,{...g,placement:E.labelPlacement});return{materialKey:T?O(C):C,hash:d.hash(),...E,labelPlacement:E.labelPlacement}}(d,g,T);case"cim":return{type:"cim",rendererKey:g.vvFlags,data:d.data,maxVVSize:g.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:g.vvFlags,data:d,maxVVSize:g.maxVVSize};case"web-style":return{...R(d),type:"web-style",hash:d.hash(),rendererKey:g.vvFlags,maxVVSize:g.maxVVSize};default:throw new Error(`symbol not supported ${d.type}`)}}},49391:(ae,H,y)=>{y.d(H,{MD:()=>be,Ew:()=>Ae,q5:()=>he});var V=y(26584),B=y(8314),R=y(63290),O=y(62208),G=y(23841),_=y(95737),$=y(84682),W=y(62667),M=y(39406),z=y(87526),d=y(25575),g=y(25310);function T(r){if(!r)return M.X.NONE;let u=0;for(const i of r)if("size"===i.type){const o=(0,g.a)(i);u|=o,"outline"===i.target&&(u|=o<<4)}else"color"===i.type?u|=M.X.COLOR:"opacity"===i.type?u|=M.X.OPACITY:"rotation"===i.type&&(u|=M.X.ROTATION);return u}var E=y(3250),j=(y(35909),y(31375));y(39351);function X(r,u){return Math.max(r,u)}y(64596),y(11263),new j.Z(0,0,24,24);var fe=y(22418),Oe=y(62192),Ie=y(43930);const ue=R.Z.getLogger("esri.views.2d.layers.features.schemaUtils"),Q="ValidationError";function he(r,u){let i=0,o=0,p=M.mD.DEFAULT;if((0,O.pC)(r)){if(o=function U(r,u){if(!("visualVariables"in r)||!r.hasVisualVariables("size"))return 0;const i=r.getVisualVariablesForType("size");if(!i[0])return 0;const o=i[0];if(u&&"cluster_count"===o.field&&"cluster"===u.type)return u.clusterMaxSize;if("outline"===o.target)return 0;if("stops"===o.transformationType)return o.stops.map(p=>p.size).reduce(X,0);if("clamped-linear"===o.transformationType){let p=-1/0,f=-1/0;return p="number"==typeof o.maxSize?o.maxSize:o.maxSize.stops.map(v=>v.size).reduce(X,0),f="number"==typeof o.minSize?o.minSize:o.minSize.stops.map(v=>v.size).reduce(X,0),Math.max(p,f)}return"real-world-size"===o.transformationType?30:void 0}(r,u),"visualVariables"in r&&(i=T(r.visualVariables||[]),"dot-density"===r.type&&(p=M.mD.DOT_DENSITY)),"heatmap"===r.type&&(p=M.mD.HEATMAP),"dictionary"===r.type)return{maxVVSize:o,vvFlags:i,symbologyType:M.mD.DEFAULT};if("pie-chart"===r.type)return{maxVVSize:o,vvFlags:i,symbologyType:M.mD.PIE_CHART};if(p!==M.mD.DOT_DENSITY&&p!==M.mD.HEATMAP){const f=r.getSymbols();"backgroundFillSymbol"in r&&r.backgroundFillSymbol&&f.push(r.backgroundFillSymbol);let v=!0,L=!0;for(const P of f)if("cim"===P.type&&(L=!1),"simple-fill"===P.type||"picture-fill"===P.type){const K=P.outline,Z=K&&"none"!==K.style&&"solid"!==K.style;Z&&(v=!1),("picture-fill"===P.type||"simple-fill"===P.type&&"none"!==P.style&&"solid"!==P.style||Z)&&(L=!1)}v?p=L?M.mD.OUTLINE_FILL_SIMPLE:M.mD.OUTLINE_FILL:L&&(p=M.mD.SIMPLE)}}return{vvFlags:i,maxVVSize:o,symbologyType:p}}let De=null;function Ae(r){if((0,B.Z)("esri-2d-update-debug")){const u=Pe(r,!0);console.debug("Created new schema",u),console.debug("Schema diff",(0,$.Hg)(De,u)),De=u}return Pe(r)}function Pe(r,u=!1){try{const i=function We(r,u=!1){const i=new Array;return i.push(function Ne(r,u,i=!1){const o={indexCount:0,fields:{}},p="featureReduction"in r?r.featureReduction??void 0:void 0,f=p?"aggregate":"feature";if("sublayers"in r){const oe={type:"subtype",subtypeField:r.subtypeField,renderers:{},symbologyType:M.mD.DEFAULT},xe={type:"subtype",mapping:{},target:"feature",subtypeField:r.subtypeField},ve={type:"subtype",classes:{}},rt={type:"symbol",target:"feature",aggregateFields:[],attributes:o,storage:xe,mesh:{matcher:oe,aggregateMatcher:null,labels:ve,sortKey:null}},Ue=new Set;let st=0;for(const{renderer:pe,subtypeCode:ye,labelingInfo:it,labelsVisible:lt}of r.sublayers){let we=0;"visualVariables"in pe&&pe.visualVariables&&(pe.visualVariables.some(ge=>"rotation"!==ge.type)&&ue.warnOnce("SubtypeGroupLayer currently only supports rotation visualVariables. All other visualVariable types will be ignored."),we=T(pe.visualVariables.filter(ge=>"size"!==ge.type)));const ze={symbologyType:M.mD.DEFAULT,vvFlags:we,maxVVSize:0},me=be(o,f,pe,ze,i),de=Ve(o,f,pe),Ce=lt&&it;if("dictionary"===me.type)throw new V.Z(Q,"Dictionary renderer is not supported in subtype layers");if("subtype"===me.type)throw new V.Z(Q,"Nested subtype renderers is not supported");if((0,O.pC)(de)&&"subtype"===de.type)throw new V.Z(Q,"Nested subtype storage is not supported");if((0,O.pC)(de)&&(0,O.pC)(de.attributeMapping))throw new V.Z(Q,"Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===me.type)throw new V.Z(Q,"Heatmaps are not supported in subtype layers");if("pie-chart"===me.type)throw new V.Z(Q,"Pie-charts are not supported in subtype layers");if(Ue.has(ye))throw new V.Z(Q,"Subtype codes for sublayers must be unique");Ue.add(ye),oe.renderers[ye]=me,xe.mapping[ye]=de,Ce&&(ve.classes[ye]=Ce.map(ge=>Me(o,ge,"feature",st++,ze,i)))}return rt}if("heatmap"===r.renderer?.type&&"raster"===(0,fe.rk)()){const{radius:oe,fieldOffset:xe,field:ve}=r.renderer;return{type:"heatmap",aggregateFields:[],attributes:o,target:f,storage:null,mesh:{radius:oe,fieldOffset:xe,field:ie(o,{target:f,field:ve,resultType:"numeric"}).field}}}const v=function je(r,u,i){const o="featureReduction"in u&&u.featureReduction;if(!o)return{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};const f=[];let v=null,L=(0,Ie.oq)(u.geometryType),P=[],K=null;if(o)switch(o.type){case"selection":return ue.error(new V.Z(Q,"Mapview does not support `selection` reduction type",o)),{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};case"cluster":case"binning":if(f.push(...o.fields??[]),"cluster"===o.type?L="esriGeometryPoint":"binning"===o.type&&(L="esriGeometryPolygon"),o.renderer&&!o.renderer.authoringInfo?.isAutoGenerated){if("cluster"===o.type){const{renderer:re}=(0,Oe.st)(o.renderer,o,null);K=re}else K=o.renderer;const Z=he(o.renderer,o);v=be(r,"aggregate",o.renderer,Z,i),P=o&&o.labelsVisible&&o.labelingInfo||[]}else if("cluster"===o.type){if(K=(0,Oe.S1)(f,u.renderer,o,null,!0),o.symbol){const Z=he(K,o);v={type:"simple",symbol:(0,E.createSymbolSchema)(o.symbol,Z,i),symbologyType:Z.symbologyType}}P=o&&o.labelsVisible&&o.labelingInfo||[]}}return function Je(r,u){const i={mesh:!0,storage:!0};for(const o of u){const{name:p,onStatisticField:f,onStatisticExpression:v,statisticType:L}=o;let P,K;const Z="numeric",re="feature";v?K=ce(r,{type:"expression",target:re,valueExpression:v.expression,resultType:Z}).fieldIndex:P=ce(r,{type:"field",target:re,field:f,resultType:Z}).field,ce(r,{type:"statistic",target:"aggregate",name:p,context:i,inField:P,inFieldIndex:K,statisticType:L})}}(r,f),{labels:(0,W.a)(P,"binning"===o.type?"esriGeometryPolygon":L),matcher:v,fields:f,rendererOverride:K}}(o,r,i),L=(0,Ie.oq)(r.geometryType),P=v.rendererOverride??r.renderer,K=he(P,p),Z=be(o,f,P,K,i),re=Ve(o,f,P),le=function Ge(r,u,i,o){if((0,O.pC)(o))return null;if((0,O.pC)(u)&&u.length){u.length>1&&ue.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${u.length}. All but the first will be discarded`);const p=u[0],f="ascending"===p.order?"asc":"desc";return p.field?{field:p.field,order:f}:p.valueExpression?{fieldIndex:ce(r,{type:"expression",target:"feature",valueExpression:p.valueExpression,resultType:"numeric"}).fieldIndex,order:f}:(ue.error(new V.Z(Q,"Expected to find a field or valueExpression for OrderByInfo",p)),null)}return(0,O.pC)(i)&&"unique-value"===i.type&&i.orderByClassesEnabled?{byRenderer:!0,order:"asc"}:null}(o,r.orderBy,r.renderer,p),tt=(0,W.a)(r.labelsVisible&&r.labelingInfo||[],L);let Fe=0;const nt=[...tt.map(oe=>Me(o,oe,"feature",Fe++,K,i)),...v.labels.map(oe=>Me(o,oe,"aggregate",Fe++,K,i))];return{type:"symbol",target:f,attributes:o,aggregateFields:v.fields,storage:re,mesh:{matcher:Z,labels:{type:"simple",classes:nt},aggregateMatcher:v.matcher,sortKey:le}}}(r)),i}(r,u),o=function Ze(r){return"heatmap"===r.renderer?.type&&"raster"===(0,fe.rk)()?{type:"heatmap"}:{type:"symbol"}}(r),p={};i.map(L=>function Re(r,u,i){switch(i.target){case"feature":return void Te(r,Se(u),i);case"aggregate":{if(!("featureReduction"in u))return;const o=u.featureReduction;switch(o?.type){case"selection":throw new V.Z(Q,"Mapview does not support `selection` reduction type",o);case"binning":return Te(r,Se(u),i),void function Be(r,u,i,o){r.aggregate||(r.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:u.fixedBinLevel,fields:(u.fields??[]).map(p=>({...p.toJSON(),type:Le(p,i)}))},attributes:{}}),Ee(r.aggregate,o.attributes.fields)}(r,o,u.fields.map(p=>p.toJSON()),i);case"cluster":return Te(r,Se(u),i),void function Ke(r,u,i,o){r.aggregate||(r.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,G.F2)(u.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,G.F2)(u.clusterMaxSize)/64),fields:(u.fields??[])?.map(p=>({...p.toJSON(),type:Le(p,i)}))}}),Ee(r.aggregate,o.attributes.fields)}(r,o,u.fields.map(p=>p.toJSON()),i)}}}}(p,r,L));const f=(0,O.pC)(r.subtypeCode)?`${r.subtypeField} = ${r.subtypeCode}`:null;return{source:{definitionExpression:(0,O.Wg)((0,_._)(r.definitionExpression,f)),fields:r.fields.map(L=>L.toJSON()),gdbVersion:r.gdbVersion,historicMoment:r.historicMoment?.getTime(),outFields:r.availableFields,pixelBuffer:r.pixelBuffer,spatialReference:r.spatialReference.toJSON(),timeExtent:r.timeExtent?.toJSON(),customParameters:r.customParameters},attributes:{fields:{},indexCount:0},processors:i,tileRenderer:o,targets:p}}catch(i){if(i.fieldName===Q)return ue.error(i),null;throw i}}function Ee(r,u){for(const i in u){const o=u[i];if(o.target!==r.name)continue;const p=r.attributes[i];if(p?.context){const f=p.context;f.mesh=f.mesh||o.context?.mesh,f.storage=f.storage||o.context?.storage}else r.attributes[i]=o}return r}function Se(r){return[(0,O.Wg)(r.filter)?.toJSON()??null,(0,O.Wg)((0,O.Wg)(r.featureEffect)?.filter)?.toJSON()??null]}function Te(r,u,i){return r.feature||(r.feature={name:"feature",input:"source",filters:u,attributes:{}}),Ee(r.feature,i.attributes.fields),r}function Le(r,u){const{onStatisticExpression:i,onStatisticField:o,statisticType:p}=r;switch(p){case"min":case"max":case"avg":case"avg_angle":case"sum":case"count":return"esriFieldTypeDouble";case"mode":{if(i){const{returnType:v}=i;return v?"string"===v?"esriFieldTypeString":"esriFieldTypeDouble":(ue.error(new V.Z(Q,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",r)),"esriFieldTypeString")}const f=u.find(v=>v.name===o);return f?f.type:(ue.error(new V.Z(Q,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",r)),"esriFieldTypeString")}}}function ie(r,u){return u.field?ce(r,{...u,type:"field",field:u.field}):u.valueExpression?ce(r,{...u,type:"expression",valueExpression:u.valueExpression}):{field:void 0,fieldIndex:void 0}}function ce(r,u){switch(u.type){case"expression":{const i=u.valueExpression;if(!r.fields[i]){const o=r.indexCount++;r.fields[i]={...u,name:i,fieldIndex:o}}return{fieldIndex:r.fields[i].fieldIndex}}case"label-expression":{const i=JSON.stringify(u.label);if(!r.fields[i]){const o=r.indexCount++;r.fields[i]={...u,name:i,fieldIndex:o}}return{fieldIndex:r.fields[i].fieldIndex}}case"field":{const i=u.field;return"aggregate"===u.target&&r.fields[i]||(r.fields[i]={...u,name:i}),{field:i}}case"statistic":return r.fields[u.name]={...u},{field:u.name}}}function Me(r,u,i,o,p,f=!1){const v=ce(r,{type:"label-expression",target:i,context:{mesh:!0},resultType:"string",label:{labelExpression:u.labelExpression,labelExpressionInfo:u.labelExpressionInfo?{expression:u.labelExpressionInfo.expression}:null,symbol:!!u.symbol,where:u.where}}),{fieldIndex:L}=v;return{...(0,E.createSymbolSchema)(u,p,f),fieldIndex:L,target:i,index:o}}function Ve(r,u,i){let o;switch(i.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":o={visualVariables:!0,attributes:null};break;default:o=(0,d.EJ)(i).getStorageSpec(i)}return function He(r,u,i,o){if((0,O.Wi)(i))return null;const{visualVariables:p,attributes:f}=i;let v=null;p&&"visualVariables"in o&&(v=function $e(r,u,i){if(!i||!i.length)return[];const o={storage:!0},p="numeric";return(0,fe.tv)(i).map(f=>{const v=(0,z.nU)(f.type),{field:L,fieldIndex:P}=ie(r,{target:u,valueExpression:f.valueExpression,field:f.field,context:o,resultType:p});switch(f.type){case"size":return"$view.scale"===f.valueExpression?null:{type:"size",binding:v,field:L,fieldIndex:P,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field,valueRepresentation:f.valueRepresentation??null};case"color":return{type:"color",binding:v,field:L,fieldIndex:P,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field};case"opacity":return{type:"opacity",binding:v,field:L,fieldIndex:P,normalizationField:ie(r,{target:u,field:f.normalizationField,context:o,resultType:p}).field};case"rotation":return{type:"rotation",binding:v,field:L,fieldIndex:P}}}).filter(O.pC)}(r,u,o.visualVariables));const L=(0,O.pC)(v)?4:0;let P=null;return(0,O.pC)(f)&&(P=f.map((K,Z)=>{const{field:re,fieldIndex:le}=ie(r,{valueExpression:K.valueExpression,field:K.field,resultType:"numeric",target:u});return{binding:Z+L,field:re,fieldIndex:le}})),{type:"simple",target:u,attributeMapping:P,vvMapping:v}}(r,u,o,i)}function be(r,u,i,o,p=!1){const f=(0,O.Pt)(r,{indexCount:0,fields:{}});switch(i.type){case"simple":case"dot-density":return function Xe(r,u,i,o=!1){const p=u.getSymbols();return{type:"simple",symbol:(0,E.createSymbolSchema)(p.length?p[0]:null,i,o),symbologyType:i.symbologyType}}(0,i,o,p);case"class-breaks":return function ke(r,u,i,o,p=!1){const v=i.backgroundFillSymbol,{field:L,fieldIndex:P}=ie(r,{target:u,field:i.field,valueExpression:i.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}}),K=i.normalizationType,Z="log"===K?"esriNormalizeByLog":"percent-of-total"===K?"esriNormalizeByPercentOfTotal":"field"===K?"esriNormalizeByField":null,re=i.classBreakInfos.map(le=>({symbol:(0,E.createSymbolSchema)(le.symbol,o,p),min:le.minValue,max:le.maxValue})).sort((le,_e)=>le.min-_e.min);return{type:"interval",attributes:r.fields,field:L,fieldIndex:P,backgroundFillSymbol:(0,E.createSymbolSchema)(v,o,p),defaultSymbol:(0,E.createSymbolSchema)(i.defaultSymbol,o,p),intervals:re,normalizationField:i.normalizationField,normalizationTotal:i.normalizationTotal,normalizationType:Z,isMaxInclusive:i.isMaxInclusive,symbologyType:o.symbologyType}}(f,u,i,o,p);case"unique-value":return function Qe(r,u,i,o,p=!1){const f=[],v=i.backgroundFillSymbol,L={target:u,context:{mesh:!0},resultType:"string"};if(i.field&&"string"!=typeof i.field)throw new V.Z(Q,"Expected renderer.field to be a string",i);const{field:P,fieldIndex:K}=ie(r,{...L,field:i.field,valueExpression:i.valueExpression});for(const Z of i.uniqueValueInfos??[])f.push({value:""+Z.value,symbol:(0,E.createSymbolSchema)(Z.symbol,o,p)});return{type:"map",attributes:r.fields,field:P,fieldIndex:K,field2:ie(r,{...L,field:i.field2}).field,field3:ie(r,{...L,field:i.field3}).field,fieldDelimiter:i.fieldDelimiter??void 0,backgroundFillSymbol:(0,E.createSymbolSchema)(v,o),defaultSymbol:(0,E.createSymbolSchema)(i.defaultSymbol,o),map:f,symbologyType:o.symbologyType}}(f,u,i,o,p);case"dictionary":return function qe(r,u,i,o=!1){return{type:"dictionary",config:u.config,fieldMap:u.fieldMap,scaleExpression:u.scaleExpression,url:u.url,symbolOptions:i,symbologyType:i.symbologyType}}(0,i,o,p);case"heatmap":return function et(r,u,i,o=!1){const p=u.getSymbols();return{type:"heatmap",symbol:(0,E.createSymbolSchema)(p.length?p[0]:null,i,o),symbologyType:i.symbologyType}}(0,i,o,p);case"pie-chart":return function Ye(r,u,i,o=!1){const p=u.getSymbols(),v=p.length>1?p[1]:null;return{type:"pie-chart",markerSymbol:(0,E.createSymbolSchema)(p[0],i,o),fillSymbol:(0,E.createSymbolSchema)(v,i,o),symbologyType:i.symbologyType}}(0,i,o,p)}}},22418:(ae,H,y)=>{y.d(H,{TT:()=>w,aR:()=>M,rk:()=>h,tv:()=>z});var V=y(26584),B=y(8314),R=y(63290),O=y(23841),G=y(31637);const W=R.Z.getLogger("esri.views.2d.layers.features.support.rendererUtils"),M=x=>{if(!("visualVariables"in x)||!x.visualVariables||!x.visualVariables.length)return x;const b=x.clone(),I=b.visualVariables.map(U=>d(U)?g(U):U);return b.visualVariables=I,b};function z(x){return x.map(b=>d(b)?g(b.clone()):b)}function d(x){return("size"===x.type||"color"===x.type||"opacity"===x.type)&&null!=x.stops}function g(x){return x.stops=function j(x,b){return b.length<=8?b:(W.warn(`Found ${b.length} Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified.`),b.length>16?function E(x,b){const[I,...U]=b,ne=U.pop(),se=U[0].value,k=U[U.length-1].value,S=(k-se)/6,D=[];for(let F=se;F<k;F+=S){let A=0;for(;F>=U[A].value;)A++;const q=U[A],ee=b[A-1],Y=q.value===ee.value?1:(F-ee.value)/(q.value-ee.value);if("color"===x){const N=U[A],te=b[A-1],X=N.color.clone();X.r=T(te.color.r,X.r,Y),X.g=T(te.color.g,X.g,Y),X.b=T(te.color.b,X.b,Y),X.a=T(te.color.a,X.a,Y),D.push({value:F,color:X,label:N.label})}else if("size"===x){const N=U[A],te=b[A-1],X=(0,O.t_)(N.size),fe=T((0,O.t_)(te.size),X,Y);D.push({value:F,size:fe,label:N.label})}else{const N=U[A],te=T(b[A-1].opacity,N.opacity,Y);D.push({value:F,opacity:te,label:N.label})}}return[I,...D,ne]}(x,b):function C(x){const[b,...I]=x,U=I.pop();for(;I.length>6;){let ne=0,se=0;for(let k=1;k<I.length;k++){const F=Math.abs(I[k].value-I[k-1].value);F>se&&(se=F,ne=k)}I.splice(ne,1)}return[b,...I,U]}(b))}(x.type,x.stops??[]),x}function T(x,b,I){return(1-I)*x+I*b}function h(){if((0,B.Z)("heatmap-force-raster"))return"raster";const{supportsTextureFloat:x,supportsTextureHalfFloat:b,supportsColorBufferFloat:I,supportsColorBufferFloatBlend:U,supportsColorBufferHalfFloat:ne}=(0,G.hc)("2d");return x&&I&&U||b&&ne?"symbol":(0,B.Z)("heatmap-allow-raster-fallback")?"raster":"none"}function w(x){if(!x)return!0;switch(x.type){case"dot-density":if(!(0,G.hc)("2d").supportsTextureFloat)return W.error(new V.Z("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case"heatmap":{const b=h();if("none"===b||"raster"===b&&!(0,B.Z)("heatmap-force-raster")){const I=(0,G.hc)("2d"),U=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(ne=>!I[ne]).join(", ");if("none"===b)return W.errorOnce(new V.Z("webgl-missing-extension",`Missing WebGL${I.type} requirements for Heatmap: ${U}`)),!1;"raster"===b&&W.warnOnce(`Missing WebGL${I.type} requirements for accelerated Heatmap: ${U}. Feature support may be limited.`)}break}}return!0}},64596:(ae,H,y)=>{y.d(H,{I_:()=>M,XA:()=>j,Zu:()=>d,ab:()=>g,eT:()=>E,y1:()=>z,yA:()=>T}),y(986);var B=y(62208),R=y(37118),O=y(65401),G=y(37053);y(40028),y(39351),y(25797);const M=512,z=50;function d(h,w){const x=(0,G.C5)(w);if(!x)return null;const[b,I]=x.valid;return h[2]>I?[(0,O.Ue)([h[0],h[1],I,h[3]]),(0,O.Ue)([b,h[1],b+h[2]-I,h[3]])]:h[0]<b?[(0,O.Ue)([b,h[1],h[2],h[3]]),(0,O.Ue)([I-(b-h[0]),h[1],I,h[3]])]:null}function g(h){return"text"===h||"esriTS"===h}function T(h){return"simple-marker"===h||"picture-marker"===h||"esriSMS"===h||"esriPMS"===h}function E(h){switch((0,B.Wg)(h.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function j(h){if(!h)return null;const{xmin:w,ymin:x,xmax:b,ymax:I,spatialReference:U}=h;return new R.Z({rings:[[[w,x],[w,I],[b,I],[b,x],[w,x]]],spatialReference:U})}},11263:(ae,H,y)=>{y.d(H,{x:()=>k,B:()=>ne});var V=y(15861),B=y(13871),R=y(39406),O=y(18716);const G={marker:R.LW.MARKER,fill:R.LW.FILL,line:R.LW.LINE,text:R.LW.TEXT};class _{constructor(D,F,A,q){const ee={minScale:F?.minScale,maxScale:F?.maxScale},J=function $(S){return S.minScale||S.maxScale?S.minScale+"-"+S.maxScale:""}(ee);this.layers=D,this.data=F,this.hash=this._createHash()+J,this.rendererKey=A;const Y={isOutline:!1,placement:null,symbologyType:R.mD.DEFAULT,vvFlags:A};for(const N of D){const te=G[N.type];Y.isOutline="line"===N.type&&N.isOutline,N.materialKey=(0,O.jj)(te,Y),N.maxVVSize=q,N.scaleInfo=ee,N.templateHash+=J}}get type(){return"expanded-cim"}_createHash(){let D="";for(const F of this.layers)D+=F.templateHash;return D}}var W=y(83100),M=y(26584),z=y(62208),d=y(10699),g=y(21726),T=y(84687),E=y(29840),C=y(71937);function j(S,D,F){return h.apply(this,arguments)}function h(){return(h=(0,V.Z)(function*(S,D,F){if(!S.name)throw new M.Z("style-symbol-reference-name-missing","Missing name in style symbol reference");if(S.styleName&&"Esri2DPointSymbolsStyle"===S.styleName)return w(S,F);try{return b(yield(0,C.n2)(S,D,F),S.name,D,F)}catch(A){return(0,d.k_)(A),null}})).apply(this,arguments)}function w(S,D){return x.apply(this,arguments)}function x(){return(x=(0,V.Z)(function*(S,D){const F=C.wm.replace(/\{SymbolName\}/gi,S.name);try{const A=yield(0,C.EJ)(F,D);return(0,C.KV)(A.data)}catch(A){return(0,d.k_)(A),null}})).apply(this,arguments)}function b(S,D,F,A){return I.apply(this,arguments)}function I(){return(I=(0,V.Z)(function*(S,D,F,A){const q=S.data,ee={portal:F&&(0,z.pC)(F.portal)?F.portal:T.Z.getDefault(),url:(0,g.mN)(S.baseUrl),origin:"portal-item"},J=q.items.find(N=>N.name===D);if(!J)throw new M.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${D}' could not be found`,{symbolName:D});let Y=(0,E.f)((0,C.v9)(J,"cimRef"),ee);(0,W.XO)()&&(Y=(0,W.pJ)(Y));try{const N=yield(0,C.EJ)(Y,A);return(0,C.KV)(N.data)}catch(N){return(0,d.k_)(N),null}})).apply(this,arguments)}const U=function(){var S=(0,V.Z)(function*(D,F,A){return new _(yield(0,B.c)(D.data,F,A),D.data,D.rendererKey,D.maxVVSize)});return function(F,A,q){return S.apply(this,arguments)}}();function ne(S,D,F,A){return se.apply(this,arguments)}function se(){return(se=(0,V.Z)(function*(S,D,F,A){if(!S)return null;if("cim"===S.type)return U(S,D,F);if("web-style"===S.type){const q={type:"cim",data:(yield j(S,null,A))??void 0,rendererKey:S.rendererKey,maxVVSize:S.maxVVSize};return U(q,D,F)}return S})).apply(this,arguments)}function k(S){if(!S)return null;const{avoidSDFRasterization:D,type:F,cim:A,url:q,materialHash:ee}=S,J={cim:A,type:F,mosaicHash:ee,url:q,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:D};switch(F){case"marker":J.size=S.size,J.path=S.path,J.animatedSymbolProperties=S.animatedSymbolProperties;break;case"line":J.dashTemplate=S.dashTemplate;break;case"text":J.text=S.text,J.fontName=S.fontName}return J}},43930:(ae,H,y)=>{y.d(H,{JV:()=>G,oq:()=>R});const B=new(y(2076).X)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function R(_){return B.toJSON(_)}function G(_){const{bandCount:$,attributeTable:W,colormap:M,pixelType:z}=_.raster.rasterInfo;return 1===$&&(null!=W||null!=M||"u8"===z||"s8"===z)}}}]);